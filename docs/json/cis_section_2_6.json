[
  {
    "cis_id": "2.3.7.5",
    "title": "Configure 'Interactive logon: Message text for users\nattempting to log on'",
    "profile": "L1",
    "description": "This policy setting specifies a text message that displays to users when they log on. Set\nthe following group policy to a value that is consistent with the security and operational\nrequirements of your organization.",
    "rationale": "Displaying a warning message before logon may help prevent an attack by warning the\nattacker about the consequences of their misconduct before it happens. It may also help\nto reinforce corporate policy by notifying employees of the appropriate policy during the\nlogon process. This text is often used for legal reasons—for example, to warn users\nabout the ramifications of misusing company information or to warn them that their\nactions may be audited.\nNote: Any warning that you display should first be approved by your organization's legal\nand human resources representatives.",
    "impact": "Users will have to acknowledge a dialog box containing the configured text before they\ncan log on to the computer.\nNote: Windows Vista and Windows XP Professional support logon banners that can\nexceed 512 characters in length and that can also contain carriage-return line-feed\nsequences. However, Windows 2000-based clients cannot interpret and display these\nmessages. You must use a Windows 2000-based computer to create a logon message\npolicy that applies to Windows 2000-based computers.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_SZ value of text.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System:LegalNoticeTex\nt\nPage 173",
    "remediation_procedure": "To establish the recommended configuration via GP, configure the following UI path to a\nvalue that is consistent with the security and operational requirements of your\norganization:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Interactive logon: Message text for users\nattempting to log on",
    "default_value": "No message.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/interactive-logon-message-text-for-users-attempting-to-log-on\n2. GRID: MS-00000075\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 174",
    "page_number": 174
  },
  {
    "cis_id": "2.3.7.6",
    "title": "Configure 'Interactive logon: Message title for users\nattempting to log on'",
    "profile": "L1",
    "description": "This policy setting specifies the text displayed in the title bar of the window that users\nsee when they log on to the system. Configure this setting in a manner that is consistent\nwith the security and operational requirements of your organization.",
    "rationale": "Displaying a warning message before logon may help prevent an attack by warning the\nattacker about the consequences of their misconduct before it happens. It may also help\nto reinforce corporate policy by notifying employees of the appropriate policy during the\nlogon process.",
    "impact": "Users will have to acknowledge a dialog box with the configured title before they can log\non to the computer.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_SZ value of text.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System:LegalNoticeCap\ntion",
    "remediation_procedure": "To establish the recommended configuration via GP, configure the following UI path to a\nvalue that is consistent with the security and operational requirements of your\norganization:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Interactive logon: Message title for users\nattempting to log on",
    "default_value": "No message.\nPage 175\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/interactive-logon-message-title-for-users-attempting-to-log-on\n2. GRID: MS-00000076\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 176",
    "page_number": 176
  },
  {
    "cis_id": "2.3.7.7",
    "title": "Ensure 'Interactive logon: Prompt user to change\npassword before expiration' is set to 'between 5 and 14 days'",
    "profile": "L1",
    "description": "This policy setting determines how far in advance users are warned that their password\nwill expire. It is recommended that you configure this policy setting to at least 5 days but\nno more than 14 days to sufficiently warn users when their passwords will expire.\nThe recommended state for this setting is: between 5 and 14 days.",
    "rationale": "Users will need to be warned that their passwords are going to expire, or they may\ninadvertently be locked out of the computer when their passwords expire. This condition\ncould lead to confusion for users who access the network locally, or make it impossible\nfor users to access your organization's network through dial-up or virtual private network\n(VPN) connections.",
    "impact": "Users will see a dialog box prompt to change their password each time that they log on\nto the domain when their password is configured to expire between 5 and 14 days.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value between 5 and 14.\nHKLM\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon:PasswordExpiryWarning",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to a value\nbetween 5 and 14 days:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Interactive logon: Prompt user to change password\nbefore expiration",
    "default_value": "5 days.\nPage 177\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/interactive-logon-prompt-user-to-change-password-before-\nexpiration\n2. GRID: MS-00000078\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 178",
    "page_number": 178
  },
  {
    "cis_id": "2.3.7.8",
    "title": "Ensure 'Interactive logon: Smart card removal\nbehavior' is set to 'Lock Workstation' or higher",
    "profile": "L1",
    "description": "This policy setting determines what happens when the smart card for a logged-on user\nis removed from the smart card reader.\nThe recommended state for this setting is: Lock Workstation. Configuring this setting\nto Force Logoff or Disconnect if a Remote Desktop Services session also\nconforms to the benchmark.",
    "rationale": "Users sometimes forget to lock their workstations when they are away from them,\nallowing the possibility for malicious users to access their computers. If smart cards are\nused for authentication, the computer should automatically lock itself when the card is\nremoved to ensure that only the user with the smart card is accessing resources using\nthose credentials.",
    "impact": "If you select Lock Workstation, the workstation is locked when the smart card is\nremoved, allowing users to leave the area, take their smart card with them, and still\nmaintain a protected session.\nIf you select Force Logoff, users are automatically logged off when their smart card is\nremoved.\nIf you select Disconnect if a Remote Desktop Services session, removal of the\nsmart card disconnects the session without logging the users off. This allows the user to\ninsert the smart card and resume the session later, or at another smart card reader-\nequipped computer, without having to log on again. If the session is local, this policy will\nfunction identically to Lock Workstation.\nEnforcing this setting on computers used by people who must log onto multiple\ncomputers in order to perform their duties could be frustrating and lower productivity.\nFor example, if network administrators are limited to a single account but need to log\ninto several computers simultaneously in order to effectively manage the network\nenforcing this setting will limit them to logging onto one computer at a time. For these\nreasons it is recommended that this setting only be enforced on workstations used for\npurposes commonly associated with typical users such as document creation and\nemail.\nPage 179",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_SZ value of 1, 2 or 3.\nHKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon:ScRemoveOption",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to Lock\nWorkstation (or, if applicable for your environment, Force Logoff or Disconnect if\na Remote Desktop Services session):\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Interactive logon: Smart card removal behavior",
    "default_value": "No action.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/interactive-logon-smart-card-removal-behavior\n2. GRID: MS-00000080\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.3 Configure Automatic Session Locking on Enterprise\nAssets\nv8 ● ● ●\nConfigure automatic session locking on enterprise assets after a defined period\nof inactivity. For general purpose operating systems, the period must not exceed\n15 minutes. For mobile end-user devices, the period must not exceed 2 minutes.\n16.11 Lock Workstation Sessions After Inactivity\nv7 ● ● ●\nAutomatically lock workstation sessions after a standard period of inactivity.\nPage 180",
    "page_number": 180
  },
  {
    "cis_id": "2.3.8.1",
    "title": "Ensure 'Microsoft network client: Digitally sign\ncommunications (always)' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether packet signing is required by the SMB client\ncomponent.\nNote: When Windows Vista-based computers have this policy setting enabled and they\nconnect to file or print shares on remote servers, it is important that the setting is\nsynchronized with its companion setting, Microsoft network server: Digitally sign\ncommunications (always), on those servers. For more information about these\nsettings, see the \"Microsoft network client and server: Digitally sign communications\n(four related settings)\" section in Chapter 5 of the Threats and Countermeasures guide.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Session hijacking uses tools that allow attackers who have access to the same network\nas the client or server to interrupt, end, or steal a session in progress. Attackers can\npotentially intercept and modify unsigned SMB packets and then modify the traffic and\nforward it so that the server might perform undesirable actions. Alternatively, the\nattacker could pose as the server or client after legitimate authentication and gain\nunauthorized access to data.\nSMB is the resource sharing protocol that is supported by many Windows operating\nsystems. It is the basis of NetBIOS and many other protocols. SMB signatures\nauthenticate both users and the servers that host the data. If either side fails the\nauthentication process, data transmission will not take place.\nPage 182",
    "impact": "The Microsoft network client will not communicate with a Microsoft network server\nunless that server agrees to perform SMB packet signing.\nThe Windows 2000 Server, Windows 2000 Professional, Windows Server 2003,\nWindows XP Professional and Windows Vista implementations of the SMB file and print\nsharing protocol support mutual authentication, which prevents session hijacking\nattacks and supports message authentication to prevent man-in-the-middle attacks.\nSMB signing provides this authentication by placing a digital signature into each SMB,\nwhich is then verified by both the client and the server.\nImplementation of SMB signing may negatively affect performance, because each\npacket needs to be signed and verified. If these settings are enabled on a server that is\nperforming multiple roles, such as a small business server that is serving as a Domain\nController, file server, print server, and application server performance may be\nsubstantially slowed. Additionally, if you configure computers to ignore all unsigned\nSMB communications, older applications and operating systems will not be able to\nconnect. However, if you completely disable all SMB signing, computers will be\nvulnerable to session hijacking attacks.\nWhen SMB signing policies are enabled on Domain Controllers running Windows\nServer 2003 and member computers running Windows Vista SP1 or Windows Server\n2008 group policy processing will fail. A hotfix is available from Microsoft that resolves\nthis issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy\nsettings are not applied on member computers that are running Windows Server 2008\nor Windows Vista SP1 when certain SMB signing policies are enabled.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters:RequireSe\ncuritySignature",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Microsoft network client: Digitally sign\ncommunications (always)",
    "default_value": "Disabled. (SMB packet signing is negotiated between the client and server.)\nPage 183\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/microsoft-network-client-digitally-sign-communications-always\n2. GRID: MS-00000081\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\nPage 184",
    "page_number": 183
  },
  {
    "cis_id": "2.3.8.2",
    "title": "Ensure 'Microsoft network client: Digitally sign\ncommunications (if server agrees)' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the SMB client will attempt to negotiate SMB\npacket signing.\nNote: Enabling this policy setting on SMB clients on your network makes them fully\neffective for packet signing with all clients and servers in your environment.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Session hijacking uses tools that allow attackers who have access to the same network\nas the client or server to interrupt, end, or steal a session in progress. Attackers can\npotentially intercept and modify unsigned SMB packets and then modify the traffic and\nforward it so that the server might perform undesirable actions. Alternatively, the\nattacker could pose as the server or client after legitimate authentication and gain\nunauthorized access to data.\nSMB is the resource sharing protocol that is supported by many Windows operating\nsystems. It is the basis of NetBIOS and many other protocols. SMB signatures\nauthenticate both users and the servers that host the data. If either side fails the\nauthentication process, data transmission will not take place.\nPage 185",
    "impact": "None - this is the default behavior.\nThe Windows 2000 Server, Windows 2000 Professional, Windows Server 2003,\nWindows XP Professional and Windows Vista implementations of the SMB file and print\nsharing protocol support mutual authentication, which prevents session hijacking\nattacks and supports message authentication to prevent man-in-the-middle attacks.\nSMB signing provides this authentication by placing a digital signature into each SMB,\nwhich is then verified by both the client and the server.\nImplementation of SMB signing may negatively affect performance, because each\npacket needs to be signed and verified. If these settings are enabled on a server that is\nperforming multiple roles, such as a small business server that is serving as a Domain\nController, file server, print server, and application server performance may be\nsubstantially slowed. Additionally, if you configure computers to ignore all unsigned\nSMB communications, older applications and operating systems will not be able to\nconnect. However, if you completely disable all SMB signing, computers will be\nvulnerable to session hijacking attacks.\nWhen SMB signing policies are enabled on Domain Controllers running Windows\nServer 2003 and member computers running Windows Vista SP1 or Windows Server\n2008 group policy processing will fail. A hotfix is available from Microsoft that resolves\nthis issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy\nsettings are not applied on member computers that are running Windows Server 2008\nor Windows Vista SP1 when certain SMB signing policies are enabled.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters:EnableSec\nuritySignature",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Microsoft network client: Digitally sign\ncommunications (if server agrees)",
    "default_value": "Enabled. (The Microsoft network client will ask the server to perform SMB packet\nsigning upon session setup. If packet signing has been enabled on the server, packet\nsigning will be negotiated.)\nPage 186\nReferences:\n1. https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-\nserver-2012-R2-and-2012/jj852251(v=ws.11)\n2. GRID: MS-00000082\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\nPage 187",
    "page_number": 186
  },
  {
    "cis_id": "2.3.8.3",
    "title": "Ensure 'Microsoft network client: Send unencrypted\npassword to third-party SMB servers' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the SMB redirector will send plaintext passwords\nduring authentication to third-party SMB servers that do not support password\nencryption.\nIt is recommended that you disable this policy setting unless there is a strong business\ncase to enable it. If this policy setting is enabled, unencrypted passwords will be allowed\nacross the network.\nThe recommended state for this setting is: Disabled.",
    "rationale": "If you enable this policy setting, the server can transmit passwords in plaintext across\nthe network to other computers that offer SMB services, which is a significant security\nrisk. These other computers may not use any of the SMB security mechanisms that are\nincluded with Windows Server 2003.",
    "impact": "None - this is the default behavior.\nSome very old applications and operating systems such as MS-DOS, Windows for\nWorkgroups 3.11, and Windows 95a may not be able to communicate with the servers\nin your organization by means of the SMB protocol.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters:EnablePla\ninTextPassword\nPage 188",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Microsoft network client: Send unencrypted password\nto third-party SMB servers",
    "default_value": "Disabled. (Plaintext passwords will not be sent during authentication to third-party SMB\nservers that do not support password encryption.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/microsoft-network-client-send-unencrypted-password-to-third-\nparty-smb-servers\n2. GRID: MS-00000083\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\n16.4 Encrypt or Hash all Authentication Credentials\nv7 ● ●\nEncrypt or hash with a salt all authentication credentials when stored.\nPage 189",
    "page_number": 189
  },
  {
    "cis_id": "2.3.9.1",
    "title": "Ensure 'Microsoft network server: Amount of idle time\nrequired before suspending session' is set to '15 or fewer\nminute(s)'",
    "profile": "L1",
    "description": "This policy setting allows you to specify the amount of continuous idle time that must\npass in an SMB session before the session is suspended because of inactivity.\nAdministrators can use this policy setting to control when a computer suspends an\ninactive SMB session. If client activity resumes, the session is automatically\nreestablished.\nThe maximum value is 99999, which is over 69 days; in effect, this value disables the\nsetting.\nThe recommended state for this setting is: 15 or fewer minute(s).",
    "rationale": "Each SMB session consumes server resources, and numerous null sessions will slow\nthe server or possibly cause it to fail. An attacker could repeatedly establish SMB\nsessions until the server's SMB services become slow or unresponsive.",
    "impact": "There will be little impact because SMB sessions will be re-established automatically if\nthe client resumes activity.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 15 or less.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters:AutoDisconnect\nPage 191",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to 15 or\nfewer minute(s):\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Microsoft network server: Amount of idle time\nrequired before suspending session",
    "default_value": "15 minutes.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/microsoft-network-server-amount-of-idle-time-required-before-\nsuspending-session\n2. GRID: MS-00000084\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n16.11 Lock Workstation Sessions After Inactivity\nv7 ● ● ●\nAutomatically lock workstation sessions after a standard period of\ninactivity.\nPage 192",
    "page_number": 192
  },
  {
    "cis_id": "2.3.9.2",
    "title": "Ensure 'Microsoft network server: Digitally sign\ncommunications (always)' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether packet signing is required by the SMB server\ncomponent. Enable this policy setting in a mixed environment to prevent downstream\nclients from using the workstation as a network server.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Session hijacking uses tools that allow attackers who have access to the same network\nas the client or server to interrupt, end, or steal a session in progress. Attackers can\npotentially intercept and modify unsigned SMB packets and then modify the traffic and\nforward it so that the server might perform undesirable actions. Alternatively, the\nattacker could pose as the server or client after legitimate authentication and gain\nunauthorized access to data.\nSMB is the resource sharing protocol that is supported by many Windows operating\nsystems. It is the basis of NetBIOS and many other protocols. SMB signatures\nauthenticate both users and the servers that host the data. If either side fails the\nauthentication process, data transmission will not take place.\nPage 193",
    "impact": "The Microsoft network server will not communicate with a Microsoft network client\nunless that client agrees to perform SMB packet signing.\nThe Windows 2000 Server, Windows 2000 Professional, Windows Server 2003,\nWindows XP Professional and Windows Vista implementations of the SMB file and print\nsharing protocol support mutual authentication, which prevents session hijacking\nattacks and supports message authentication to prevent man-in-the-middle attacks.\nSMB signing provides this authentication by placing a digital signature into each SMB,\nwhich is then verified by both the client and the server.\nImplementation of SMB signing may negatively affect performance, because each\npacket needs to be signed and verified. If these settings are enabled on a server that is\nperforming multiple roles, such as a small business server that is serving as a Domain\nController, file server, print server, and application server performance may be\nsubstantially slowed. Additionally, if you configure computers to ignore all unsigned\nSMB communications, older applications and operating systems will not be able to\nconnect. However, if you completely disable all SMB signing, computers will be\nvulnerable to session hijacking attacks.\nWhen SMB signing policies are enabled on Domain Controllers running Windows\nServer 2003 and member computers running Windows Vista SP1 or Windows Server\n2008 group policy processing will fail. A hotfix is available from Microsoft that resolves\nthis issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy\nsettings are not applied on member computers that are running Windows Server 2008\nor Windows Vista SP1 when certain SMB signing policies are enabled.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters:RequireSecurit\nySignature",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Microsoft network server: Digitally sign\ncommunications (always)",
    "default_value": "Disabled. (SMB packet signing is negotiated between the client and server.)\nPage 194\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/microsoft-network-server-digitally-sign-communications-always\n2. GRID: MS-00000085\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\nPage 195",
    "page_number": 194
  },
  {
    "cis_id": "2.3.9.3",
    "title": "Ensure 'Microsoft network server: Digitally sign\ncommunications (if client agrees)' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the SMB server will negotiate SMB packet\nsigning with clients that request it. If no signing request comes from the client, a\nconnection will be allowed without a signature if the Microsoft network server:\nDigitally sign communications (always) setting is not enabled.\nNote: Enable this policy setting on SMB clients on your network to make them fully\neffective for packet signing with all clients and servers in your environment.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Session hijacking uses tools that allow attackers who have access to the same network\nas the client or server to interrupt, end, or steal a session in progress. Attackers can\npotentially intercept and modify unsigned SMB packets and then modify the traffic and\nforward it so that the server might perform undesirable actions. Alternatively, the\nattacker could pose as the server or client after legitimate authentication and gain\nunauthorized access to data.\nSMB is the resource sharing protocol that is supported by many Windows operating\nsystems. It is the basis of NetBIOS and many other protocols. SMB signatures\nauthenticate both users and the servers that host the data. If either side fails the\nauthentication process, data transmission will not take place.\nPage 196",
    "impact": "The Microsoft network server will negotiate SMB packet signing as requested by the\nclient. That is, if packet signing has been enabled on the client, packet signing will be\nnegotiated.\nThe Windows 2000 Server, Windows 2000 Professional, Windows Server 2003,\nWindows XP Professional and Windows Vista implementations of the SMB file and print\nsharing protocol support mutual authentication, which prevents session hijacking\nattacks and supports message authentication to prevent man-in-the-middle attacks.\nSMB signing provides this authentication by placing a digital signature into each SMB,\nwhich is then verified by both the client and the server.\nImplementation of SMB signing may negatively affect performance, because each\npacket needs to be signed and verified. If these settings are enabled on a server that is\nperforming multiple roles, such as a small business server that is serving as a Domain\nController, file server, print server, and application server performance may be\nsubstantially slowed. Additionally, if you configure computers to ignore all unsigned\nSMB communications, older applications and operating systems will not be able to\nconnect. However, if you completely disable all SMB signing, computers will be\nvulnerable to session hijacking attacks.\nWhen SMB signing policies are enabled on Domain Controllers running Windows\nServer 2003 and member computers running Windows Vista SP1 or Windows Server\n2008 group policy processing will fail. A hotfix is available from Microsoft that resolves\nthis issue; see Microsoft Knowledge Base article 950876 for more details: Group Policy\nsettings are not applied on member computers that are running Windows Server 2008\nor Windows Vista SP1 when certain SMB signing policies are enabled.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters:EnableSecurity\nSignature",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Microsoft network server: Digitally sign\ncommunications (if client agrees)",
    "default_value": "Disabled. (The SMB client will never negotiate SMB packet signing.)\nPage 197\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/smbv1-microsoft-network-server-digitally-sign-communications-if-\nclient-agrees\n2. GRID: MS-00000086\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\nPage 198",
    "page_number": 197
  }
]