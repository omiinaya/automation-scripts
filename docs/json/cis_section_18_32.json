[
  {
    "cis_id": "18.10.93.4.4",
    "title": "Ensure 'Enable optional updates' is set to\n'Disabled'",
    "profile": "L1",
    "description": "This policy setting controls whether devices are able to receive optional updates\n(including Controlled Feature Rollout (CFRs)). These optional updates can include non-\nsecurity updates, feature enhancements, and other improvements.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Often, new features or enhancements that are enabled by default (before IT\nadministrators are ready to manage them) can negatively impact the user experience or\nintroduce bugs and security risks.",
    "impact": "New features will not be available on the system until the feature update that includes\nthese features and enhancements is installed.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:SetAllowOptionalConten\nt",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage updates offered from Windows Update\\Enable\noptional updates\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate WindowsUpdate.admx/adml that is included with the Microsoft Windows 11\nRelease 23H2 Administrative Templates (or newer).\nPage 1243",
    "default_value": "Disabled. (Optional updates are not installed by default, but users can enable the toggle\n\"Get the latest updates as soon as they´re available\" to automatically receive optional\nupdates and gradual feature rollouts.)\nReferences:\n1. https://techcommunity.microsoft.com/t5/windows-it-pro-blog/enable-and-control-\noptional-updates-for-your-organization/ba-p/3905218\n2. GRID: MS-00000556\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 1244\n19 Administrative Templates (User)\nThis section contains recommendations for user-based settings that are present within\nthe Administrative Templates (ADMX) for domain-joined user configurations. The\nsettings included in this section are intended to harden the system and are applied on a\nper-user basis, reflected to each domain-joined interactive user’s\nHKEY_CURRENT_USER (HKCU) registry hive. Each interactively logged-on user has\nits own HKCU hive, which is a context-sensitive, per-user, symbolic link to a subkey\nunder HKEY_USERS (HKU), where the user’s Security Identifier (SID) is the subkey\nname (Ex: HKU\\S-1-5-21-123123123-123123123-1231231231-12312). User SIDs for\nthis scenario always begin with S-1-5-21-* for active directory domain-joined\naccounts.\nThe group policy engine applies user configuration settings to the HKU\\SID subkeys for\ninteractive logons, including local console logons, remote desktop logons, and RunAs\nlogons. User configuration settings are not applied to the built-in NT AUTHORITY\nservice accounts (System, Network Service, and Local Service), nor to any other\nservice logons. User configuration settings configured through active directory domain\ngroup policy objects (GPO) are not applied to local user accounts.\nWhen validating user configuration settings for compliance, each recommendation\nshould be checked against all currently-logged-on interactive users’ hives:\n• Audit all HKEY_USERS subkeys with key names beginning with S-1-5-21-*\nand do not end with _Classes.\n• Do not audit subkeys named .DEFAULT, S-1-5-18, S-1-5-19, or S-1-5-20.\n• Do not audit any NT SERVICE SIDs (S-1-5-80-).\n• Do not load the hives of users that are not currently logged on (NTUSER.DAT\nfiles) as part of compliance verification.\nA user configuration setting is considered in compliance if the correct configuration is\nfound in all applicable user hives as described above. If there are multiple users logged\non and the setting is correctly configured in some but not all the applicable user hives,\nthe recommendation is not in full compliance.\nIf a system has no actively logged-on users, the recommendations in this section are\nnot considered out of compliance. User accounts (S-1-5-21-*) that only log on as a\nservice (service accounts), will not receive user configuration settings to its HKU\nregistry hive since the group policy engine will not write to this type of account.\nCompliance findings for these accounts should be ignored.\nPage 1245\nWhy CIS recommends not auditing all the HKU subkeys:\n• Group policy applies user configuration settings only to HKU subkey hives\nassociated with interactive logons. It never applies the settings to the NT\nAUTHORITY service account subkeys (S-1-5-18, S-1-5-19, S-1-5-20, or\n.DEFAULT) or the NT SERVICE subkeys (S-1-5-80-*).\no The HKU\\S-1-5-18 is a symbolic link to HKU\\.DEFAULT, so the key\ncontent is identical.\n• The HKU\\SID_Classes subkey represents the subkey of the corresponding\nHKU\\SID\\SOFTWARE\\Classes, to which they are symbolically linked.\nWhy CIS recommends not loading the NTUSER.DAT file(s) to audit the hives of users\nthat are not currently logged on:\n• Unnecessary false positives of old user profiles that were last loaded before the\nnew or updated GPO containing the user configuration settings were applied.\no These accounts would be found out of compliance, with no supportable\nway to bring them into compliance other than the user logging on or\ndeleting the old profiles.\no These account settings being out of compliance should not cause issues if\nthe user never logs on; and if they do, a group policy update should bring\nthem into compliance.\n• Risk of system issues if the user logs on while the scanning tool has the hive\nloaded, and then also when the scanning tool unloads the hive.\n• Significant performance hit.\nUser configuration settings configured through active directory domain GPOs are not\napplied to local user accounts. Since these accounts begin with the SID S-1-5-21-*, a\nfailure may occur with CIS-CAT and other third-party assessment tools. To mitigate this,\nuser recommendations (Section 19 of this benchmark) should be applied to local\naccounts separately. If this is not a concern for the organization, local accounts should\nbe ignored. The above is also true when an account with a S-1-5-21-* SID logs on as\na service.\nPage 1246",
    "page_number": 1244
  }
]