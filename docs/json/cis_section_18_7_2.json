[
  {
    "cis_id": "18.7.11",
    "title": "Ensure 'Manage processing of Queue-specific files'\nis set to 'Enabled: Limit Queue-specific files to Color profiles'",
    "profile": "L1",
    "description": "This policy setting manages how queue-specific files are processed during printer\ninstallation. At printer installation time, a vendor-supplied installation application can\nspecify a set of files, of any type, to be associated with a particular print queue. The files\nare downloaded to each client that connects to the print server.\nThe recommended state for this setting is: Enabled: Limit Queue-specific files\nto Color profiles.",
    "rationale": "A Windows Print Spooler Remote Code Execution Vulnerability (CVE-2021-36958)\nexists when the Windows Print Spooler service improperly performs privileged file\noperations. An attacker who successfully exploits this vulnerability could run arbitrary\ncode with SYSTEM privileges and then install programs; view, change, or delete data;\nor create new accounts with full user rights.",
    "impact": "None - this is default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers:CopyFilesPolicy",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Limit Queue-specific files to Color profiles:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Manage\nprocessing of Queue-specific files\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).\nPage 619",
    "default_value": "Disabled. (Queue-specific files will be limited to Color profiles.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows-hardware/drivers/print/installing-\nqueue-specific-files\n2. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958\n3. GRID: MS-00000289\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 620",
    "page_number": 620
  },
  {
    "cis_id": "18.7.12",
    "title": "Ensure 'Point and Print Restrictions: When installing\ndrivers for a new connection' is set to 'Enabled: Show warning\nand elevation prompt'",
    "profile": "L1",
    "description": "This policy setting controls whether computers will show a warning and a security\nelevation prompt when users create a new printer connection using Point and Print.\nThe recommended state for this setting is: Enabled: Show warning and elevation\nprompt.\nNote: On August 10, 2021, Microsoft announced a Point and Print Default Behavior\nChange which modifies the default Point and Print driver installation and update\nbehavior to require Administrator privileges. This is documented in KB5005652—\nManage new Point and Print default driver installation behavior (CVE-2021-34481). This\nchange overrides all Point and Print Group Policy settings and ensures that only\nAdministrators can install printer drivers from a print server using Point and Print.",
    "rationale": "Enabling Windows User Account Control (UAC) for the installation of new print drivers\ncan help mitigate the PrintNightmare vulnerability (CVE-2021-34527) and other Print\nSpooler attacks.\nAlthough the Point and Print default driver installation behavior overrides this setting, it\nis important to configure this as a backstop in the event that behavior is reversed.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\Software\\Policies\\Microsoft\\Windows\nNT\\Printers\\PointAndPrint:NoWarningNoElevationOnInstall\nPage 621",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Show warning and elevation prompt:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Point and\nPrint Restrictions: When installing drivers for a new connection\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.",
    "default_value": "Enabled. (Windows computers will show a warning and a security elevation prompt\nwhen users create a new printer connection using Point and Print.)\nReferences:\n1. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675\n2. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481\n3. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527\n4. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958\n5. https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-\nchange/\n6. https://support.microsoft.com/en-us/topic/kb5005652-manage-new-point-and-\nprint-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-\na23b-6d8e9a302872\n7. GRID: MS-00000290\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 622",
    "page_number": 622
  },
  {
    "cis_id": "18.7.13",
    "title": "Ensure 'Point and Print Restrictions: When updating\ndrivers for an existing connection' is set to 'Enabled: Show\nwarning and elevation prompt'",
    "profile": "L1",
    "description": "This policy setting controls whether computers will show a warning and a security\nelevation prompt when users are updating drivers for an existing connection using Point\nand Print.\nThe recommended state for this setting is: Enabled: Show warning and elevation\nprompt.\nNote: On August 10, 2021, Microsoft announced a Point and Print Default Behavior\nChange which modifies the default Point and Print driver installation and update\nbehavior to require Administrator privileges. This is documented in KB5005652—\nManage new Point and Print default driver installation behavior (CVE-2021-34481). This\nchange overrides all Point and Print Group Policy settings and ensures that only\nAdministrators can install printer drivers from a print server using Point and Print.",
    "rationale": "Enabling Windows User Account Control (UAC) for updating existing print drivers can\nhelp mitigate the PrintNightmare vulnerability (CVE-2021-34527) and other Print\nSpooler attacks.\nAlthough the Point and Print default driver installation behavior overrides this setting, it\nis important to configure this as a backstop in the event that behavior is reversed.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\Software\\Policies\\Microsoft\\Windows\nNT\\Printers\\PointAndPrint:UpdatePromptSettings\nPage 623",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Show warning and elevation prompt:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Point and\nPrint Restrictions: When updating drivers for an existing connection\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.",
    "default_value": "Enabled. (Windows computers will show a warning and a security elevation prompt\nwhen users are updating drivers for an existing connection using Point and Print.)\nReferences:\n1. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675\n2. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481\n3. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527\n4. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958\n5. https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-\nchange/\n6. https://support.microsoft.com/en-us/topic/kb5005652-manage-new-point-and-\nprint-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-\na23b-6d8e9a302872\n7. GRID: MS-00000291\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 624",
    "page_number": 624
  }
]