[
  {
    "cis_id": "18.9.5.3",
    "title": "Ensure 'Turn On Virtualization Based Security:\nVirtualization Based Protection of Code Integrity' is set to\n'Enabled with UEFI lock'",
    "profile": "L1",
    "description": "This setting enables virtualization based protection of Kernel Mode Code Integrity.\nWhen this is enabled, kernel mode memory protections are enforced and the Code\nIntegrity validation path is protected by the Virtualization Based Security feature.\nThe recommended state for this setting is: Enabled with UEFI lock.\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "The Enabled with UEFI lock option ensures that Virtualization Based Protection of\nCode Integrity cannot be disabled remotely.\nPage 645",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.\nWarning #2: Once this setting is turned on and active, Virtualization Based Security\ncannot be disabled solely via GPO or any other remote method. After removing the\nsetting from GPO, the features must also be manually disabled locally at the machine\nusing the steps provided at this link:\nManage Windows Defender Credential Guard (Windows 10) | Microsoft Docs",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:HypervisorEnforcedCodeIn\ntegrity",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled with UEFI lock:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Virtualization Based Protection\nof Code Integrity\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 RTM\n(Release 1507) Administrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000303\nPage 646\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 647",
    "page_number": 646
  },
  {
    "cis_id": "18.9.5.4",
    "title": "Ensure 'Turn On Virtualization Based Security:\nRequire UEFI Memory Attributes Table' is set to 'True (checked)'",
    "profile": "L1",
    "description": "This option will only enable Virtualization Based Protection of Code Integrity on devices\nwith UEFI firmware support for the Memory Attributes Table. Devices without the UEFI\nMemory Attributes Table may have firmware that is incompatible with Virtualization\nBased Protection of Code Integrity which in some cases can lead to crashes or data\nloss or incompatibility with certain plug-in cards. If not setting this option the targeted\ndevices should be tested to ensure compatibility.\nThe recommended state for this setting is: True (checked).\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "This setting will help protect this control from being enabled on a system that is not\ncompatible which could lead to a crash or data loss.",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.\nPage 648",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:HVCIMATRequired",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to TRUE:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Require UEFI Memory Attributes\nTable\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 Release 1703\nAdministrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000300\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 649",
    "page_number": 649
  },
  {
    "cis_id": "18.9.5.5",
    "title": "Ensure 'Turn On Virtualization Based Security:\nCredential Guard Configuration' is set to 'Enabled with UEFI lock'",
    "profile": "L1",
    "description": "This setting lets users turn on Credential Guard with virtualization-based security to help\nprotect credentials. The \"Enabled with UEFI lock\" option ensures that Credential Guard\ncannot be disabled remotely. In order to disable the feature, you must set the Group\nPolicy to \"Disabled\" as well as remove the security functionality from each computer,\nwith a physically present user, in order to clear configuration persisted in UEFI.\nThe recommended state for this setting is: Enabled with UEFI lock.\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "The Enabled with UEFI lock option ensures that Credential Guard cannot be\ndisabled remotely.\nPage 650",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.\nWarning #2: Once this setting is turned on and active, Credential Guard cannot be\ndisabled solely via GPO or any other remote method. After removing the setting from\nGPO, the features must also be manually disabled locally at the machine using the\nsteps provided at this link:\nManage Windows Defender Credential Guard (Windows 10) | Microsoft Docs",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:LsaCfgFlags",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled with UEFI lock:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Credential Guard Configuration\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 Release 1511\nAdministrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000298\nPage 651\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 652",
    "page_number": 651
  },
  {
    "cis_id": "18.9.5.6",
    "title": "Ensure 'Turn On Virtualization Based Security:\nSecure Launch Configuration' is set to 'Enabled'",
    "profile": "L1",
    "description": "Secure Launch protects the Virtualization Based Security environment from exploited\nvulnerabilities in device firmware.\nThe recommended state for this setting is: Enabled.\nNote: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "Secure Launch changes the way Windows boots to use Intel Trusted Execution\nTechnology (TXT) and Runtime BIOS Resilience features to prevent firmware exploits\nfrom being able to impact the security of the Windows Virtualization Based Security\nenvironment.",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:ConfigureSystemGuardLaun\nch\nPage 653",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Secure Launch Configuration\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 Release 1809\n& Server 2019 Administrative Templates (or newer).",
    "default_value": "Not Configured. (Administrative users can choose whether to enable or disable Secure\nLaunch.)\nReferences:\n1. GRID: MS-00000301\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 654",
    "page_number": 654
  },
  {
    "cis_id": "18.9.5.7",
    "title": "Ensure 'Turn On Virtualization Based Security:\nKernel-mode Hardware-enforced Stack Protection' is set to\n'Enabled: Enabled in enforcement mode'",
    "profile": "L1",
    "description": "This policy setting enables Hardware-enforced Stack Protection for kernel-mode code.\nKernel-mode data stacks are hardened with hardware-based shadow stacks, which\nstore intended return address targets to ensure that program control flow is not\ntampered.\nThe recommended state for this setting is: Enabled: Enabled in enforcement mode.\nNote: Virtualization Based Security (VBS) requires a 64-bit version of Windows with\nSecure Boot enabled, which in turn requires that Windows was installed with a UEFI\nBIOS configuration, not a Legacy BIOS configuration. In addition, if running Windows on\na virtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-\nV) must be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: This specific security feature of VBS is only compatible with Windows 11\nRelease 22H2 (or newer).\nNote #3: Only Intel CPUs from Tiger Lake and beyond or AMD CPUs Zen3 and beyond\n(both were release in fall 2020) are compatible with this security feature.\nNote #4: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "This setting stores a copy of the apps shadow stack (intended code execution flow) in\nthe hardware-based (CPU) security feature VBS. This can prevent malware from\nhijacking an apps code by exploiting memory bugs such as stack buffer overflows,\ndangling pointers, or uninitialized variables. This allows VBS to shut down any exploit\nattempts via the modification of the intended code execution flow.\nPage 655",
    "impact": "This setting is dependent upon Virtualization Based Protection of Code Integrity (aka\nHVCI) first being enabled, in addition to CPU hardware support for shadow stacks. If\neither HVCI is not enabled or hardware-based shadow stacks are not supported, this\nsetting will have no effect.\nIf this setting is successfully enabled, shadow stack violations will be fatal.\nNote: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:ConfigureKernelShadowSta\ncksLaunch",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Enabled in enforcement mode\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Kernel-mode Hardware-enforced\nStack Protection\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Not Configured.\nReferences:\n1. https://techcommunity.microsoft.com/t5/windows-os-platform-blog/understanding-\nhardware-enforced-stack-protection/ba-p/1247815\n2. https://support.microsoft.com/en-us/windows/a-driver-can-t-load-on-this-device-\n8eea34e5-ff4b-16ec-870d-61a4a43b3dd5\n3. GRID: MS-00000299\nPage 656\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n18.9.6 Device Health Attestation Service\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\nThis Group Policy section is provided by the Group Policy template TPM.admx/adml that\nis included with the Microsoft Windows 10 Release 1709 Administrative Templates (or\nnewer).\n18.9.7 Device Installation\nThis section contains recommendations related to device installation.\nThis Group Policy section is provided by the Group Policy template\nDeviceInstallation.admx/adml that is included with all versions of the Microsoft\nWindows Administrative Templates.\nPage 657",
    "page_number": 656
  },
  {
    "cis_id": "18.9.7.1.1",
    "title": "Ensure 'Prevent installation of devices using\ndrivers that match these device setup classes' is set to 'Enabled'",
    "profile": "BL",
    "description": "This policy setting allows you to specify a list of device setup class globally unique\nidentifiers (GUIDs) for device drivers that Windows is prevented from installing. This\npolicy setting takes precedence over any other policy setting that allows Windows to\ninstall a device.\nIf you enable this policy setting, Windows is prevented from installing or updating device\ndrivers whose device setup class GUIDs appear in the list you create. If you enable this\npolicy setting on a remote desktop server, the policy setting affects redirection of the\nspecified devices from a remote desktop client to the remote desktop server.\nIf you disable or do not configure this policy setting, Windows can install and update\ndevices as allowed or prevented by other policy settings.\nThe recommended state for this setting is: Enabled.",
    "rationale": "A BitLocker-protected computer may be vulnerable to Direct Memory Access (DMA)\nattacks when the computer is turned on or is in the Standby power state - this includes\nwhen the workstation is locked.\nBitLocker with TPM-only authentication lets a computer enter the power-on state without\nany pre-boot authentication. Therefore, an attacker may be able to perform DMA\nattacks.\nThis issue is documented in Microsoft Knowledge Base article 2516445: Blocking the\nSBP-2 driver and Thunderbolt controllers to reduce 1394 DMA and Thunderbolt DMA\nthreats to BitLocker.",
    "impact": "Devices matching the specified device setup classes will be prevented from installation.\nPage 659",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions:DenyDevic\neClasses",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nInstallation\\Device Installation Restrictions\\Prevent installation of devices\nusing drivers that match these device setup classes\nNote: This Group Policy path is provided by the Group Policy template\nDeviceInstallation.admx/adml that is included with all versions of the Microsoft\nWindows Administrative Templates.",
    "default_value": "Disabled. (Devices can be installed and updated as allowed or prevented by other\npolicy settings.)\nReferences:\n1. GRID: MS-00000308\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 660",
    "page_number": 660
  },
  {
    "cis_id": "18.9.7.1.2",
    "title": "Ensure 'Prevent installation of devices using\ndrivers that match these device setup classes: Prevent installation\nof devices using drivers for these device setup' is set to 'IEEE\n1394 device setup classes'",
    "profile": "BL",
    "description": "This policy setting allows you to specify a list of device setup class globally unique\nidentifiers (GUIDs) for device drivers that Windows is prevented from installing. This\npolicy setting takes precedence over any other policy setting that allows Windows to\ninstall a device.\nIf you enable this policy setting, Windows is prevented from installing or updating device\ndrivers whose device setup class GUIDs appear in the list you create. If you enable this\npolicy setting on a remote desktop server, the policy setting affects redirection of the\nspecified devices from a remote desktop client to the remote desktop server.\nIf you disable or do not configure this policy setting, Windows can install and update\ndevices as allowed or prevented by other policy settings.\nHere are the four entries we recommend and what they translate to:\n• {d48179be-ec20-11d1-b6b8-00c04fa372a7} - IEEE 1394 devices that support\nthe SBP2 Protocol Class\n• {7ebefbc0-3200-11d2-b4c2-00a0C9697d07} - IEEE 1394 devices that support\nthe IEC-61883 Protocol Class\n• {c06ff265-ae09-48f0-812c-16753d7cba83} - IEEE 1394 devices that support\nthe AVC Protocol Class\n• {6bdd1fc1-810f-11d0-bec7-08002be2092f} - IEEE 1394 Host Bus Controller\nClass\nThe full list of system-defined device setup classes available in Windows is here:\nSystem-Defined Device Setup Classes Available to Vendors | Microsoft Docs\nThe recommended state for this setting is: {d48179be-ec20-11d1-b6b8-\n00c04fa372a7}, {7ebefbc0-3200-11d2-b4c2-00a0C9697d07}, {c06ff265-ae09-\n48f0-812c-16753d7cba83}, and {6bdd1fc1-810f-11d0-bec7-08002be2092f}\nNote: IEEE 1394 has also been known/branded as FireWire (by Apple), i.LINK (by\nSony) and Lynx (by Texas Instruments).\nPage 661",
    "rationale": "A BitLocker-protected computer may be vulnerable to Direct Memory Access (DMA)\nattacks when the computer is turned on or is in the Standby power state - this includes\nwhen the workstation is locked.\nBitLocker with TPM-only authentication lets a computer enter the power-on state without\nany pre-boot authentication. Therefore, an attacker may be able to perform DMA\nattacks.\nThis issue is documented in Microsoft Knowledge Base article 2516445: Blocking the\nSBP-2 driver and Thunderbolt controllers to reduce 1394 DMA and Thunderbolt DMA\nthreats to BitLocker.",
    "impact": "IEEE 1394 drives & devices will be prevented from being installed in Windows.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_SZ value of {d48179be-ec20-11d1-b6b8-00c04fa372a7}, {7ebefbc0-3200-\n11d2-b4c2-00a0C9697d07}, {c06ff265-ae09-48f0-812c-16753d7cba83}, and\n{6bdd1fc1-810f-11d0-bec7-08002be2092f}.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions\\DenyDevic\neClasses:<numeric value>",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled, and add {d48179be-ec20-11d1-b6b8-00c04fa372a7}, {7ebefbc0-3200-\n11d2-b4c2-00a0C9697d07}, {c06ff265-ae09-48f0-812c-16753d7cba83}, and\n{6bdd1fc1-810f-11d0-bec7-08002be2092f} to the device setup classes list:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nInstallation\\Device Installation Restrictions\\Prevent installation of devices\nusing drivers that match these device setup classes\nNote: This Group Policy path is provided by the Group Policy template\nDeviceInstallation.admx/adml that is included with all versions of the Microsoft\nWindows Administrative Templates.",
    "default_value": "None. (No device setup classes are prevented from installation.)\nReferences:\n1. GRID: MS-00000309\nPage 662\nAdditional Information:\nDocumented in MSKB 2516445.\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 663",
    "page_number": 662
  },
  {
    "cis_id": "18.9.7.1.3",
    "title": "Ensure 'Prevent installation of devices using\ndrivers that match these device setup classes: Also apply to\nmatching devices that are already installed.' is set to 'True'\n(checked)",
    "profile": "BL",
    "description": "This policy setting allows you to specify a list of device setup class globally unique\nidentifiers (GUIDs) for device drivers that Windows is prevented from installing. This\npolicy setting takes precedence over any other policy setting that allows Windows to\ninstall a device.\nIf you enable this policy setting, Windows is prevented from installing or updating device\ndrivers whose device setup class GUIDs appear in the list you create. If you enable this\npolicy setting on a remote desktop server, the policy setting affects redirection of the\nspecified devices from a remote desktop client to the remote desktop server.\nIf you disable or do not configure this policy setting, Windows can install and update\ndevices as allowed or prevented by other policy settings.\nThe recommended state for this setting is: True (checked).",
    "rationale": "A BitLocker-protected computer may be vulnerable to Direct Memory Access (DMA)\nattacks when the computer is turned on or is in the Standby power state - this includes\nwhen the workstation is locked.\nBitLocker with TPM-only authentication lets a computer enter the power-on state without\nany pre-boot authentication. Therefore, an attacker may be able to perform DMA\nattacks.\nThis issue is documented in Microsoft Knowledge Base article 2516445: Blocking the\nSBP-2 driver and Thunderbolt controllers to reduce 1394 DMA and Thunderbolt DMA\nthreats to BitLocker.",
    "impact": "Existing devices (that match the device setup classes specified) that were previously\ninstalled prior to the hardening will be disabled or removed.\nPage 664",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions:DenyDevic\neClassesRetroactive",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled, and check the Also apply to matching devices that are already\ninstalled. checkbox:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nInstallation\\Device Installation Restrictions\\Prevent installation of devices\nusing drivers that match these device setup classes\nNote: This Group Policy path is provided by the Group Policy template\nDeviceInstallation.admx/adml that is included with all versions of the Microsoft\nWindows Administrative Templates.",
    "default_value": "False (unchecked). (Pre-existing devices matching the device setup classes will not be\ndisabled or removed.)\nReferences:\n1. GRID: MS-00000310\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n2.5 Integrate Software and Hardware Asset Inventories\nv7 ●\nThe software inventory system should be tied into the hardware asset inventory\nso all devices and associated software are tracked from a single location.\nPage 665",
    "page_number": 665
  },
  {
    "cis_id": "18.9.7.2",
    "title": "Ensure 'Prevent device metadata retrieval from the\nInternet' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting allows you to prevent Windows from retrieving device metadata from\nthe Internet.\nThe recommended state for this setting is: Enabled.\nNote: This will not prevent the installation of basic hardware drivers, but does prevent\nassociated third-party utility software from automatically being installed under the\ncontext of the SYSTEM account.",
    "rationale": "Installation of software should be conducted by an authorized system administrator and\nnot a standard user. Allowing automatic third-party software installations under the\ncontext of the SYSTEM account has potential for allowing unauthorized access via\nbackdoors or installation software bugs.",
    "impact": "Standard users without administrator privileges will not be able to install associated\nthird-party utility software for peripheral devices. This may limit the use of advanced\nfeatures of those devices unless/until an administrator installs the associated utility\nsoftware for the device.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Device\nMetadata:PreventDeviceMetadataFromNetwork\nPage 666",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nInstallation\\Prevent device metadata retrieval from the Internet\nNote: This Group Policy path is provided by the Group Policy template\nDeviceInstallation.admx/adml that is included with the Microsoft Windows 7 &\nServer 2008 R2 Administrative Templates, or with the Group Policy template\nDeviceSetup.admx/adml that is included with the Microsoft Windows 8.0 & Server\n2012 (non-R2) Administrative Templates (or newer).",
    "default_value": "Disabled. (The setting in the Device Installation Settings dialog box controls whether\nWindows retrieves device metadata from the Internet.)\nReferences:\n1. GRID: MS-00000304\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n2.5 Allowlist Authorized Software\nv8 Use technical controls, such as application allowlisting, to ensure that only ● ●\nauthorized software can execute or be accessed. Reassess bi-annually, or more\nfrequently.\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n18.9.8 Disk NV Cache\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\nThis Group Policy section is provided by the Group Policy template\nDiskNVCache.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.\nPage 667",
    "page_number": 667
  },
  {
    "cis_id": "18.9.13.1",
    "title": "Ensure 'Boot-Start Driver Initialization Policy' is set\nto 'Enabled: Good, unknown and bad but critical'",
    "profile": "L1",
    "description": "This policy setting allows you to specify which boot-start drivers are initialized based on\na classification determined by an Early Launch Antimalware boot-start driver. The Early\nLaunch Antimalware boot-start driver can return the following classifications for each\nboot-start driver:\n• Good: The driver has been signed and has not been tampered with.\n• Bad: The driver has been identified as malware. It is recommended that you do\nnot allow known bad drivers to be initialized.\n• Bad, but required for boot: The driver has been identified as malware, but\nthe computer cannot successfully boot without loading this driver.\n• Unknown: This driver has not been attested to by your malware detection\napplication and has not been classified by the Early Launch Antimalware boot-\nstart driver.\nIf you enable this policy setting you will be able to choose which boot-start drivers to\ninitialize the next time the computer is started.\nIf your malware detection application does not include an Early Launch Antimalware\nboot-start driver or if your Early Launch Antimalware boot-start driver has been\ndisabled, this setting has no effect and all boot-start drivers are initialized.\nThe recommended state for this setting is: Enabled: Good, unknown and bad but\ncritical.",
    "rationale": "This policy setting helps reduce the impact of malware that has already infected your\nsystem.",
    "impact": "None - this is the default behavior.\nPage 670",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 3.\nHKLM\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch:DriverLoadPolicy",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Good, unknown and bad but critical:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Early Launch\nAntimalware\\Boot-Start Driver Initialization Policy\nNote: This Group Policy path is provided by the Group Policy template\nEarlyLaunchAM.admx/adml that is included with the Microsoft Windows 8.0 & Server\n2012 (non-R2) Administrative Templates (or newer).",
    "default_value": "Disabled. (Boot-start drivers determined to be Good, Unknown or Bad but Boot Critical\nare initialized and the initialization of drivers determined to be bad is skipped.)\nReferences:\n1. GRID: MS-00000311\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 671",
    "page_number": 671
  }
]