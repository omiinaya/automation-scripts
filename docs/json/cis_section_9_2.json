[
  {
    "cis_id": "9.3.4",
    "title": "Ensure 'Windows Firewall: Public: Settings: Apply local\nfirewall rules' is set to 'No'",
    "profile": "L1",
    "description": "This setting controls whether local administrators are allowed to create local firewall\nrules that apply together with firewall rules configured by Group Policy.\nThe recommended state for this setting is: No.\nNote: When the Apply local firewall rules setting is configured to No, it's\nrecommended to also configure the Display a notification setting to No.\nOtherwise, users will continue to receive messages that ask if they want to unblock a\nrestricted inbound connection, but the user's response will be ignored.",
    "rationale": "When in the Public profile, there should be no special local firewall exceptions per\ncomputer. These settings should be managed by a centralized policy.",
    "impact": "Administrators can still create firewall rules, but the rules will not be applied.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile:AllowLocalPoli\ncyMerge",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to No:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows\nDefender Firewall with Advanced Security\\Windows Defender Firewall with\nAdvanced Security\\Windows Defender Firewall Properties\\Public\nProfile\\Settings Customize\\Apply local firewall rules",
    "default_value": "Yes (default). (Firewall rules created by administrators will be applied.)\nPage 388\nReferences:\n1. GRID: MS-00000190\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.5 Implement and Manage a Firewall on End-User\nDevices\nv8 ● ● ●\nImplement and manage a host-based firewall or port-filtering tool on end-user\ndevices, with a default-deny rule that drops all traffic except those services and\nports that are explicitly allowed.\n9.4 Apply Host-based Firewalls or Port Filtering\nv7 Apply host-based firewalls or port filtering tools on end systems, with a default- ● ● ●\ndeny rule that drops all traffic except those services and ports that are explicitly\nallowed.\n11.3 Use Automated Tools to Verify Standard Device\nConfigurations and Detect Changes\nv7 ● ●\nCompare all network device configuration against approved security\nconfigurations defined for each network device in use and alert when any\ndeviations are discovered.\nPage 389",
    "page_number": 389
  },
  {
    "cis_id": "9.3.5",
    "title": "Ensure 'Windows Firewall: Public: Settings: Apply local\nconnection security rules' is set to 'No'",
    "profile": "L1",
    "description": "This setting controls whether local administrators are allowed to create connection\nsecurity rules that apply together with connection security rules configured by Group\nPolicy.\nThe recommended state for this setting is: No.",
    "rationale": "Users with administrative privileges might create firewall rules that expose the system to\nremote attack.",
    "impact": "Administrators can still create local connection security rules, but the rules will not be\napplied.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile:AllowLocalIPse\ncPolicyMerge",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to No:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows\nDefender Firewall with Advanced Security\\Windows Defender Firewall with\nAdvanced Security\\Windows Defender Firewall Properties\\Public\nProfile\\Settings Customize\\Apply local connection security rules",
    "default_value": "Yes (default). (Local connection security rules created by administrators will be applied.)\nReferences:\n1. GRID: MS-00000191\nPage 390\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.5 Implement and Manage a Firewall on End-User\nDevices\nv8 ● ● ●\nImplement and manage a host-based firewall or port-filtering tool on end-user\ndevices, with a default-deny rule that drops all traffic except those services and\nports that are explicitly allowed.\n9.4 Apply Host-based Firewalls or Port Filtering\nv7 Apply host-based firewalls or port filtering tools on end systems, with a default- ● ● ●\ndeny rule that drops all traffic except those services and ports that are explicitly\nallowed.\n11.2 Document Traffic Configuration Rules\nv7 All configuration rules that allow traffic to flow through network devices should ● ●\nbe documented in a configuration management system with a specific business\nreason for each rule, a specific individual’s name responsible for that business\nneed, and an expected duration of the need.\nPage 391",
    "page_number": 391
  },
  {
    "cis_id": "9.3.6",
    "title": "Ensure 'Windows Firewall: Public: Logging: Name' is\nset to '%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log'",
    "profile": "L1",
    "description": "Use this option to specify the path and name of the file in which Windows Firewall will\nwrite its log information.\nThe recommended state for this setting is:\n%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log.",
    "rationale": "If Windows Firewall events are not recorded it may be difficult or impossible for\nAdministrators to analyze system issues or unauthorized activities of malicious users.\nMicrosoft stores all firewall events as one file on the system (pfirewall.log). To\nimprove logging, separate each firewall profile (domain, private, public) into its own\ndistinct log file (domainfw.log, privatefw.log, publicfw.log) for better organization\nand identification of specific issues within each profile.",
    "impact": "The log file will be stored in the specified file.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_SZ value of %SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging:LogFil\nePath\nPage 392",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\n%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows\nDefender Firewall with Advanced Security\\Windows Defender Firewall with\nAdvanced Security\\Windows Defender Firewall Properties\\Public Profile\\Logging\nCustomize\\Name",
    "default_value": "%SystemRoot%\\System32\\logfiles\\firewall\\pfirewall.log\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-\nfirewall/configure-the-windows-firewall-log\n2. GRID: MS-00000192\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.2 Collect Audit Logs\nv8 ● ● ●\nCollect audit logs. Ensure that logging, per the enterprise’s audit log\nmanagement process, has been enabled across enterprise assets.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event ● ●\nsource, date, user, timestamp, source addresses, destination addresses, and\nother useful elements.\n9.4 Apply Host-based Firewalls or Port Filtering\nv7 Apply host-based firewalls or port filtering tools on end systems, with a ● ● ●\ndefault-deny rule that drops all traffic except those services and ports that are\nexplicitly allowed.\nPage 393",
    "page_number": 393
  },
  {
    "cis_id": "9.3.7",
    "title": "Ensure 'Windows Firewall: Public: Logging: Size limit\n(KB)' is set to '16,384 KB or greater'",
    "profile": "L1",
    "description": "Use this option to specify the size limit of the file in which Windows Firewall will write its\nlog information.\nThe recommended state for this setting is: 16,384 KB or greater.",
    "rationale": "If events are not recorded it may be difficult or impossible to determine the root cause of\nsystem problems or the unauthorized activities of malicious users.",
    "impact": "The log file size will be limited to the specified size, old events will be overwritten by\nnewer ones when the limit is reached.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 16384.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging:LogFil\neSize",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to 16,384\nKB or greater:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows\nDefender Firewall with Advanced Security\\Windows Defender Firewall with\nAdvanced Security\\Windows Defender Firewall Properties\\Public Profile\\Logging\nCustomize\\Size limit (KB)",
    "default_value": "4,096 KB.\nReferences:\n1. GRID: MS-00000193\nPage 394\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.3 Ensure Adequate Audit Log Storage\nv8 ● ● ●\nEnsure that logging destinations maintain adequate storage to comply with\nthe enterprise’s audit log management process.\n6.4 Ensure adequate storage for logs\nv7 ● ●\nEnsure that all systems that store logs have adequate storage space for the\nlogs generated.\n9.4 Apply Host-based Firewalls or Port Filtering\nv7 Apply host-based firewalls or port filtering tools on end systems, with a ● ● ●\ndefault-deny rule that drops all traffic except those services and ports that are\nexplicitly allowed.\nPage 395",
    "page_number": 395
  },
  {
    "cis_id": "9.3.8",
    "title": "Ensure 'Windows Firewall: Public: Logging: Log\ndropped packets' is set to 'Yes'",
    "profile": "L1",
    "description": "Use this option to log when Windows Firewall with Advanced Security discards an\ninbound packet for any reason. The log records why and when the packet was dropped.\nLook for entries with the word DROP in the action column of the log.\nThe recommended state for this setting is: Yes.",
    "rationale": "If events are not recorded it may be difficult or impossible to determine the root cause of\nsystem problems or the unauthorized activities of malicious users.",
    "impact": "Information about dropped packets will be recorded in the firewall log file.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging:LogDro\nppedPackets",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to Yes:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows\nDefender Firewall with Advanced Security\\Windows Defender Firewall with\nAdvanced Security\\Windows Defender Firewall Properties\\Public Profile\\Logging\nCustomize\\Log dropped packets",
    "default_value": "No (default). (Information about dropped packets will not be recorded in the firewall log\nfile.)\nReferences:\n1. GRID: MS-00000194\nPage 396\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.5 Implement and Manage a Firewall on End-User\nDevices\nv8 ● ● ●\nImplement and manage a host-based firewall or port-filtering tool on end-user\ndevices, with a default-deny rule that drops all traffic except those services and\nports that are explicitly allowed.\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\n9.4 Apply Host-based Firewalls or Port Filtering\nv7 Apply host-based firewalls or port filtering tools on end systems, with a default- ● ● ●\ndeny rule that drops all traffic except those services and ports that are explicitly\nallowed.\nPage 397",
    "page_number": 397
  },
  {
    "cis_id": "9.3.9",
    "title": "Ensure 'Windows Firewall: Public: Logging: Log\nsuccessful connections' is set to 'Yes'",
    "profile": "L1",
    "description": "Use this option to log when Windows Firewall with Advanced Security allows an\ninbound connection. The log records why and when the connection was formed. Look\nfor entries with the word ALLOW in the action column of the log.\nThe recommended state for this setting is: Yes.",
    "rationale": "If events are not recorded it may be difficult or impossible to determine the root cause of\nsystem problems or the unauthorized activities of malicious users.",
    "impact": "Information about successful connections will be recorded in the firewall log file.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging:LogSuc\ncessfulConnections",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to Yes.\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows\nDefender Firewall with Advanced Security\\Windows Defender Firewall with\nAdvanced Security\\Windows Defender Firewall Properties\\Public Profile\\Logging\nCustomize\\Log successful connections",
    "default_value": "No (default). (Information about successful connections will not be recorded in the\nfirewall log file.)\nReferences:\n1. GRID: MS-00000195\nPage 398\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.5 Implement and Manage a Firewall on End-User\nDevices\nv8 ● ● ●\nImplement and manage a host-based firewall or port-filtering tool on end-user\ndevices, with a default-deny rule that drops all traffic except those services and\nports that are explicitly allowed.\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\n9.4 Apply Host-based Firewalls or Port Filtering\nv7 Apply host-based firewalls or port filtering tools on end systems, with a default- ● ● ●\ndeny rule that drops all traffic except those services and ports that are explicitly\nallowed.\nPage 399\n10 Network List Manager Policies\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\n11 Wireless Network (IEEE 802.11) Policies\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\n12 Public Key Policies\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\n13 Software Restriction Policies\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\n14 Network Access Protection NAP Client Configuration\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\n15 Application Control Policies\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\n16 IP Security Policies\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\nPage 400",
    "page_number": 399
  }
]