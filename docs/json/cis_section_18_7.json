[
  {
    "cis_id": "18.7.11",
    "title": "Ensure 'Manage processing of Queue-specific files'\nis set to 'Enabled: Limit Queue-specific files to Color profiles'",
    "profile": "L1",
    "description": "This policy setting manages how queue-specific files are processed during printer\ninstallation. At printer installation time, a vendor-supplied installation application can\nspecify a set of files, of any type, to be associated with a particular print queue. The files\nare downloaded to each client that connects to the print server.\nThe recommended state for this setting is: Enabled: Limit Queue-specific files\nto Color profiles.",
    "rationale": "A Windows Print Spooler Remote Code Execution Vulnerability (CVE-2021-36958)\nexists when the Windows Print Spooler service improperly performs privileged file\noperations. An attacker who successfully exploits this vulnerability could run arbitrary\ncode with SYSTEM privileges and then install programs; view, change, or delete data;\nor create new accounts with full user rights.",
    "impact": "None - this is default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers:CopyFilesPolicy",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Limit Queue-specific files to Color profiles:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Manage\nprocessing of Queue-specific files\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).\nPage 619",
    "default_value": "Disabled. (Queue-specific files will be limited to Color profiles.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows-hardware/drivers/print/installing-\nqueue-specific-files\n2. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958\n3. GRID: MS-00000289\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 620",
    "page_number": 620
  },
  {
    "cis_id": "18.7.12",
    "title": "Ensure 'Point and Print Restrictions: When installing\ndrivers for a new connection' is set to 'Enabled: Show warning\nand elevation prompt'",
    "profile": "L1",
    "description": "This policy setting controls whether computers will show a warning and a security\nelevation prompt when users create a new printer connection using Point and Print.\nThe recommended state for this setting is: Enabled: Show warning and elevation\nprompt.\nNote: On August 10, 2021, Microsoft announced a Point and Print Default Behavior\nChange which modifies the default Point and Print driver installation and update\nbehavior to require Administrator privileges. This is documented in KB5005652—\nManage new Point and Print default driver installation behavior (CVE-2021-34481). This\nchange overrides all Point and Print Group Policy settings and ensures that only\nAdministrators can install printer drivers from a print server using Point and Print.",
    "rationale": "Enabling Windows User Account Control (UAC) for the installation of new print drivers\ncan help mitigate the PrintNightmare vulnerability (CVE-2021-34527) and other Print\nSpooler attacks.\nAlthough the Point and Print default driver installation behavior overrides this setting, it\nis important to configure this as a backstop in the event that behavior is reversed.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\Software\\Policies\\Microsoft\\Windows\nNT\\Printers\\PointAndPrint:NoWarningNoElevationOnInstall\nPage 621",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Show warning and elevation prompt:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Point and\nPrint Restrictions: When installing drivers for a new connection\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.",
    "default_value": "Enabled. (Windows computers will show a warning and a security elevation prompt\nwhen users create a new printer connection using Point and Print.)\nReferences:\n1. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675\n2. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481\n3. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527\n4. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958\n5. https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-\nchange/\n6. https://support.microsoft.com/en-us/topic/kb5005652-manage-new-point-and-\nprint-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-\na23b-6d8e9a302872\n7. GRID: MS-00000290\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 622",
    "page_number": 622
  },
  {
    "cis_id": "18.7.13",
    "title": "Ensure 'Point and Print Restrictions: When updating\ndrivers for an existing connection' is set to 'Enabled: Show\nwarning and elevation prompt'",
    "profile": "L1",
    "description": "This policy setting controls whether computers will show a warning and a security\nelevation prompt when users are updating drivers for an existing connection using Point\nand Print.\nThe recommended state for this setting is: Enabled: Show warning and elevation\nprompt.\nNote: On August 10, 2021, Microsoft announced a Point and Print Default Behavior\nChange which modifies the default Point and Print driver installation and update\nbehavior to require Administrator privileges. This is documented in KB5005652—\nManage new Point and Print default driver installation behavior (CVE-2021-34481). This\nchange overrides all Point and Print Group Policy settings and ensures that only\nAdministrators can install printer drivers from a print server using Point and Print.",
    "rationale": "Enabling Windows User Account Control (UAC) for updating existing print drivers can\nhelp mitigate the PrintNightmare vulnerability (CVE-2021-34527) and other Print\nSpooler attacks.\nAlthough the Point and Print default driver installation behavior overrides this setting, it\nis important to configure this as a backstop in the event that behavior is reversed.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\Software\\Policies\\Microsoft\\Windows\nNT\\Printers\\PointAndPrint:UpdatePromptSettings\nPage 623",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Show warning and elevation prompt:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Point and\nPrint Restrictions: When updating drivers for an existing connection\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.",
    "default_value": "Enabled. (Windows computers will show a warning and a security elevation prompt\nwhen users are updating drivers for an existing connection using Point and Print.)\nReferences:\n1. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675\n2. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34481\n3. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527\n4. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36958\n5. https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-\nchange/\n6. https://support.microsoft.com/en-us/topic/kb5005652-manage-new-point-and-\nprint-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-\na23b-6d8e9a302872\n7. GRID: MS-00000291\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 624",
    "page_number": 624
  },
  {
    "cis_id": "18.8.1.1",
    "title": "Ensure 'Turn off notifications network usage' is set\nto 'Enabled'",
    "profile": "L2",
    "description": "This policy setting blocks applications from using the network to send notifications to\nupdate tiles, tile badges, toast, or raw notifications. This policy setting turns off the\nconnection between Windows and the Windows Push Notification Service (WNS). This\npolicy setting also stops applications from being able to poll application services to\nupdate tiles.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Windows Push Notification Services (WNS) is a mechanism to receive third-party\nnotifications and updates from the cloud/Internet. In a high security environment,\nexternal systems, especially those hosted outside the organization, should be prevented\nfrom having an impact on the secure workstations.",
    "impact": "Applications and system features will not be able receive notifications from the network\nfrom WNS or via notification polling APIs.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\PushNotifications:NoC\nloudApplicationNotification",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Start Menu and\nTaskbar\\Notifications\\Turn off notifications network usage\nNote: This Group Policy path is provided by the Group Policy template WPN.admx/adml\nthat is included with the Microsoft Windows 10 Release 1607 & Server 2016\nAdministrative Templates (or newer).\nPage 626",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000293\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n9.2 Ensure Only Approved Ports, Protocols and\nServices Are Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a\nsystem with validated business needs, are running on each system.\nPage 627",
    "page_number": 627
  },
  {
    "cis_id": "18.8.2",
    "title": "Ensure 'Remove Personalized Website\nRecommendations from the Recommended section in the Start\nMenu' is set to 'Enabled'",
    "profile": "L2",
    "description": "This policy setting configures whether personalized website recommendations are\nshown in the in the Start Menu.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Microsoft's personalized website recommendations are based on data gathered from\nuser activity. This data could contain sensitive information.",
    "impact": "Personalized website recommendations will not be shown in the Start Menu.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer:HideRecommendedPersonalized\nSites",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Start Menu and\nTaskbar\\Remove Personalized Website Recommendations from the Recommended\nsection in the Start Menu\nNote: This Group Policy path is provided by the Group Policy template\nStartMenu.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v3.0 (or newer).",
    "default_value": "Disabled. (Personalized website recommendations will be shown in the Start Menu.)\nPage 628\nReferences:\n1. GRID: MS-00000292\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 629",
    "page_number": 629
  },
  {
    "cis_id": "18.9.3.1",
    "title": "Ensure 'Include command line in process creation\nevents' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls whether the process creation command line text is logged in\nsecurity audit events when a new process has been created.\nThe recommended state for this setting is: Enabled.\nNote: This feature that this setting controls was not originally supported in workstation\nOSes older than Windows 8.1. However, in February 2015 Microsoft added support for\nthe feature to Windows 7 and Windows 8.0 via an update - KB3004375. Therefore, this\nsetting is also important to set on those older OSes.",
    "rationale": "Capturing process command line information in event logs can be very valuable when\nperforming forensic investigations of attack incidents.",
    "impact": "Process command line information will be included in the event logs, which can contain\nsensitive or private information such as passwords or user data.\nWarning: There are potential risks of capturing credentials and sensitive information\nwhich could be exposed to users who have read-access to event logs. Microsoft\nprovides a feature called \"Protected Event Logging\" to better secure event log data. For\nassistance with protecting event logging, visit: About Logging Windows - PowerShell |\nMicrosoft Docs.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit:ProcessC\nreationIncludeCmdLine_Enabled\nPage 631",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Audit Process\nCreation\\Include command line in process creation events\nNote: This Group Policy path is provided by the Group Policy template\nAuditSettings.admx/adml that is included with the Microsoft Windows 8.1 & Server\n2012 R2 Administrative Templates (or newer).",
    "default_value": "Disabled. (Process command line information will not be included in Audit Process\nCreation events.)\nReferences:\n1. https://learn.microsoft.com/en-\nus/powershell/module/microsoft.powershell.core/about/about_logging_windows?\nview=powershell-7.2#protected-event-logging\n2. GRID: MS-00000294\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.8 Collect Command-Line Audit Logs\nv8 ● ●\nCollect command-line audit logs. Example implementations include collecting\naudit logs from PowerShell®, BASH™, and remote administrative terminals.\n16.4 Encrypt or Hash all Authentication Credentials\nv7 ● ●\nEncrypt or hash with a salt all authentication credentials when stored.\nPage 632",
    "page_number": 632
  },
  {
    "cis_id": "18.9.4.1",
    "title": "Ensure 'Encryption Oracle Remediation' is set to\n'Enabled: Force Updated Clients'",
    "profile": "L1",
    "description": "Some versions of the CredSSP protocol that is used by some applications (such as\nRemote Desktop Connection) are vulnerable to an encryption oracle attack against the\nclient. This policy controls compatibility with vulnerable clients and servers and allows\nyou to set the level of protection desired for the encryption oracle vulnerability.\nThe recommended state for this setting is: Enabled: Force Updated Clients.",
    "rationale": "This setting is important to mitigate the CredSSP encryption oracle vulnerability, for\nwhich information was published by Microsoft on 03/13/2018 in CVE-2018-0886 |\nCredSSP Remote Code Execution Vulnerability. All versions of Windows from Windows\nVista onwards are affected by this vulnerability, and will be compatible with this\nrecommendation provided that they have been patched at least through May 2018 (or\nlater).",
    "impact": "Client applications which use CredSSP will not be able to fall back to the insecure\nversions and services using CredSSP will not accept unpatched clients. This setting\nshould not be deployed until all remote hosts support the newest version, which is\nachieved by ensuring that all Microsoft security updates at least through May 2018 are\ninstalled.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\CredSSP\\Parame\nters:AllowEncryptionOracle\nPage 634",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Force Updated Clients:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Credentials\nDelegation\\Encryption Oracle Remediation\nNote: This Group Policy path is provided by the Group Policy template\nCredSsp.admx/adml that is included with the Microsoft Windows 10 Release 1803\nAdministrative Templates (or newer).",
    "default_value": "Without the May 2018 security update: Enabled: Vulnerable (Client applications which\nuse CredSSP will expose the remote servers to attacks by supporting fall back to the\ninsecure versions and services using CredSSP will accept unpatched clients.)\nWith the May 2018 security update: Enabled: Mitigated (Client applications which use\nCredSSP will not be able to fall back to the insecure version but services using\nCredSSP will accept unpatched clients.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/win32/secauthn/credential-security-\nsupport-provider\n2. GRID: MS-00000295\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 635",
    "page_number": 635
  },
  {
    "cis_id": "18.9.4.2",
    "title": "Ensure 'Remote host allows delegation of non-\nexportable credentials' is set to 'Enabled'",
    "profile": "L1",
    "description": "Remote host allows delegation of non-exportable credentials. When using credential\ndelegation, devices provide an exportable version of credentials to the remote host. This\nexposes users to the risk of credential theft from attackers on the remote host. The\nRestricted Admin Mode and Windows Defender Remote Credential Guard features are\ntwo options to help protect against this risk.\nThe recommended state for this setting is: Enabled.\nNote: More detailed information on Windows Defender Remote Credential Guard and\nhow it compares to Restricted Admin Mode can be found at this link: Protect Remote\nDesktop credentials with Windows Defender Remote Credential Guard (Windows 10) |\nMicrosoft Docs",
    "rationale": "Restricted Admin Mode was designed to help protect administrator accounts by\nensuring that reusable credentials are not stored in memory on remote devices that\ncould potentially be compromised. Windows Defender Remote Credential Guard helps\nyou protect your credentials over a Remote Desktop connection by redirecting Kerberos\nrequests back to the device that is requesting the connection. Both features should be\nenabled and supported, as they reduce the chance of credential theft.",
    "impact": "The host will support the Restricted Admin Mode and Windows Defender Remote\nCredential Guard features.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation:AllowProtected\nCreds\nPage 636",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Credentials\nDelegation\\Remote host allows delegation of non-exportable credentials\nNote: This Group Policy path is provided by the Group Policy template\nCredSsp.admx/adml that is included with the Microsoft Windows 10 Release 1703\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (Restricted Admin Mode and Windows Defender Remote Credential Guard\nare not supported. Users will always need to pass their credentials to the host.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/identity-protection/remote-\ncredential-guard\n2. GRID: MS-00000296\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n16.5 Encrypt Transmittal of Username and\nAuthentication Credentials\nv7 ● ●\nEnsure that all account usernames and authentication credentials are\ntransmitted across networks using encrypted channels.\nPage 637",
    "page_number": 637
  },
  {
    "cis_id": "18.9.5.1",
    "title": "Ensure 'Turn On Virtualization Based Security' is set\nto 'Enabled'",
    "profile": "L1",
    "description": "This policy setting specifies whether Virtualization Based Security is enabled.\nVirtualization Based Security uses the Windows Hypervisor to provide support for\nsecurity services.\nThe recommended state for this setting is: Enabled.\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.\nNote #3: If the Level 2 recommendation to configure Log on as a service (from Section\n2.2) is implemented, the additional security principal WDAGUtilityAccount must also\nbe granted that User Right Assignment in order for Virtualization Based Security (in\nMicrosoft Defender Application Guard) with the Next Generation Windows Security\n(NGWS) profile to function.",
    "rationale": "Kerberos, NTLM, and Credential manager isolate secrets by using virtualization-based\nsecurity. Previous versions of Windows stored secrets in the Local Security Authority\n(LSA). Prior to Windows 10, the LSA stored secrets used by the operating system in its\nprocess memory. With Windows Defender Credential Guard enabled, the LSA process\nin the operating system talks to a new component called the isolated LSA process that\nstores and protects those secrets. Data stored by the isolated LSA process is protected\nusing virtualization-based security and is not accessible to the rest of the operating\nsystem.\nPage 639",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:EnableVirtualizationBase\ndSecurity",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 RTM\n(Release 1507) Administrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000297\nPage 640\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 641",
    "page_number": 640
  },
  {
    "cis_id": "18.9.5.2",
    "title": "Ensure 'Turn On Virtualization Based Security:\nSelect Platform Security Level' is set to 'Secure Boot' or higher",
    "profile": "L1",
    "description": "This policy setting specifies whether Virtualization Based Security (VBS) is enabled.\nVBS uses the Windows Hypervisor to provide support for security services.\nThe recommended state for this setting is: Secure Boot or Secure Boot and DMA\nProtection.\nNote: VBS requires a 64-bit version of Windows with Secure Boot enabled, which in\nturn requires that Windows was installed with a UEFI BIOS configuration, not a Legacy\nBIOS configuration. In addition, if running Windows on a virtual machine, the hardware-\nassisted CPU virtualization feature (Intel VT-x or AMD-V) must be exposed by the host\nto the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "Secure Boot can help reduce the risk of bootloader attacks and in conjunction with DMA\nprotections to help protect data from being scraped from memory.\nPage 642",
    "impact": "Choosing the Secure Boot option provides the system with as much protection as is\nsupported by the computer’s hardware. A system with input/output memory\nmanagement units (IOMMUs) will have Secure Boot with DMA protection. A system\nwithout IOMMUs will simply have Secure Boot enabled without DMA protection.\nChoosing the Secure Boot with DMA protection option requires the system to have\nIOMMUs in order to enable VBS. Without IOMMU hardware support, VBS will be\ndisabled.\nNote: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1 or 3.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:RequirePlatformSecurityF\neatures",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to Secure\nBoot or Secure Boot and DMA Protection:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Select Platform Security Level\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 RTM\n(Release 1507) Administrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000302\nPage 643\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 644",
    "page_number": 643
  }
]