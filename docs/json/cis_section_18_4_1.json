[
  {
    "cis_id": "18.4.1",
    "title": "Ensure 'Configure SMB v1 client driver' is set to\n'Enabled: Disable driver (recommended)'",
    "profile": "L1",
    "description": "This setting configures the start type for the Server Message Block version 1 (SMBv1)\nclient driver service (MRxSmb10), which is recommended to be disabled.\nThe recommended state for this setting is: Enabled: Disable driver\n(recommended).\nNote: Do not, under any circumstances, configure this overall setting as Disabled, as\ndoing so will delete the underlying registry entry altogether, which will cause serious\nproblems.",
    "rationale": "Since September 2016, Microsoft has strongly encouraged that SMBv1 be disabled and\nno longer used on modern networks, as it is a 30 year old design that is much more\nvulnerable to attacks then much newer designs such as SMBv2 and SMBv3.\nMore information on this can be found at the following links:\nStop using SMB1 | Storage at Microsoft\nDisable SMB v1 in Managed Environments with Group Policy – \"Stay Safe\" Cyber\nSecurity Blog\nDisabling SMBv1 through Group Policy – Microsoft Security Guidance blog",
    "impact": "Some legacy OSes (e.g. Windows XP, Server 2003 or older), applications and\nappliances may no longer be able to communicate with the system once SMBv1 is\ndisabled. We recommend careful testing be performed to determine the impact prior to\nconfiguring this as a widespread control, and where possible, remediate any\nincompatibilities found with the vendor of the incompatible system. Microsoft is also\nmaintaining a thorough (although not comprehensive) list of known SMBv1\nincompatibilities at this link: SMB1 Product Clearinghouse | Storage at Microsoft\nPage 484",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 4.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\mrxsmb10:Start",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Disable driver (recommended):\nComputer Configuration\\Policies\\Administrative Templates\\MS Security\nGuide\\Configure SMB v1 client driver\nNote: This Group Policy path does not exist by default. An additional Group Policy\ntemplate (SecGuide.admx/adml) is required - it is available from Microsoft at this link.",
    "default_value": "Windows 7 and Windows 8.0: Enabled: Manual start.\nWindows 8.1 and Windows 10 (up to R1703): Enabled: Automatic start.\nWindows 10 R1709 or newer: Enabled: Disable driver.\nReferences:\n1. https://techcommunity.microsoft.com/t5/microsoft-security-baselines/disabling-\nsmbv1-through-group-policy/ba-p/701069\n2. https://learn.microsoft.com/en-us/windows-server/storage/file-\nserver/troubleshoot/detect-enable-and-disable-smbv1-v2-v3\n3. GRID: MS-00000242\nPage 485\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\n14.3 Disable Workstation to Workstation Communication\nv7 Disable all workstation to workstation communication to limit an attacker's ● ●\nability to move laterally and compromise neighboring systems, through\ntechnologies such as Private VLANs or microsegmentation.\nPage 486",
    "page_number": 485
  },
  {
    "cis_id": "18.4.2",
    "title": "Ensure 'Configure SMB v1 server' is set to 'Disabled'",
    "profile": "L1",
    "description": "This setting configures the server-side processing of the Server Message Block version\n1 (SMBv1) protocol.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Since September 2016, Microsoft has strongly encouraged that SMBv1 be disabled and\nno longer used on modern networks, as it is a 30 year old design that is much more\nvulnerable to attacks then much newer designs such as SMBv2 and SMBv3.\nMore information on this can be found at the following links:\nStop using SMB1 | Storage at Microsoft\nDisable SMB v1 in Managed Environments with Group Policy – \"Stay Safe\" Cyber\nSecurity Blog\nDisabling SMBv1 through Group Policy – Microsoft Security Guidance blog",
    "impact": "Some legacy OSes (e.g. Windows XP, Server 2003 or older), applications and\nappliances may no longer be able to communicate with the system once SMBv1 is\ndisabled. We recommend careful testing be performed to determine the impact prior to\nconfiguring this as a widespread control, and where possible, remediate any\nincompatibilities found with the vendor of the incompatible system. Microsoft is also\nmaintaining a thorough (although not comprehensive) list of known SMBv1\nincompatibilities at this link: SMB1 Product Clearinghouse | Storage at Microsoft",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters:SMB1\nPage 487",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\MS Security\nGuide\\Configure SMB v1 server\nNote: This Group Policy path does not exist by default. An additional Group Policy\ntemplate (SecGuide.admx/adml) is required - it is available from Microsoft at this link.",
    "default_value": "Windows 10 R1703 and older: Enabled.\nWindows 10 R1709 or newer: Disabled.\nReferences:\n1. https://techcommunity.microsoft.com/t5/microsoft-security-baselines/disabling-\nsmbv1-through-group-policy/ba-p/701069\n2. GRID: MS-00000243\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\n14.3 Disable Workstation to Workstation Communication\nv7 Disable all workstation to workstation communication to limit an attacker's ● ●\nability to move laterally and compromise neighboring systems, through\ntechnologies such as Private VLANs or microsegmentation.\nPage 488",
    "page_number": 488
  },
  {
    "cis_id": "18.4.3",
    "title": "Ensure 'Enable Certificate Padding' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting configures whether the WinVerifyTrust function performs strict\nWindows Authenticode signature verification for Portable Executable files (PE files). If\nenabled, PE files will be considered \"unsigned\" if Windows identifies content in them\nthat does not conform to the Authenticode specification.\nThe recommended state for this setting is: Enabled.",
    "rationale": "A remote code execution vulnerability exists in the way that the WinVerifyTrust function\nhandles Windows Authenticode signature verification for portable executable (PE) files.\nFor more information on this vulnerability, visit CVE-2013-3900 - Security Update Guide\n- Microsoft - WinVerifyTrust Signature Validation Vulnerability.",
    "impact": "Microsoft recommends that installers are built to only extract content from validated\nportions of signed files. Some installers do not follow this guidance and therefore may\nbe negatively impacted by this setting.\nPage 489",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.\nThis group policy setting is backed by the following registry location with a REG_DWORD\nor REG_SZ value of 1.\nHKLM\\SOFTWARE\\Microsoft\\Cryptography\\Wintrust\\Config:EnableCertPaddingCheck\n32-bit subsystem on 64-bit OS\nNavigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.\nThis group policy setting is backed by the following registry location with a REG_DWORD\nor REG_SZ value of 1.\nHKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Cryptography\\Wintrust\\Config:EnableCertPa\nddingCheck",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\MS Security\nGuide\\Enable Certificate Padding\nNote: This Group Policy path does not exist by default. An additional Group Policy\ntemplate (SecGuide.admx/adml) is required - it is available from Microsoft at this link.",
    "default_value": "Disabled. (The WinVerifyTrust function does not perform strict Windows Authenticode\nsignature verification for Portable Executable files (PE files).)\nReferences:\n1. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2013-3900\n2. https://learn.microsoft.com/en-us/windows/win32/api/wintrust/nf-wintrust-\nwinverifytrust\n3. https://aaron-margosis.medium.com/enable-certificate-padding-check-reg-sz-or-\nreg-dword-675603f0790b\n4. https://msrc.microsoft.com/update-guide/advisory/ADV2915720\n5. GRID: MS-00000244\nPage 490\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 491",
    "page_number": 490
  },
  {
    "cis_id": "18.4.4",
    "title": "Ensure 'Enable Structured Exception Handling\nOverwrite Protection (SEHOP)' is set to 'Enabled'",
    "profile": "L1",
    "description": "Windows includes support for Structured Exception Handling Overwrite Protection\n(SEHOP). We recommend enabling this feature to improve the security profile of the\ncomputer.\nThe recommended state for this setting is: Enabled.",
    "rationale": "This feature is designed to block exploits that use the Structured Exception Handler\n(SEH) overwrite technique. This protection mechanism is provided at run-time.\nTherefore, it helps protect applications regardless of whether they have been compiled\nwith the latest improvements, such as the /SAFESEH option.",
    "impact": "After you enable SEHOP, existing versions of Cygwin, Skype, and Armadillo-protected\napplications may not work correctly.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Session\nManager\\kernel:DisableExceptionChainValidation",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\MS Security\nGuide\\Enable Structured Exception Handling Overwrite Protection (SEHOP)\nNote: This Group Policy path does not exist by default. An additional Group Policy\ntemplate (SecGuide.admx/adml) is required - it is available from Microsoft at this link.\nMore information is available at MSKB 956607: How to enable Structured Exception\nHandling Overwrite Protection (SEHOP) in Windows operating systems\nPage 492",
    "default_value": "Disabled for 32-bit processes.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/override-\nmitigation-options-for-app-related-security-policies\n2. GRID: MS-00000245\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 493",
    "page_number": 493
  },
  {
    "cis_id": "18.4.5",
    "title": "Ensure 'NetBT NodeType configuration' is set to\n'Enabled: P-node (recommended)'",
    "profile": "L1",
    "description": "This setting determines which method NetBIOS over TCP/IP (NetBT) uses to register\nand resolve names. The available methods are:\n• The B-node (broadcast) method only uses broadcasts.\n• The P-node (point-to-point) method only uses name queries to a name server\n(WINS).\n• The M-node (mixed) method broadcasts first, then queries a name server (WINS)\nif broadcast failed.\n• The H-node (hybrid) method queries a name server (WINS) first, then broadcasts\nif the query failed.\nThe recommended state for this setting is: Enabled: P-node (recommended) (point-\nto-point).\nNote: Resolution through LMHOSTS or DNS follows these methods. If the NodeType\nregistry value is present, it overrides any DhcpNodeType registry value. If neither\nNodeType nor DhcpNodeType is present, the computer uses B-node (broadcast) if there\nare no WINS servers configured for the network, or H-node (hybrid) if there is at least\none WINS server configured.",
    "rationale": "In order to help mitigate the risk of NetBIOS Name Service (NBT-NS) poisoning attacks,\nsetting the node type to P-node (point-to-point) will prevent the system from sending out\nNetBIOS broadcasts.",
    "impact": "NetBIOS name resolution queries will require a defined and available WINS server for\nexternal NetBIOS name resolution. If a WINS server is not defined or not reachable,\nand the desired hostname is not defined in the local cache, local LMHOSTS or HOSTS\nfiles, NetBIOS name resolution will fail.\nPage 494",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 2.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters:NodeType",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: P-node (recommended):\nComputer Configuration\\Policies\\Administrative Templates\\MS Security\nGuide\\NetBT NodeType configuration\nNote: This change does not take effect until the computer has been restarted.\nNote #2: This Group Policy path does not exist by default. An additional Group Policy\ntemplate (SecGuide.admx/adml) is required - it is available from Microsoft at this link.\nPlease note that this setting is only available in the Security baseline (FINAL) for\nWindows 10 v1903 and Windows Server v1903 (or newer) release of\nSecGuide.admx/adml, so if you previously downloaded this template, you may need to\nupdate it from a newer Microsoft baseline to get this new NetBT NodeType\nconfiguration setting.",
    "default_value": "B-node (broadcast only) if a WINS server is not configured in NIC properties.\nH-node (hybrid - point-to-point first, then broadcast) if a WINS server is configured in\nNIC properties.\nReferences:\n1. https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-\ncifs/45170055-a0cd-4910-9228-801d5bf7ac84\n2. GRID: MS-00000247\nPage 495\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.1 Establish and Maintain a Secure Configuration Process\nEstablish and maintain a secure configuration process for enterprise assets\nv8 (end-user devices, including portable and mobile, non-computing/IoT devices, and ● ● ●\nservers) and software (operating systems and applications). Review and update\ndocumentation annually, or when significant enterprise changes occur that could\nimpact this Safeguard.\n5.1 Establish Secure Configurations\nv7 ● ● ●\nMaintain documented, standard security configuration standards for all\nauthorized operating systems and software.\nPage 496",
    "page_number": 495
  },
  {
    "cis_id": "18.4.6",
    "title": "Ensure 'WDigest Authentication' is set to 'Disabled'",
    "profile": "L1",
    "description": "When WDigest authentication is enabled, Lsass.exe retains a copy of the user's\nplaintext password in memory, where it can be at risk of theft. If this setting is not\nconfigured, WDigest authentication is disabled in Windows 8.1 and in Windows Server\n2012 R2; it is enabled by default in earlier versions of Windows and Windows Server.\nFor more information about local accounts and credential theft, review the \"Mitigating\nPass-the-Hash (PtH) Attacks and Other Credential Theft Techniques\" documents.\nFor more information about UseLogonCredential, see Microsoft Knowledge Base\narticle 2871997: Microsoft Security Advisory Update to improve credentials protection\nand management May 13, 2014.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Preventing the plaintext storage of credentials in memory may reduce opportunity for\ncredential theft.",
    "impact": "None - this is also the default configuration for Windows 8.1 or newer.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest:UseLogonCrede\nntial\nPage 497",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\MS Security\nGuide\\WDigest Authentication (disabling may require KB2871997)\nNote: This Group Policy path does not exist by default. An additional Group Policy\ntemplate (SecGuide.admx/adml) is required - it is available from Microsoft at this link.",
    "default_value": "On Windows 8.0 and older: Enabled. (Lsass.exe retains a copy of the user's plaintext\npassword in memory, where it is at risk of theft.)\nOn Windows 8.1 or newer: Disabled. (Lsass.exe does not retain a copy of the user's\nplaintext password in memory.)\nReferences:\n1. https://www.microsoft.com/en-us/download/details.aspx?id=36036\n2. https://support.microsoft.com/en-us/topic/microsoft-security-advisory-update-to-\nimprove-credentials-protection-and-management-may-13-2014-93434251-04ac-\nb7f3-52aa-9f951c14b649\n3. GRID: MS-00000248\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.11 Encrypt Sensitive Data at Rest\nEncrypt sensitive data at rest on servers, applications, and databases containing\nv8 sensitive data. Storage-layer encryption, also known as server-side encryption, ● ●\nmeets the minimum requirement of this Safeguard. Additional encryption methods\nmay include application-layer encryption, also known as client-side encryption,\nwhere access to the data storage device(s) does not permit access to the plain-text\ndata.\n16.4 Encrypt or Hash all Authentication Credentials\nv7 ● ●\nEncrypt or hash with a salt all authentication credentials when stored.\nPage 498",
    "page_number": 498
  }
]