[
  {
    "cis_id": "18.6.4.1",
    "title": "Ensure 'Configure multicast DNS (mDNS) protocol'\nis set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting determines if the DNS client will perform name resolution over\nMulticast DNS (mDNS). mDNS performs local network name and service discoveries\nwithout the need for central DNS.\nThe recommended state for this setting is: Disabled.",
    "rationale": "An attacker can listen on a network over UDP port 5353 and respond to them, tricking\nthe host into thinking that it knows the location of the requested system.",
    "impact": "In the event DNS is unavailable a system will be unable to request it from other systems\non the same subnet.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient:EnableMDNS",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\DNS\nClient\\Configure multicast DNS (mDNS) protocol\nNote: This Group Policy path is provided by the Group Policy template\nDnsClient.admx/adml that is included with the Microsoft Windows 11 Release 24H2\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (The system will use locally configured settings.)\nPage 527\nReferences:\n1. https://techcommunity.microsoft.com/blog/networkingblog/mdns-in-the-\nenterprise/3275777\n2. https://www.wolfandco.com/resources/blog/penetration-testers-best-frienddns-\nllmnr-netbios-ns/\n3. GRID: MS-00000574\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 528",
    "page_number": 528
  },
  {
    "cis_id": "18.6.4.2",
    "title": "Ensure 'Turn off default IPv6 DNS Servers' is set to\n'Enabled'",
    "profile": "L2",
    "description": "This policy setting controls whether the DNS client will use the default IPv6 DNS server\naddresses provided by Windows.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Since the vast majority of private enterprise managed networks have no need to utilize\nIPv6 (because they have access to private IPv4 addressing), disabling the use of IPv6\nDNS server addresses removes a possible attack surface that is also harder to monitor\nthe traffic on.\nIt is not recommended to use DNS servers that are controlled by an external entity\nwithout input from the organization’s IT department.",
    "impact": "Default IPv6 DNS server addresses will not be utilized by Windows.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\nNT\\DNSClient:DisableIPv6DefaultDnsServers",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\DNS\nClient\\Turn off default IPv6 DNS Servers\nNote: This Group Policy path is provided by the Group Policy template\nDnsClient.admx/adml that is included with the Microsoft Windows 11 Release 24H2\nAdministrative Templates (or newer).\nPage 529",
    "default_value": "Disabled. (The default IPv6 DNS server addresses provided by Windows will be\nutilized.)\nReferences:\n1. GRID: MS-00000575\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 530",
    "page_number": 530
  },
  {
    "cis_id": "18.6.5.1",
    "title": "Ensure 'Enable Font Providers' is set to 'Disabled'",
    "profile": "L2",
    "description": "This policy setting determines whether Windows is allowed to download fonts and font\ncatalog data from an online font provider.\nThe recommended state for this setting is: Disabled.",
    "rationale": "In an enterprise managed environment the IT department should be managing the\nchanges to the system configuration, to ensure all changes are tested and approved.",
    "impact": "Windows will not connect to an online font provider and will only enumerate locally-\ninstalled fonts.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System:EnableFontProviders",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Fonts\\Enable\nFont Providers\nNote: This Group Policy path is provided by the Group Policy template\nGroupPolicy.admx/adml that is included with the Microsoft Windows 10 Release 1607\n& Server 2016 Administrative Templates (or newer).",
    "default_value": "Enabled. (Fonts that are included in Windows but that are not stored locally will be\ndownloaded on demand from an online font provider.)\nPage 532\nReferences:\n1. GRID: MS-00000265\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n16.5 Use Up-to-Date and Trusted Third-Party Software\nComponents\nv8\nUse up-to-date and trusted third-party software components. When possible,\n● ●\nchoose established and proven frameworks and libraries that provide adequate\nsecurity. Acquire these components from trusted sources or evaluate the software\nfor vulnerabilities before use.\n18.4 Only Use Up-to-date And Trusted Third-Party\nComponents\nv7 ● ●\nOnly use up-to-date and trusted third-party components for the software\ndeveloped by the organization.\n18.6.6 Hotspot Authentication\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\nThis Group Policy section is provided by the Group Policy template\nhotspotauth.admx/adml that is included with the Microsoft Windows 8.0 & Server\n2012 (non-R2) Administrative Templates (or newer).\nPage 533",
    "page_number": 533
  },
  {
    "cis_id": "18.6.7.1",
    "title": "Ensure 'Audit client does not support encryption' is\nset to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the Server Message Block (SMB) server will log\nevents when the SMB client doesn't support encryption.\nEnabling this will create event log entries in Applications and Services\nLogs\\Microsoft\\Windows\\SMBClient\\Audit, with Event ID 31998.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Organizations should be aware of all unencrypted SMB traffic in their environment.\nOlder SMB protocols that do not use encryption can make an environment susceptible\nto many types of attacks, including SMB interception attacks.",
    "impact": "All SMB traffic that is unencrypted will be logged as an event.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:AuditClientDoesNotSuppo\nrtEncryption",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Audit client does not support encryption\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (The SMB server will not log the event.)\nPage 535\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\nsigning-overview#smb-signing-and-encryption-auditing\n3. GRID: MS-00000576\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 536",
    "page_number": 536
  },
  {
    "cis_id": "18.6.7.2",
    "title": "Ensure 'Audit client does not support signing' is set\nto 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the Server Message Block (SMB) server will log\nevents when the SMB client doesn't support signing.\nEnabling this will create event log entries in Applications and Services\nLogs\\Microsoft\\Windows\\SMBClient\\Audit, with Event ID 31999.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Organizations should be aware of all unsigned SMB traffic in their environment. Older\nSMB protocols that do not use signing can make an environment susceptible to many\ntypes of attacks, including SMB interception attacks.",
    "impact": "All SMB traffic that is unsigned will be logged as an event.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:AuditClientDoesNotSuppo\nrtSigning",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Audit client does not support signing\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (The SMB server will not log the event.)\nPage 537\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\nsigning-overview#smb-signing-and-encryption-auditing\n3. GRID: MS-00000577\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 538",
    "page_number": 538
  },
  {
    "cis_id": "18.6.7.3",
    "title": "Ensure 'Audit insecure guest logon' is set to\n'Enabled'",
    "profile": "L1",
    "description": "This policy determines whether the Server Message Block (SMB) server will log events\nwhen the client is logged on as guest account.\nEnabling this will create event log entries in Applications and Service\nLogs\\Microsoft\\Windows\\SMBServer\\Security, with Event IDs 3023, 31017, 31018,\nand 31022.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Insecure guest logons can be used by file servers to allow unauthenticated access to\nshared folders.",
    "impact": "All insecure guest logons will be logged as an event.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:AuditInsecureGuestLogon",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Audit insecure guest logon\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (The SMB server will not log the event.)\nPage 539\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. GRID: MS-00000608\n3. https://learn.microsoft.com/en-us/windows-server/storage/file-server/enable-\ninsecure-guest-logons-smb2-and-smb3?tabs=group-policy#audit-insecure-guest-\nlogons\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 540",
    "page_number": 540
  },
  {
    "cis_id": "18.6.7.4",
    "title": "Ensure 'Enable authentication rate limiter' is set to\n'Enabled'",
    "profile": "L1",
    "description": "This policy settings configures the Server Message Block (SMB) server authentication\nrate limiter. The authentication rate limiter is a feature of SMB that is designed to\naddress brute force attacks.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Authentication rate limiter considerably reduces the risk of brute force attacks by\nimplementing a 2-second delay (default) between each failed NTLM or PKU2U-based\nauthentication attempt.\nAccording to Microsoft, if an attacker sends 300 brute force attempts per second from a\nclient for 5 minutes which equals 90,000 passwords, the same number of attempts\nwould now take 50 hours or more.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:EnableAuthRateLimiter",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Enable authentication rate limiter\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Enabled. (2 seconds.)\nPage 541\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. https://techcommunity.microsoft.com/blog/filecab/smb-authentication-rate-limiter-\nnow-on-by-default-in-windows-insider/3634244\n3. GRID: MS-00000579\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 542",
    "page_number": 542
  },
  {
    "cis_id": "18.6.7.5",
    "title": "Ensure 'Enable remote mailslots' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy settings controls whether the SMB server will use remote mailslots over the\ncomputer browser service. The remote mailslots protocol is an old, simple, unreliable,\nand insecure inter-process communication method.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Remote mailslots is a legacy protocol that uses SMBv1 to function. This protocol is\nlinked to known vulnerabilities, such as denial of service, buffer overflow, and remote\ncode execution attacks.",
    "impact": "If the remote mailslots feature was in operation, it will no longer function.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Bowser:EnableMailslots",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Enable remote mailslots\nNote: A reboot is required after the setting is applied.\nNote #2: This Group Policy path may not exist by default. It is provided by the Group\nPolicy template LanmanServer.admx/adml that is included with the Microsoft Windows\n11 Release 24H2 Administrative Templates (or newer).",
    "default_value": "Enabled. (The computer browser may still be working with remote mailslots enabled.)\nPage 543\nReferences:\n1. https://techcommunity.microsoft.com/blog/filecab/the-beginning-of-the-end-of-\nremote-mailslots-as-part-of-windows-insider/3762048\n2. GRID: MS-00000580\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 544",
    "page_number": 544
  },
  {
    "cis_id": "18.6.7.6",
    "title": "Ensure 'Mandate the minimum version of SMB' is\nset to 'Enabled: 3.1.1'",
    "profile": "L1",
    "description": "This policy settings controls the minimum version of Server Message Block (SMB)\nprotocol that can be used on the system.\nThe recommended state for this setting is: Enabled: 3.1.1.\nNote: This group policy setting does not prevent the use of SMBv1 if it is installed and\nenabled on the system. If the following recommendations are configured as prescribed\nin this benchmark, SMBv1 will be disabled on the system: Configure SMB v1 client\ndriver and Configure SMB v1 server.",
    "rationale": "The newer, more modern version of SMB (v3) is supported and available on all currently\nsupported Microsoft Windows OSes. SMBv1 is no longer enabled by default due to its\nsecurity risks, and although SMBv2 is more robust than v1, it does not support\nencryption like its successor.",
    "impact": "If older legacy (unsupported) Windows OSes that do not support SMB v3.1.1 are\npresent in the environment, this setting may affect backward compatibility with them.\nFor example, Windows 8.1 and Windows Server 2012 R2 and older. This setting may\nalso prevent third-party clients that do not support SMB v3.1.1 from connecting.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 785.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:MinSmb2Dialect\nPage 545",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: 3.1.1:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Mandate the minimum version of SMB\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (SMB v2.0 or higher are enabled by default.)\nReferences:\n1. GRID: MS-00000581\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 546",
    "page_number": 546
  },
  {
    "cis_id": "18.6.7.7",
    "title": "Ensure 'Set authentication rate limiter delay\n(milliseconds)' is set to 'Enabled: 2000' or more",
    "profile": "L1",
    "description": "This policy settings configures the SMB server invalid authentication delay value in\nmilliseconds.\nThe recommended state for this setting is: Enabled: 2000 or more.",
    "rationale": "Authentication rate limiter considerably reduces the risk of brute force attacks by\nimplementing a 2-second delay (default) between each failed NTLM or PKU2U-based\nauthentication attempt.\nAccording to Microsoft, if an attacker sends 300 brute force attempts per second from a\nclient for 5 minutes which equals 90,000 passwords, the same number of attempts\nwould now take 50 hours or more.",
    "impact": "None - 2,000 milliseconds (2 seconds) is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 2000 or more.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:InvalidAuthenticationDe\nlayTimeInMs",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: 2000 or more:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Set authentication rate limiter delay (milliseconds)\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Enabled. (2 seconds)\nPage 547\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. https://techcommunity.microsoft.com/blog/filecab/smb-authentication-rate-limiter-\nnow-on-by-default-in-windows-insider/3634244\n3. GRID: MS-00000582\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 548",
    "page_number": 548
  }
]