[
  {
    "cis_id": "2.2.21",
    "title": "Ensure 'Enable computer and user accounts to be\ntrusted for delegation' is set to 'No One'",
    "profile": "L1",
    "description": "This policy setting allows users to change the Trusted for Delegation setting on a\ncomputer object in Active Directory. Abuse of this privilege could allow unauthorized\nusers to impersonate other users on the network.\nThe recommended state for this setting is: No One.\nNote: This user right is considered a \"sensitive privilege\" for the purposes of auditing.",
    "rationale": "Misuse of the Enable computer and user accounts to be trusted for delegation user\nright could allow unauthorized users to impersonate other users on the network. An\nattacker could exploit this privilege to gain access to network resources and make it\ndifficult to determine what has happened after a security incident.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to No\nOne:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Enable computer and user accounts to be\ntrusted for delegation",
    "default_value": "No one.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/enable-computer-and-user-accounts-to-be-trusted-for-delegation\n2. GRID: MS-00000033\nPage 109\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 110",
    "page_number": 110
  },
  {
    "cis_id": "2.2.22",
    "title": "Ensure 'Force shutdown from a remote system' is set\nto 'Administrators'",
    "profile": "L1",
    "description": "This policy setting allows users to shut down Windows Vista-based or newer computers\nfrom remote locations on the network. Anyone who has been assigned this user right\ncan cause a denial of service (DoS) condition, which would make the computer\nunavailable to service user requests. Therefore, it is recommended that only highly\ntrusted administrators be assigned this user right.\nThe recommended state for this setting is: Administrators.",
    "rationale": "Any user who can shut down a computer could cause a DoS condition to occur.\nTherefore, this user right should be tightly restricted.",
    "impact": "If you remove the Force shutdown from a remote system user right from the Server\nOperators group you could limit the abilities of users who are assigned to specific\nadministrative roles in your environment. You should confirm that delegated activities\nwill not be adversely affected.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nAdministrators:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Force shutdown from a remote system",
    "default_value": "Administrators.\nPage 111\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/force-shutdown-from-a-remote-system\n2. GRID: MS-00000034\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 112",
    "page_number": 112
  },
  {
    "cis_id": "2.2.23",
    "title": "Ensure 'Generate security audits' is set to 'LOCAL\nSERVICE, NETWORK SERVICE'",
    "profile": "L1",
    "description": "This policy setting determines which users or processes can generate audit records in\nthe Security log.\nThe recommended state for this setting is: LOCAL SERVICE, NETWORK SERVICE.\nNote: This user right is considered a \"sensitive privilege\" for the purposes of auditing.",
    "rationale": "An attacker could use this capability to create a large number of audited events, which\nwould make it more difficult for a system administrator to locate any illicit activity. Also, if\nthe event log is configured to overwrite events as needed, any evidence of unauthorized\nactivities could be overwritten by a large number of unrelated events.",
    "impact": "On most computers, this is the default configuration and there will be no negative\nimpact. However, if you have installed Web Server (IIS), you will need to allow the IIS\napplication pool(s) to be granted this user right.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to LOCAL\nSERVICE, NETWORK SERVICE:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Generate security audits",
    "default_value": "LOCAL SERVICE, NETWORK SERVICE.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/generate-security-audits\n2. GRID: MS-00000035\nPage 113\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\n6.2 Activate audit logging\nv7 ● ● ●\nEnsure that local logging has been enabled on all systems and networking\ndevices.\nPage 114",
    "page_number": 114
  },
  {
    "cis_id": "2.2.24",
    "title": "Ensure 'Impersonate a client after authentication' is\nset to 'Administrators, LOCAL SERVICE, NETWORK SERVICE,\nSERVICE'",
    "profile": "L1",
    "description": "The policy setting allows programs that run on behalf of a user to impersonate that user\n(or another specified account) so that they can act on behalf of the user. If this user right\nis required for this kind of impersonation, an unauthorized user will not be able to\nconvince a client to connect—for example, by remote procedure call (RPC) or named\npipes—to a service that they have created to impersonate that client, which could\nelevate the unauthorized user's permissions to administrative or system levels.\nServices that are started by the Service Control Manager have the built-in Service group\nadded by default to their access tokens. COM servers that are started by the COM\ninfrastructure and configured to run under a specific account also have the Service\ngroup added to their access tokens. As a result, these processes are assigned this user\nright when they are started.\nAlso, a user can impersonate an access token if any of the following conditions exist:\n• The access token that is being impersonated is for this user.\n• The user, in this logon session, logged on to the network with explicit credentials\nto create the access token.\n• The requested level is less than Impersonate, such as Anonymous or Identify.\nAn attacker with the Impersonate a client after authentication user right could create\na service, trick a client to make them connect to the service, and then impersonate that\nclient to elevate the attacker's level of access to that of the client.\nThe recommended state for this setting is: Administrators, LOCAL SERVICE,\nNETWORK SERVICE, SERVICE.\nNote: This user right is considered a \"sensitive privilege\" for the purposes of auditing.",
    "rationale": "An attacker with the Impersonate a client after authentication user right could create\na service, trick a client to make them connect to the service, and then impersonate that\nclient to elevate the attacker's level of access to that of the client.",
    "impact": "In most cases this configuration will have no impact. If you have installed Web Server\n(IIS), you will need to also assign the user right to IIS_IUSRS.\nPage 115",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nAdministrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Impersonate a client after authentication",
    "default_value": "Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/impersonate-a-client-after-authentication\n2. GRID: MS-00000036\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 116",
    "page_number": 116
  },
  {
    "cis_id": "2.2.25",
    "title": "Ensure 'Increase scheduling priority' is set to\n'Administrators, Window Manager\\Window Manager Group'",
    "profile": "L1",
    "description": "This policy setting determines whether users can increase the base priority class of a\nprocess. (It is not a privileged operation to increase relative priority within a priority\nclass.) This user right is not required by administrative tools that are supplied with the\noperating system but might be required by software development tools.\nThe recommended state for this setting is: Administrators, Window\nManager\\Window Manager Group.",
    "rationale": "A user who is assigned this user right could increase the scheduling priority of a\nprocess to Real-Time, which would leave little processing time for all other processes\nand could lead to a DoS condition.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nAdministrators, Window Manager\\Window Manager Group:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Increase scheduling priority",
    "default_value": "On Windows 10 R1607 or older: Administrators.\nOn Windows 10 R1703 or newer: Administrators, Window Manager\\Window Manager\nGroup.\nPage 117\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/increase-scheduling-priority\n2. GRID: MS-00000037\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 118",
    "page_number": 118
  },
  {
    "cis_id": "2.2.26",
    "title": "Ensure 'Load and unload device drivers' is set to\n'Administrators'",
    "profile": "L1",
    "description": "This policy setting allows users to dynamically load a new device driver on a system. An\nattacker could potentially use this capability to install malicious code that appears to be\na device driver. This user right is required for users to add local printers or printer\ndrivers in Windows Vista.\nThe recommended state for this setting is: Administrators.\nNote: This user right is considered a \"sensitive privilege\" for the purposes of auditing.",
    "rationale": "Device drivers run as highly privileged code. A user who has the Load and unload\ndevice drivers user right could unintentionally install malicious code that masquerades\nas a device driver. Administrators should exercise greater care and install only drivers\nwith verified digital signatures.",
    "impact": "If you remove the Load and unload device drivers user right from the Print\nOperators group or other accounts you could limit the abilities of users who are\nassigned to specific administrative roles in your environment. You should ensure that\ndelegated tasks will not be negatively affected.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nAdministrators:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Load and unload device drivers",
    "default_value": "Administrators.\nPage 119\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/load-and-unload-device-drivers\n2. GRID: MS-00000038\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 120",
    "page_number": 120
  },
  {
    "cis_id": "2.2.27",
    "title": "Ensure 'Lock pages in memory' is set to 'No One'",
    "profile": "L1",
    "description": "This policy setting allows a process to keep data in physical memory, which prevents\nthe system from paging the data to virtual memory on disk. If this user right is assigned,\nsignificant degradation of system performance can occur.\nThe recommended state for this setting is: No One.",
    "rationale": "Users with the Lock pages in memory user right could assign physical memory to\nseveral processes, which could leave little or no RAM for other processes and result in\na DoS condition.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to No\nOne:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Lock pages in memory",
    "default_value": "No one.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/lock-pages-in-memory\n2. GRID: MS-00000039\nPage 121\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 122",
    "page_number": 122
  },
  {
    "cis_id": "2.2.28",
    "title": "Ensure 'Log on as a batch job' is set to\n'Administrators'",
    "profile": "L2",
    "description": "This policy setting allows accounts to log on using the task scheduler service. Because\nthe task scheduler is often used for administrative purposes, it may be needed in\nenterprise environments. However, its use should be restricted in high security\nenvironments to prevent misuse of system resources or to prevent attackers from using\nthe right to launch malicious code after gaining user level access to a computer.\nThe recommended state for this setting is: Administrators.",
    "rationale": "The Log on as a batch job user right presents a low-risk vulnerability. For most\norganizations, the default settings are sufficient.",
    "impact": "If you configure the Log on as a batch job setting through domain-based Group\nPolicies, the computer will not be able to assign the user right to accounts that are used\nfor scheduled jobs in the Task Scheduler. If you install optional components such as\nASP.NET or IIS, you might need to assign this user right to additional accounts that are\nrequired by those components. For example, IIS requires assignment of this user right\nto the IIS_WPG group and the IUSR_(ComputerName), ASPNET, and\nIWAM_(ComputerName) accounts. If this user right is not assigned to this group and\nthese accounts, IIS will be unable to run some COM objects that are necessary for\nproper functionality.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nAdministrators:\nComputer Configuration\\Windows Settings\\Security Settings\\Local Policies\\User\nRights Assignment\\Log on as a batch job",
    "default_value": "Administrators, Backup Operators, Performance Log Users.\nPage 123\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/log-on-as-a-batch-job\n2. GRID: MS-00000040\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 124",
    "page_number": 124
  },
  {
    "cis_id": "2.2.29",
    "title": "Ensure 'Log on as a service' is configured",
    "profile": "L2",
    "description": "This policy setting allows accounts to launch network services or to register a process\nas a service running on the system. This user right should be restricted on any\ncomputer in a high security environment, but because many applications may require\nthis privilege, it should be carefully evaluated and tested before configuring it in an\nenterprise environment. On Windows Vista-based (or newer) computers, no users or\ngroups have this privilege by default.\nThe recommended state for this setting is: No One or (when the Hyper-V feature is\ninstalled) NT VIRTUAL MACHINE\\Virtual Machines or (when using Windows\nDefender Application Guard, such as in the Next Generation Windows Security\nprofile) WDAGUtilityAccount.\nNote: The Hyper-V feature was first introduced on Windows workstations with the 64-bit\nversion of Windows 8.0, so the NT VIRTUAL MACHINE\\Virtual Machines option does\nnot apply to Windows 7 (or older) versions of Windows. Older OSes should only be\nconfigured for No One.\nNote #2: The Windows Defender Application Guard feature was first introduced on\nWindows workstations with the 64-bit version of Windows 10, so the\nWDAGUtilityAccount option does not apply to 32-bit versions of Windows.",
    "rationale": "Log on as a service is a powerful user right because it allows accounts to launch\nnetwork services or services that run continuously on a computer, even when no one is\nlogged on to the console. The risk is reduced by the fact that only users with\nadministrative privileges can install and configure services. An attacker who has already\nattained that level of access could configure the service to run with the Local System\naccount.",
    "impact": "If you have installed optional components such as ASP.NET or IIS, you may need to\nassign the Log on as a service user right to additional accounts that are required by\nthose components. IIS requires that this user right be explicitly granted to the ASPNET\nuser account. On Windows Workstations with the Hyper-V feature installed, this user\nright should also be granted to the special group NT VIRTUAL MACHINE\\Virtual\nMachines.\nPage 125",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to No One\nor (when the Hyper-V feature is installed) NT VIRTUAL MACHINE\\Virtual Machines or\n(when using Windows Defender Application Guard, such as in the Next Generation\nWindows Security profile) WDAGUtilityAccount:\nComputer Configuration\\Windows Settings\\Security Settings\\Local Policies\\User\nRights Assignment\\Log on as a service",
    "default_value": "NT SERVICE\\ALL SERVICES\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/log-on-as-a-service\n2. https://learn.microsoft.com/en-us/windows/security/threat-protection/microsoft-\ndefender-application-guard/faq-md-app-guard#what-is-the-wdagutilityaccount-\nlocal-account-\n3. GRID: MS-00000041\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 126",
    "page_number": 126
  },
  {
    "cis_id": "2.2.30",
    "title": "Ensure 'Manage auditing and security log' is set to\n'Administrators'",
    "profile": "L1",
    "description": "This policy setting determines which users can change the auditing options for files and\ndirectories and clear the Security log.\nThe recommended state for this setting is: Administrators.\nNote: This user right is considered a \"sensitive privilege\" for the purposes of auditing.",
    "rationale": "The ability to manage the Security event log is a powerful user right and it should be\nclosely guarded. Anyone with this user right can clear the Security log to erase\nimportant evidence of unauthorized activity.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nAdministrators:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\User Rights Assignment\\Manage auditing and security log",
    "default_value": "Administrators.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/manage-auditing-and-security-log\n2. GRID: MS-00000042\nPage 127\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n6.8 Define and Maintain Role-Based Access Control\nDefine and maintain role-based access control, through determining and\nv8 documenting the access rights necessary for each role within the enterprise to ●\nsuccessfully carry out its assigned duties. Perform access control reviews of\nenterprise assets to validate that all privileges are authorized, on a recurring\nschedule at a minimum annually, or more frequently.\nPage 128",
    "page_number": 128
  }
]