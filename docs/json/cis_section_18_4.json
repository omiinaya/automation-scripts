[
  {
    "cis_id": "18.6.7.5",
    "title": "Ensure 'Enable remote mailslots' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy settings controls whether the SMB server will use remote mailslots over the\ncomputer browser service. The remote mailslots protocol is an old, simple, unreliable,\nand insecure inter-process communication method.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Remote mailslots is a legacy protocol that uses SMBv1 to function. This protocol is\nlinked to known vulnerabilities, such as denial of service, buffer overflow, and remote\ncode execution attacks.",
    "impact": "If the remote mailslots feature was in operation, it will no longer function.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Bowser:EnableMailslots",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Enable remote mailslots\nNote: A reboot is required after the setting is applied.\nNote #2: This Group Policy path may not exist by default. It is provided by the Group\nPolicy template LanmanServer.admx/adml that is included with the Microsoft Windows\n11 Release 24H2 Administrative Templates (or newer).",
    "default_value": "Enabled. (The computer browser may still be working with remote mailslots enabled.)\nPage 543\nReferences:\n1. https://techcommunity.microsoft.com/blog/filecab/the-beginning-of-the-end-of-\nremote-mailslots-as-part-of-windows-insider/3762048\n2. GRID: MS-00000580\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 544",
    "page_number": 544
  },
  {
    "cis_id": "18.6.7.6",
    "title": "Ensure 'Mandate the minimum version of SMB' is\nset to 'Enabled: 3.1.1'",
    "profile": "L1",
    "description": "This policy settings controls the minimum version of Server Message Block (SMB)\nprotocol that can be used on the system.\nThe recommended state for this setting is: Enabled: 3.1.1.\nNote: This group policy setting does not prevent the use of SMBv1 if it is installed and\nenabled on the system. If the following recommendations are configured as prescribed\nin this benchmark, SMBv1 will be disabled on the system: Configure SMB v1 client\ndriver and Configure SMB v1 server.",
    "rationale": "The newer, more modern version of SMB (v3) is supported and available on all currently\nsupported Microsoft Windows OSes. SMBv1 is no longer enabled by default due to its\nsecurity risks, and although SMBv2 is more robust than v1, it does not support\nencryption like its successor.",
    "impact": "If older legacy (unsupported) Windows OSes that do not support SMB v3.1.1 are\npresent in the environment, this setting may affect backward compatibility with them.\nFor example, Windows 8.1 and Windows Server 2012 R2 and older. This setting may\nalso prevent third-party clients that do not support SMB v3.1.1 from connecting.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 785.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:MinSmb2Dialect\nPage 545",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: 3.1.1:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Mandate the minimum version of SMB\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (SMB v2.0 or higher are enabled by default.)\nReferences:\n1. GRID: MS-00000581\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 546",
    "page_number": 546
  },
  {
    "cis_id": "18.6.7.7",
    "title": "Ensure 'Set authentication rate limiter delay\n(milliseconds)' is set to 'Enabled: 2000' or more",
    "profile": "L1",
    "description": "This policy settings configures the SMB server invalid authentication delay value in\nmilliseconds.\nThe recommended state for this setting is: Enabled: 2000 or more.",
    "rationale": "Authentication rate limiter considerably reduces the risk of brute force attacks by\nimplementing a 2-second delay (default) between each failed NTLM or PKU2U-based\nauthentication attempt.\nAccording to Microsoft, if an attacker sends 300 brute force attempts per second from a\nclient for 5 minutes which equals 90,000 passwords, the same number of attempts\nwould now take 50 hours or more.",
    "impact": "None - 2,000 milliseconds (2 seconds) is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 2000 or more.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanServer:InvalidAuthenticationDe\nlayTimeInMs",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: 2000 or more:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nServer\\Set authentication rate limiter delay (milliseconds)\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanServer.admx/adml that is included with the Microsoft Windows 11\nRelease 24H2 Administrative Templates (or newer).",
    "default_value": "Enabled. (2 seconds)\nPage 547\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. https://techcommunity.microsoft.com/blog/filecab/smb-authentication-rate-limiter-\nnow-on-by-default-in-windows-insider/3634244\n3. GRID: MS-00000582\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 548",
    "page_number": 548
  },
  {
    "cis_id": "18.6.8.1",
    "title": "Ensure 'Audit insecure guest logon' is set to\n'Enabled'",
    "profile": "L1",
    "description": "This policy determines whether the Server Message Block (SMB) client will log events\nwhen the client is logged on as guest account.\nEnabling this will create event log entries in Applications and Service\nLogs\\Microsoft\\Windows\\SMBClient\\Security, with Event IDs 3023, 31017, 31018,\nand 31022.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Insecure guest logons can be used by file servers to allow unauthenticated access to\nshared folders.",
    "impact": "All insecure guest logons will be logged as an event.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation:AuditInsecureGuest\nLogon",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nWorkstation\\Audit insecure guest logon\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanWorkstation.admx/adml that is included with the Microsoft Windows\n11 Release 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (The SMB client will not log the event.)\nPage 550\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. GRID: MS-00000578\n3. https://learn.microsoft.com/en-us/windows-server/storage/file-server/enable-\ninsecure-guest-logons-smb2-and-smb3?tabs=group-policy#audit-insecure-guest-\nlogons\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 551",
    "page_number": 551
  },
  {
    "cis_id": "18.6.8.2",
    "title": "Ensure 'Audit server does not support encryption' is\nset to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the Server Message Block (SMB) client will log\nevents when the SMB server doesn't support encryption.\nEnabling this will create event log entries in Applications and Services\nLogs\\Microsoft\\Windows\\SMBServer\\Audit, with Event ID 3021.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Organizations should be aware of all unencrypted SMB traffic in their environment.\nOlder SMB protocols that do not use encryption can make an environment susceptible\nto many types of attacks, including SMB interception attacks.",
    "impact": "All SMB traffic that is unencrypted will be logged as an event.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation:AuditServerDoesNot\nSupportEncryption",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nWorkstation\\Audit server does not support encryption\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanWorkstation.admx/adml that is included with the Microsoft Windows\n11 Release 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (The SMB client will not log the event.)\nPage 552\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\nsigning-overview#smb-signing-and-encryption-auditing\n3. GRID: MS-00000609\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 553",
    "page_number": 553
  },
  {
    "cis_id": "18.6.8.3",
    "title": "Ensure 'Audit server does not support signing' is set\nto 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the Server Message Block (SMB) client will log\nevents when the SMB server doesn't support signing.\nEnabling this will create event log entries in Applications and Services\nLogs\\Microsoft\\Windows\\SMBServer\\Audit, with Event ID 3022.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Organizations should be aware of all unsigned SMB traffic in their environment. Older\nSMB protocols that do not use signing can make an environment susceptible to many\ntypes of attacks, including SMB interception attacks.",
    "impact": "All SMB traffic that is unsigned will be logged as an event.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation:AuditServerDoesNot\nSupportSigning",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nWorkstation\\Audit server does not support signing\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanWorkstation.admx/adml that is included with the Microsoft Windows\n11 Release 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (The SMB client will not log the event.)\nPage 554\nReferences:\n1. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\ninterception-defense?tabs=group-policy\n2. https://learn.microsoft.com/en-us/windows-server/storage/file-server/smb-\nsigning-overview#smb-signing-and-encryption-auditing\n3. GRID: MS-00000610\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 555",
    "page_number": 555
  },
  {
    "cis_id": "18.6.8.4",
    "title": "Ensure 'Enable insecure guest logons' is set to\n'Disabled'",
    "profile": "L1",
    "description": "This policy setting determines if the SMB client will allow insecure guest logons to an\nSMB server.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Insecure guest logons are used by file servers to allow unauthenticated access to\nshared folders.",
    "impact": "The SMB client will reject insecure guest logons. This was not originally the default\nbehavior in older versions of Windows, but Microsoft changed the default behavior\nstarting with Windows 10 R1709: Guest access in SMB2 disabled by default in Windows\n10 and Windows Server 2016",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation:AllowInsecureGuest\nAuth",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nWorkstation\\Enable insecure guest logons\nNote: This Group Policy path is provided by the Group Policy template\nLanmanWorkstation.admx/adml that is included with the Microsoft Windows 10\nRelease 1511 Administrative Templates (or newer).\nPage 556",
    "default_value": "Windows 10 R1703 or older: Enabled. (The SMB client will allow insecure guest\nlogons.)\nWindows 10 R1709 or newer: Disabled. (The SMB client will reject insecure guest\nlogons.)\nReferences:\n1. https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/guest-\naccess-in-smb2-is-disabled-by-default\n2. GRID: MS-00000266\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n9.2 Ensure Only Approved Ports, Protocols and\nServices Are Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a\nsystem with validated business needs, are running on each system.\nPage 557",
    "page_number": 557
  },
  {
    "cis_id": "18.6.8.5",
    "title": "Ensure 'Enable remote mailslots' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy settings controls whether the SMB client will use remote mailslots over\nMultiple UNC Provider (MUP). The remote mailslots protocol is an old, simple,\nunreliable, and insecure inter-process communication method.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Remote mailslots is a legacy protocol that uses SMBv1 to function. This protocol is\nlinked to known vulnerabilities, such as denial of service, buffer overflow, and remote\ncode execution attacks.",
    "impact": "If the remote mailslots feature was in operation, it will no longer function.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkProvider:EnableMailslots",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nWorkstation\\Enable remote mailslots\nNote: A reboot is required after the setting is applied.\nNote #2: This Group Policy path may not exist by default. It is provided by the Group\nPolicy template LanmanWorkstation.admx/adml that is included with the Microsoft\nWindows 11 Release 24H2 Administrative Templates (or newer).",
    "default_value": "Enabled. (Remote mailslots may be allowed through MUP.)\nPage 558\nReferences:\n1. https://techcommunity.microsoft.com/blog/filecab/the-beginning-of-the-end-of-\nremote-mailslots-as-part-of-windows-insider/3762048\n2. GRID: MS-00000611\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 559",
    "page_number": 559
  },
  {
    "cis_id": "18.6.8.6",
    "title": "Ensure 'Mandate the minimum version of SMB' is\nset to 'Enabled: 3.1.1'",
    "profile": "L1",
    "description": "This policy settings controls the minimum version of Server Message Block (SMB)\nprotocol that can be used on the system.\nThe recommended state for this setting is: Enabled: 3.1.1.\nNote: This group policy setting does not prevent the use of SMBv1 if it is installed and\nenabled on the system. If the following recommendations are configured as prescribed\nin this benchmark, SMBv1 will be disabled on the system: Configure SMB v1 client\ndriver and Configure SMB v1 server.",
    "rationale": "The newer, more modern version of SMB (v3) is supported and available on all currently\nsupported Microsoft Windows OSes. SMBv1 is no longer enabled by default due to its\nsecurity risks, and although SMBv2 is more robust than v1, it does not support\nencryption like its successor.",
    "impact": "If older legacy (unsupported) Windows OSes that do not support SMB v3.1.1 are\npresent in the environment, this setting may affect backward compatibility with them.\nFor example, Windows 8.1 and Windows Server 2012 R2 and older. This setting may\nalso affect connecting to third-party devices and appliances that do not support SMB\nv3.1.1.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 785.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation:MinSmb2Dialect\nPage 560",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: 3.1.1:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nWorkstation\\Mandate the minimum version of SMB\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanWorkstation.admx/adml that is included with the Microsoft Windows\n11 Release 24H2 Administrative Templates (or newer).",
    "default_value": "Disabled. (SMB v2.0 or higher are enabled by default.)\nReferences:\n1. GRID: MS-00000612\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 561",
    "page_number": 561
  },
  {
    "cis_id": "18.6.8.7",
    "title": "Ensure 'Require Encryption' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls whether the SMB client will require encryption.\nThe recommended state for this setting is: Enabled.\nWarning: The SMB server must support and have SMB encryption enabled (requires\nSMB v3.0 or later).",
    "rationale": "The newer, more modern version of SMB (v3) is supported and available on all currently\nsupported Microsoft Windows OSes. SMBv1 is no longer enabled by default due to its\nsecurity risks, and although SMBv2 is more robust than v1, it does not support\nencryption like its successor.",
    "impact": "If older legacy (unsupported) Windows OSes that do not support encryption are present\nin the environment, this setting may affect backward compatibility with them. For\nexample, Windows 7 and Windows Server 2008 R2 and older. This setting may also\naffect connecting to third-party devices and appliances that do not support SMB v3.0.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation:RequireEncryption",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Network\\Lanman\nWorkstation\\Require Encryption\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate LanmanWorkstation.admx/adml that is included with the Microsoft Windows\n11 Release 24H2 Administrative Templates (or newer).\nPage 562",
    "default_value": "Disabled. (The SMB client will not require encryption. However, SMB encryption may\nstill be required by the server.)\nReferences:\n1. GRID: MS-00000613\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\n14.4 Encrypt All Sensitive Information in Transit\nv7 ● ●\nEncrypt all sensitive information in transit.\nPage 563",
    "page_number": 563
  }
]