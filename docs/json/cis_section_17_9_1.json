[
  {
    "cis_id": "17.9.1",
    "title": "Ensure 'Audit IPsec Driver' is set to 'Success and\nFailure'",
    "profile": "L1",
    "description": "This subcategory reports on the activities of the Internet Protocol security (IPsec) driver.\nEvents for this subcategory include:\n• 4960: IPsec dropped an inbound packet that failed an integrity check. If this\nproblem persists, it could indicate a network issue or that packets are being\nmodified in transit to this computer. Verify that the packets sent from the remote\ncomputer are the same as those received by this computer. This error might also\nindicate interoperability problems with other IPsec implementations.\n• 4961: IPsec dropped an inbound packet that failed a replay check. If this problem\npersists, it could indicate a replay attack against this computer.\n• 4962: IPsec dropped an inbound packet that failed a replay check. The inbound\npacket had too low a sequence number to ensure it was not a replay.\n• 4963: IPsec dropped an inbound clear text packet that should have been\nsecured. This is usually due to the remote computer changing its IPsec policy\nwithout informing this computer. This could also be a spoofing attack attempt.\n• 4965: IPsec received a packet from a remote computer with an incorrect Security\nParameter Index (SPI). This is usually caused by malfunctioning hardware that is\ncorrupting packets. If these errors persist, verify that the packets sent from the\nremote computer are the same as those received by this computer. This error\nmay also indicate interoperability problems with other IPsec implementations. In\nthat case, if connectivity is not impeded, then these events can be ignored.\n• 5478: IPsec Services has started successfully.\n• 5479: IPsec Services has been shut down successfully. The shutdown of IPsec\nServices can put the computer at greater risk of network attack or expose the\ncomputer to potential security risks.\n• 5480: IPsec Services failed to get the complete list of network interfaces on the\ncomputer. This poses a potential security risk because some of the network\ninterfaces may not get the protection provided by the applied IPsec filters. Use\nthe IP Security Monitor snap-in to diagnose the problem.\n• 5483: IPsec Services failed to initialize RPC server. IPsec Services could not be\nstarted.\n• 5484: IPsec Services has experienced a critical failure and has been shut down.\nThe shutdown of IPsec Services can put the computer at greater risk of network\nattack or expose the computer to potential security risks.\n• 5485: IPsec Services failed to process some IPsec filters on a plug-and-play\nevent for network interfaces. This poses a potential security risk because some\nPage 462\nof the network interfaces may not get the protection provided by the applied\nIPsec filters. Use the IP Security Monitor snap-in to diagnose the problem.\nThe recommended state for this setting is: Success and Failure.",
    "rationale": "Auditing these events may be useful when investigating a security incident.",
    "impact": "If no audit settings are configured, or if audit settings are too lax on the computers in\nyour organization, security incidents might not be detected, or not enough evidence will\nbe available for network forensic analysis after security incidents occur. However, if\naudit settings are too severe, critically important entries in the Security log may be\nobscured by all of the meaningless entries and computer performance and the available\namount of data storage may be seriously affected. Companies that operate in certain\nregulated industries may have legal obligations to log certain events or activities.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.\nOR\nTo audit the system using auditpol.exe, perform the following and confirm it is set as\nprescribed:\nauditpol /get /subcategory:\"{0cce9213-69ae-11d9-bed3-505054503030}\"",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nSuccess and Failure:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced\nAudit Policy Configuration\\Audit Policies\\System\\Audit IPsec Driver",
    "default_value": "No Auditing.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-\nprotection/auditing/audit-ipsec-driver\n2. GRID: MS-00000225\nPage 463\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 464",
    "page_number": 463
  },
  {
    "cis_id": "17.9.2",
    "title": "Ensure 'Audit Other System Events' is set to 'Success\nand Failure'",
    "profile": "L1",
    "description": "This subcategory reports on other system events. Events for this subcategory include:\n• 5024: The Windows Firewall Service has started successfully.\n• 5025: The Windows Firewall Service has been stopped.\n• 5027: The Windows Firewall Service was unable to retrieve the security policy\nfrom the local storage. The service will continue enforcing the current policy.\n• 5028: The Windows Firewall Service was unable to parse the new security\npolicy. The service will continue with currently enforced policy.\n• 5029: The Windows Firewall Service failed to initialize the driver. The service will\ncontinue to enforce the current policy.\n• 5030: The Windows Firewall Service failed to start.\n• 5032: Windows Firewall was unable to notify the user that it blocked an\napplication from accepting incoming connections on the network.\n• 5033: The Windows Firewall Driver has started successfully.\n• 5034: The Windows Firewall Driver has been stopped.\n• 5035: The Windows Firewall Driver failed to start.\n• 5037: The Windows Firewall Driver detected critical runtime error. Terminating.\n• 5058: Key file operation.\n• 5059: Key migration operation.\nThe recommended state for this setting is: Success and Failure.",
    "rationale": "Capturing these audit events may be useful for identifying when the Windows Firewall is\nnot performing as expected.",
    "impact": "If no audit settings are configured, or if audit settings are too lax on the computers in\nyour organization, security incidents might not be detected, or not enough evidence will\nbe available for network forensic analysis after security incidents occur. However, if\naudit settings are too severe, critically important entries in the Security log may be\nobscured by all of the meaningless entries and computer performance and the available\namount of data storage may be seriously affected. Companies that operate in certain\nregulated industries may have legal obligations to log certain events or activities.\nPage 465",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.\nOR\nTo audit the system using auditpol.exe, perform the following and confirm it is set as\nprescribed:\nauditpol /get /subcategory:\"{0cce9214-69ae-11d9-bed3-505054503030}\"",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nSuccess and Failure:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced\nAudit Policy Configuration\\Audit Policies\\System\\Audit Other System Events",
    "default_value": "Success and Failure.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-\nprotection/auditing/audit-other-system-events\n2. GRID: MS-00000226\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 466",
    "page_number": 466
  },
  {
    "cis_id": "17.9.3",
    "title": "Ensure 'Audit Security State Change' is set to include\n'Success'",
    "profile": "L1",
    "description": "This subcategory reports changes in security state of the system, such as when the\nsecurity subsystem starts and stops. Events for this subcategory include:\n• 4608: Windows is starting up.\n• 4609: Windows is shutting down.\n• 4616: The system time was changed.\n• 4621: Administrator recovered system from CrashOnAuditFail. Users who are not\nadministrators will now be allowed to log on. Some audit-able activity might not\nhave been recorded.\nThe recommended state for this setting is to include: Success.",
    "rationale": "Auditing these events may be useful when investigating a security incident.",
    "impact": "If no audit settings are configured, or if audit settings are too lax on the computers in\nyour organization, security incidents might not be detected, or not enough evidence will\nbe available for network forensic analysis after security incidents occur. However, if\naudit settings are too severe, critically important entries in the Security log may be\nobscured by all of the meaningless entries and computer performance and the available\namount of data storage may be seriously affected. Companies that operate in certain\nregulated industries may have legal obligations to log certain events or activities.\nPage 467",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.\nOR\nTo audit the system using auditpol.exe, perform the following and confirm it is set as\nprescribed:\nauditpol /get /subcategory:\"{0cce9210-69ae-11d9-bed3-505054503030}\"",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to include\nSuccess:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced\nAudit Policy Configuration\\Audit Policies\\System\\Audit Security State Change",
    "default_value": "Success.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-\nprotection/auditing/audit-security-state-change\n2. GRID: MS-00000227\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 468",
    "page_number": 468
  },
  {
    "cis_id": "17.9.4",
    "title": "Ensure 'Audit Security System Extension' is set to\ninclude 'Success'",
    "profile": "L1",
    "description": "This subcategory reports the loading of extension code such as authentication\npackages by the security subsystem. Events for this subcategory include:\n• 4610: An authentication package has been loaded by the Local Security\nAuthority.\n• 4611: A trusted logon process has been registered with the Local Security\nAuthority.\n• 4614: A notification package has been loaded by the Security Account Manager.\n• 4622: A security package has been loaded by the Local Security Authority.\n• 4697: A service was installed in the system.\nThe recommended state for this setting is to include: Success.",
    "rationale": "Auditing these events may be useful when investigating a security incident.",
    "impact": "If no audit settings are configured, or if audit settings are too lax on the computers in\nyour organization, security incidents might not be detected, or not enough evidence will\nbe available for network forensic analysis after security incidents occur. However, if\naudit settings are too severe, critically important entries in the Security log may be\nobscured by all of the meaningless entries and computer performance and the available\namount of data storage may be seriously affected. Companies that operate in certain\nregulated industries may have legal obligations to log certain events or activities.\nPage 469",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.\nOR\nTo audit the system using auditpol.exe, perform the following and confirm it is set as\nprescribed:\nauditpol /get /subcategory:\"{0cce9211-69ae-11d9-bed3-505054503030}\"",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to include\nSuccess:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced\nAudit Policy Configuration\\Audit Policies\\System\\Audit Security System\nExtension",
    "default_value": "No Auditing.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-\nprotection/auditing/audit-security-system-extension\n2. GRID: MS-00000228\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 470",
    "page_number": 470
  },
  {
    "cis_id": "17.9.5",
    "title": "Ensure 'Audit System Integrity' is set to 'Success and\nFailure'",
    "profile": "L1",
    "description": "This subcategory reports on violations of integrity of the security subsystem. Events for\nthis subcategory include:\n• 4612: Internal resources allocated for the queuing of audit messages have been\nexhausted, leading to the loss of some audits.\n• 4615: Invalid use of LPC port.\n• 4618: A monitored security event pattern has occurred.\n• 4816: RPC detected an integrity violation while decrypting an incoming message.\n• 5038: Code integrity determined that the image hash of a file is not valid. The file\ncould be corrupt due to unauthorized modification or the invalid hash could\nindicate a potential disk device error.\n• 5056: A cryptographic self test was performed.\n• 5057: A cryptographic primitive operation failed.\n• 5060: Verification operation failed.\n• 5061: Cryptographic operation.\n• 5062: A kernel-mode cryptographic self test was performed.\nThe recommended state for this setting is: Success and Failure.",
    "rationale": "Auditing these events may be useful when investigating a security incident.",
    "impact": "If no audit settings are configured, or if audit settings are too lax on the computers in\nyour organization, security incidents might not be detected, or not enough evidence will\nbe available for network forensic analysis after security incidents occur. However, if\naudit settings are too severe, critically important entries in the Security log may be\nobscured by all of the meaningless entries and computer performance and the available\namount of data storage may be seriously affected. Companies that operate in certain\nregulated industries may have legal obligations to log certain events or activities.\nPage 471",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.\nOR\nTo audit the system using auditpol.exe, perform the following and confirm it is set as\nprescribed:\nauditpol /get /subcategory:\"{0cce9212-69ae-11d9-bed3-505054503030}\"",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nSuccess and Failure:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Advanced\nAudit Policy Configuration\\Audit Policies\\System\\Audit System Integrity",
    "default_value": "Success and Failure.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-\nprotection/auditing/audit-system-integrity\n2. GRID: MS-00000229\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.5 Collect Detailed Audit Logs\nv8 Configure detailed audit logging for enterprise assets containing sensitive data. ● ●\nInclude event source, date, username, timestamp, source addresses, destination\naddresses, and other useful elements that could assist in a forensic investigation.\n6.3 Enable Detailed Logging\nv7 Enable system logging to include detailed information such as an event source, ● ●\ndate, user, timestamp, source addresses, destination addresses, and other useful\nelements.\nPage 472",
    "page_number": 472
  }
]