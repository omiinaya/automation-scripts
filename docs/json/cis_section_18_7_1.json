[
  {
    "cis_id": "18.7.1",
    "title": "Ensure 'Allow Print Spooler to accept client\nconnections' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting controls whether the Print Spooler service will accept client\nconnections.\nThe recommended state for this setting is: Disabled.\nNote: The Print Spooler service must be restarted for changes to this policy to take\neffect.",
    "rationale": "Disabling the ability for the Print Spooler service to accept client connections mitigates\nremote attacks against the PrintNightmare vulnerability (CVE-2021-34527) and other\nremote Print Spooler attacks. However, this recommendation does not mitigate against\nlocal attacks on the Print Spooler service.",
    "impact": "Provided that the Print Spooler service is not disabled, users will continue to be able to\nprint from their workstation. However, the workstation's Print Spooler service will not\naccept client connections or allow users to share printers. Note that all printers that\nwere already shared will continue to be shared.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 2.\nHKLM\\Software\\Policies\\Microsoft\\Windows\nNT\\Printers:RegisterSpoolerRemoteRpcEndPoint",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Allow Print\nSpooler to accept client connections\nNote: This Group Policy path is provided by the Group Policy template\nprinting2.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.\nPage 599",
    "default_value": "Enabled. (The Print Spooler will always accept client connections.)\nReferences:\n1. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527\n2. GRID: MS-00000281\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.1 Establish and Maintain a Secure Configuration Process\nEstablish and maintain a secure configuration process for enterprise assets\nv8 (end-user devices, including portable and mobile, non-computing/IoT devices, and ● ● ●\nservers) and software (operating systems and applications). Review and update\ndocumentation annually, or when significant enterprise changes occur that could\nimpact this Safeguard.\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service function.\nPage 600",
    "page_number": 600
  },
  {
    "cis_id": "18.7.2",
    "title": "Ensure 'Configure Redirection Guard' is set to\n'Enabled: Redirection Guard Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether Redirection Guard is enabled for the print\nspooler. Redirection Guard can prevent file redirections from being used within the print\nspooler.\nThe recommended state for this setting is: Enabled: Redirection Guard Enabled.",
    "rationale": "This setting prevents non-administrators from redirecting files within the print spooler\nprocess.",
    "impact": "None - this is default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers:RedirectionguardPolicy",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Redirection Guard Enabled:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Configure\nRedirection Guard\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Disabled. (Redirection Guard will default to being \"Enabled\".)\nPage 601\nReferences:\n1. https://techcommunity.microsoft.com/t5/microsoft-security-baselines/windows-11-\nversion-22h2-security-baseline/ba-p/3632520\n2. GRID: MS-00000282\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 602",
    "page_number": 602
  },
  {
    "cis_id": "18.7.3",
    "title": "Ensure 'Configure RPC connection settings: Protocol\nto use for outgoing RPC connections' is set to 'Enabled: RPC over\nTCP'",
    "profile": "L1",
    "description": "This policy setting controls which protocol and protocol settings to use for outgoing\nRemote Procedure Call (RPC) connections to a remote print spooler.\nThe recommended state for this setting is: Enabled: RPC over TCP",
    "rationale": "This setting prevents the use of named pipes for RPC connections to the print spooler\nand forces the use of TCP which is a more secure communication method.",
    "impact": "Warning: Many existing print configurations may be using the older named pipes\nprotocol and therefore will cease to function.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\nNT\\Printers\\RPC:RpcUseNamedPipeProtocol",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: RPC over TCP:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Configure\nRPC connection settings: Protocol to use for outgoing RPC connections\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Disabled. (By default, RPC over TCP is used. For RPC over named pipes,\nauthentication is always enabled for domain joined machines but disabled for non-\ndomain joined machines.)\nPage 603\nReferences:\n1. https://learn.microsoft.com/en-us/troubleshoot/windows-client/printing/windows-\n11-rpc-connection-updates-for-print#allow-rpc-over-tcp-communication\n2. GRID: MS-00000283\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 604",
    "page_number": 604
  },
  {
    "cis_id": "18.7.4",
    "title": "Ensure 'Configure RPC connection settings: Use\nauthentication for outgoing RPC connections' is set to 'Enabled:\nDefault'",
    "profile": "L1",
    "description": "This policy setting controls which protocol and protocol settings to use for outgoing\nRemote Procedure Call (RPC) connections to a remote print spooler.\nThe recommended state for this setting is: Enabled: Default",
    "rationale": "This setting can prevent the use of named pipes for RPC connections to the print\nspooler and forces the use of TCP which is a more secure communication method.",
    "impact": "Warning: Many existing print configurations may be using the older named pipes\nprotocol and therefore will cease to function.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\RPC:RpcAuthentication",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Default:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Configure\nRPC connection settings: Use authentication for outgoing RPC connections\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Disabled. (By default, RPC over TCP is used. For RPC over named pipes,\nauthentication is always enabled for domain joined machines but disabled for non-\ndomain joined machines.)\nPage 605\nReferences:\n1. https://learn.microsoft.com/en-us/troubleshoot/windows-client/printing/windows-\n11-rpc-connection-updates-for-print#allow-rpc-over-tcp-communication\n2. GRID: MS-00000284\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 606",
    "page_number": 606
  },
  {
    "cis_id": "18.7.5",
    "title": "Ensure 'Configure RPC listener settings: Protocols to\nallow for incoming RPC connections' is set to 'Enabled: RPC over\nTCP'",
    "profile": "L1",
    "description": "This policy setting controls which protocols incoming Remote Procedure Call (RPC)\nconnections to the print spooler are allowed to use.\nThe recommended state for this setting is: Enabled: RPC over TCP.",
    "rationale": "This setting can prevent the use of named pipes for RPC connections to the print\nspooler and forces the use of TCP which is a more secure communication method.",
    "impact": "Warning: Many existing print configurations may be using the older named pipes\nprotocol and therefore will cease to function.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 5.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\RPC:RpcProtocols",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: RCP over TCP:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Configure\nRPC listener settings: Configure protocol options for incoming RPC\nconnections\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Enabled. (RPC over TCP is enabled and Negotiate is used for the authentication\nprotocol.)\nPage 607\nReferences:\n1. GRID: MS-00000285\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 608",
    "page_number": 608
  },
  {
    "cis_id": "18.7.6",
    "title": "Ensure 'Configure RPC listener settings:\nAuthentication protocol to use for incoming RPC connections:' is\nset to 'Enabled: Negotiate' or higher",
    "profile": "L1",
    "description": "This policy setting controls which protocols incoming Remote Procedure Call (RPC)\nconnections to the print spooler are allowed to use.\nThe recommended state for this setting is: Enabled: Negotiate or higher.",
    "rationale": "This setting can prevent the use of named pipes for RPC connections to the print\nspooler and forces the use of TCP which is a more secure communication method.",
    "impact": "Warning: Many existing print configurations may be using the older named pipes\nprotocol and therefore will cease to function.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0 or 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\RPC:ForceKerberosForRpc",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Negotiate or higher:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Configure\nRPC listener settings: Configure protocol options for incoming RPC\nconnections\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Enabled. (RPC over TCP is enabled and Negotiate is used for the authentication\nprotocol.)\nPage 609\nReferences:\n1. GRID: MS-00000286\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 610",
    "page_number": 610
  },
  {
    "cis_id": "18.7.7",
    "title": "Ensure 'Configure RPC over TCP port' is set to\n'Enabled: 0'",
    "profile": "L1",
    "description": "This policy setting controls which port is used for RPC over TCP for incoming\nconnections to the print spooler and outgoing connections to remote print spoolers.\nThe recommended state for this setting is: Enabled: 0.",
    "rationale": "Using dynamic ports for printing makes it more difficult for an attacker to know which\nport is being used and therefore which port to attack.",
    "impact": "If your current print environment is configured for a specific TCP port, this setting may\nrequire a firewall change (if applicable) for continued printing.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\RPC:RpcTcpPort",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: 0:\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Configure\nRPC over TCP port\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Disabled. (Dynamic TCP ports are used)\nReferences:\n1. GRID: MS-00000287\nPage 611\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 612",
    "page_number": 612
  },
  {
    "cis_id": "18.7.8",
    "title": "Ensure 'Configure RPC packet level privacy setting for\nincoming connections' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls packet level privacy for Remote Procedure Call (RPC)\nincoming connections.\nThe recommended state for this setting is: Enabled.",
    "rationale": "A security bypass vulnerability (CVE-2021-1678 | Windows Print Spooler Spoofing\nVulnerability) exists in the way the Printer RPC binding handles authentication for the\nremote Winspool interface. Enabling the RPC packet level privacy setting for incoming\nconnections enforces the server-side to increase the authentication level to minimize\nthis vulnerability.",
    "impact": "None - this is default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Print:RpcAuthnLevelPrivacyEnabled",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\MS Security\nGuide\\Configure RPC packet level privacy setting for incoming connections\nNote: This Group Policy path does not exist by default. An additional Group Policy\ntemplate (SecGuide.admx/adml) is required - it is available from Microsoft at this link.",
    "default_value": "Enabled. (Packet level privacy is enabled for RPC for incoming connections.)\nPage 613\nReferences:\n1. https://support.microsoft.com/en-us/topic/managing-deployment-of-printer-rpc-\nbinding-changes-for-cve-2021-1678-kb4599464-12a69652-30b9-3d61-d9f7-\n7201623a8b25\n2. https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1678\n3. GRID: MS-00000241\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 614",
    "page_number": 614
  },
  {
    "cis_id": "18.7.9",
    "title": "Ensure 'Configure Windows protected print' is set to\n'Enabled'",
    "profile": "L2",
    "description": "This policy setting controls whether Windows protected print is enabled on the system.\nWindows protected print uses the modern print platform and Windows protected print\nmode. Modern print is designed to work only with Mopria-certified printers. Mopria is a\ncollection of printer manufacturers and software vendors that define standards for IPP\nprinting and eSCL scanning.\nThe recommended state for this setting is: Enabled.\nNote: Windows protected print will not prohibit administrators or users from installing\nthird-party print drivers through an installation package provided by the print device\nmanufacturer.",
    "rationale": "In September of 2023, Microsoft announced an end of servicing plan for legacy third-\nparty printer drivers. In July of 2025, Microsoft will not publish new printer drivers to\nWindows Update, and by July 2027 (except for security-related fixes), third-party printer\ndriver updates will no longer be deployed.\nWindows protected print also hardens the entire print stack against attacks. According\nto Microsoft, Windows protected print can mitigate over half of past reported security\nissues for Windows print.",
    "impact": "Only Mopria-certified print drivers will continue to be deployed via Widows Update.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\nNT\\Printers\\WPP:WindowsProtectedPrintGroupPolicyState\nPage 615",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled.\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Configure\nWindows protected print\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 11 Release 24H2\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (There are no restrictions on the print drivers that can be installed or print\nfunctionality.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows-hardware/drivers/print/windows-\nprotected-print-mode\n2. https://techcommunity.microsoft.com/blog/microsoft-security-blog/a-new-modern-\nand-secure-print-experience-from-windows/4002645\n3. GRID: MS-00000584\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 616",
    "page_number": 616
  },
  {
    "cis_id": "18.7.10",
    "title": "Ensure 'Limits print driver installation to\nAdministrators' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls whether users who aren't Administrators can install print\ndrivers on the system.\nThe recommended state for this setting is: Enabled.\nNote: On August 10, 2021, Microsoft announced a Point and Print Default Behavior\nChange which modifies the default Point and Print driver installation and update\nbehavior to require Administrator privileges. This is documented in KB5005652—\nManage new Point and Print default driver installation behavior (CVE-2021-34481).",
    "rationale": "Restricting the installation of print drives to Administrators can help mitigate the\nPrintNightmare vulnerability (CVE-2021-34527) and other Print Spooler attacks.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\nNT\\Printers\\PointAndPrint:RestrictDriverInstallationToAdministrators",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled.\nComputer Configuration\\Policies\\Administrative Templates\\Printers\\Limits\nprint driver installation to Administrators\nNote: This Group Policy path is provided by the Group Policy template\nPrinting.admx/adml that is included with the Microsoft Windows 10 Release 21H2\nAdministrative Templates (or newer).\nPage 617",
    "default_value": "Enabled. (The system will limit installation of print drivers to Administrators of the\ncomputer.)\nReferences:\n1. https://support.microsoft.com/en-us/topic/kb5005010-restricting-installation-of-\nnew-printer-drivers-after-applying-the-july-6-2021-updates-31b91c02-05bc-4ada-\na7ea-183b129578a7\n2. https://support.microsoft.com/en-gb/topic/kb5005652-manage-new-point-and-\nprint-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-\na23b-6d8e9a302872\n3. GRID: MS-00000288\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 618",
    "page_number": 618
  }
]