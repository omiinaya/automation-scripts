[
  {
    "cis_id": "18.10.92.2.1",
    "title": "Ensure 'Prevent users from modifying settings'\nis set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting prevent users from making changes to the Exploit protection settings\narea in the Windows Security settings.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Only authorized IT staff should be able to make changes to the exploit protection\nsettings in order to ensure the organizations specific configuration is not modified.",
    "impact": "Local users cannot make changes in the Exploit protection settings area.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\App and\nBrowser protection:DisallowExploitProtectionOverride",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Security\\App and browser protection\\Prevent users from\nmodifying settings\nNote: This Group Policy path is provided by the Group Policy template\nWindowsDefenderSecurityCenter.admx/adml that is included with the Microsoft\nWindows 10 Release 1709 Administrative Templates (or newer).",
    "default_value": "Disabled. (Local users are allowed to make changes in the Exploit protection settings\narea.)\nPage 1221\nReferences:\n1. GRID: MS-00000548\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 1222",
    "page_number": 1222
  },
  {
    "cis_id": "18.10.93.1.1",
    "title": "Ensure 'No auto-restart with logged on users for\nscheduled automatic updates installations' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting specifies that Automatic Updates will wait for computers to be\nrestarted by the users who are logged on to them to complete a scheduled installation.\nThe recommended state for this setting is: Disabled.\nNote: This setting applies only when you configure Automatic Updates to perform\nscheduled update installations. If you configure the Configure Automatic Updates\nsetting to Disabled, this setting has no effect.",
    "rationale": "Some security updates require that the computer be restarted to complete an\ninstallation. If the computer cannot restart automatically, then the most recent update\nwill not completely install and no new updates will download to the computer until it is\nrestarted. Without the auto-restart functionality, users who are not security-conscious\nmay choose to indefinitely delay the restart, therefore keeping the computer in a less\nsecure state.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU:NoAutoRebootWithLog\ngedOnUsers\nPage 1224",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Legacy Policies\\No auto-restart with logged on\nusers for scheduled automatic updates installations\nNote: This Group Policy path is provided by the Group Policy template\nWindowsUpdate.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.\nNote #2: In older Microsoft Windows Administrative Templates, this setting was initially\nnamed No auto-restart for scheduled Automatic Updates installations, but it was\nrenamed starting with the Windows 7 & Server 2008 R2 Administrative Templates.",
    "default_value": "Disabled. (Automatic Updates will notify the user that the computer will automatically\nrestart in 5 minutes to complete the installation of security updates.)\nReferences:\n1. GRID: MS-00000549\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 1225",
    "page_number": 1225
  },
  {
    "cis_id": "18.10.93.2.1",
    "title": "Ensure 'Configure Automatic Updates' is set to\n'Enabled'",
    "profile": "L1",
    "description": "This policy setting specifies whether computers in your environment will receive security\nupdates from Windows Update or WSUS. If you configure this policy setting to Enabled,\nthe operating system will recognize when a network connection is available and then\nuse the network connection to search Windows Update or your designated intranet site\nfor updates that apply to them.\nAfter you configure this policy setting to Enabled, select one of the following four options\nin the Configure Automatic Updates Properties dialog box to specify how the service will\nwork:\n• 2 - Notify for download and auto install (Notify before downloading any updates)\n• 3 - Auto download and notify for install (Download the updates automatically and\nnotify when they are ready to be installed.) (Default setting)\n• 4 - Auto download and schedule the install (Automatically download updates and\ninstall them on the schedule specified below.))\n• 5 - Allow local admin to choose setting (Leave decision on above choices up to\nthe local Administrators (Not Recommended))\nThe recommended state for this setting is: Enabled.\nNote: The sub-setting \"Configure automatic updating:\" has 4 possible values – all of\nthem are valid depending on specific organizational needs, however if feasible we\nsuggest using a value of 4 - Auto download and schedule the install. This\nsuggestion is not a scored requirement.\nNote #2: Organizations that utilize a third--party solution for patching may choose to\nexempt themselves from this recommendation, and instead configure it to Disabled so\nthat the native Windows Update mechanism does not interfere with the third--party\npatching process.",
    "rationale": "Although each version of Windows is thoroughly tested before release, it is possible that\nproblems will be discovered after the products are shipped. The Configure Automatic\nUpdates setting can help you ensure that the computers in your environment will always\nhave the most recent critical operating system updates and service packs installed.",
    "impact": "Critical operating system updates and service packs will be installed as necessary.\nPage 1227",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU:NoAutoUpdate",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage end user experience\\Configure Automatic\nUpdates\nNote: This Group Policy path is provided by the Group Policy template\nWindowsUpdate.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.",
    "default_value": "Enabled: 3 - Auto download and notify for install. (Windows finds updates that apply to\nthe computer and downloads them in the background (the user is not notified or\ninterrupted during this process). When the downloads are complete, users will be\nnotified that they are ready to install. After going to Windows Update, users can install\nthem.)\nReferences:\n1. GRID: MS-00000550\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 1228",
    "page_number": 1228
  },
  {
    "cis_id": "18.10.93.2.2",
    "title": "Ensure 'Configure Automatic Updates:\nScheduled install day' is set to '0 - Every day'",
    "profile": "L1",
    "description": "This policy setting specifies when computers in your environment will receive security\nupdates from Windows Update or WSUS.\nThe recommended state for this setting is: 0 - Every day.\nNote: This setting is only applicable if 4 - Auto download and schedule the\ninstall is selected in the recommendation 'Configure Automatic Updates'. It will have\nno impact if any other option is selected.",
    "rationale": "Although each version of Windows is thoroughly tested before release, it is possible that\nproblems will be discovered after the products are shipped. The Configure Automatic\nUpdates setting can help you ensure that the computers in your environment will always\nhave the most recent critical operating system updates and service packs installed.",
    "impact": "If 4 - Auto download and schedule the install is selected in recommendation\n'Configure Automatic Updates', critical operating system updates and service packs will\nautomatically download every day (at 3:00 A.M., by default).",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU:ScheduledInstallDay",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to 0 -\nEvery day:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage end user experience\\Configure Automatic\nUpdates: Scheduled install day\nNote: This Group Policy path is provided by the Group Policy template\nWindowsUpdate.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.\nPage 1229",
    "default_value": "Not Defined. (Since the default value of Configure Automatic Updates is 3 - Auto\ndownload and notify for install, this setting is not applicable by default.)\nReferences:\n1. GRID: MS-00000551\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 1230",
    "page_number": 1230
  },
  {
    "cis_id": "18.10.93.2.3",
    "title": "Ensure 'Enable features introduced via\nservicing that are off by default' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy settings configures whether or not features and enhancements that are\nintroduced through monthly cumulative updates (servicing), are enabled on the system.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Often, new features or enhancements that are enabled by default (before IT\nadministrators are ready to manage them) can negatively impact the user experience or\nintroduce bugs and security risks.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:AllowTemporaryEnterpri\nseFeatureControl",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\\\Windows\nComponents\\Windows Update\\Manage end user experience\\Enable features\nintroduced via servicing that are off by default\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate WindowsUpdate.admx/adml that is included with the Microsoft Windows 11\nRelease 22H2 Administrative Templates v3.0 (or newer).",
    "default_value": "Disabled. (Features included in monthly quality updates (servicing) will remain off until\nthe feature update that includes these features is installed.)\nPage 1231\nReferences:\n1. https://learn.microsoft.com/en-us/windows/deployment/update/waas-wufb-group-\npolicy#i-want-to-enable-features-introduced-via-servicing-that-are-off-by-default\n2. GRID: MS-00000552\nPage 1232",
    "page_number": 1232
  },
  {
    "cis_id": "18.10.93.2.4",
    "title": "Ensure 'Remove access to “Pause updates”\nfeature' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy removes access to \"Pause updates\" feature.\nThe recommended state for this setting is: Enabled.",
    "rationale": "In order to ensure security and system updates are applied, system administrators\nshould control when updates are applied to systems.",
    "impact": "Users will not be able to select the \"Pause updates\" option in Windows Update to\nprevent updates from being installed on a system.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:SetDisablePauseUXAcces\ns",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage end user experience\\Remove access to “Pause\nupdates” feature\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate WindowsUpdate.admx/adml that is included with the Microsoft Windows 10\nRelease 1809 & Server 2019 Administrative Templates (or newer).",
    "default_value": "Disabled. (Users have access to the \"Pause updates\" feature.)\nReferences:\n1. GRID: MS-00000571\nPage 1233\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 1234",
    "page_number": 1234
  },
  {
    "cis_id": "18.10.93.4.1",
    "title": "Ensure 'Manage preview builds' is set to\n'Disabled'",
    "profile": "L1",
    "description": "This policy setting manages which updates that are received prior to the update being\nreleased.\nDev Channel: Ideal for highly technical users. Insiders in the Dev Channel will receive\nbuilds from our active development branch that is earliest in a development cycle.\nThese builds are not matched to a specific Windows 10 release.\nBeta Channel: Ideal for feature explorers who want to see upcoming Windows 10\nfeatures. Your feedback will be especially important here as it will help our engineers\nensure key issues are fixed before a major release.\nRelease Preview Channel (default): Insiders in the Release Preview Channel will\nhave access to the upcoming release of Windows 10 prior to it being released to the\nworld. These builds are supported by Microsoft. The Release Preview Channel is where\nwe recommend companies preview and validate upcoming Windows 10 releases before\nbroad deployment within their organization.\nThe recommended state for this setting is: Disabled.\nNote: Preview Build enrollment requires a telemetry level setting of 2 or higher and your\ndomain registered on insider.windows.com. For additional information on Preview\nBuilds, see: Managing preview builds across your organization - Windows Insider\nProgram | Microsoft Learn.",
    "rationale": "It can be risky for experimental features to be allowed in an enterprise managed\nenvironment because this can introduce bugs and security holes into systems, making it\neasier for an attacker to gain access. It is generally preferred to only use production-\nready builds.",
    "impact": "Preview builds are prevented from installing on the device.\nPage 1236",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:ManagePreviewBuildsPol\nicyValue",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage updates offered from Windows Update\\Manage\npreview builds\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate WindowsUpdate.admx/adml that is included with the Microsoft Windows 10\nRelease 1709 Administrative Templates (or newer).",
    "default_value": "Disabled. (Windows Update will not offer you any pre-release updates and you will\nreceive such content once released to the world. Disabling this policy will cause any\ndevices currently on a pre-release build to opt out and stay on the latest Feature Update\nonce released.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows-insider/business/manage-builds\n2. GRID: MS-00000553\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n2.5 Allowlist Authorized Software\nv8 Use technical controls, such as application allowlisting, to ensure that only ● ●\nauthorized software can execute or be accessed. Reassess bi-annually, or more\nfrequently.\n2.6 Address unapproved software\nv7 ● ● ●\nEnsure that unauthorized software is either removed or the inventory is\nupdated in a timely manner\nPage 1237",
    "page_number": 1237
  },
  {
    "cis_id": "18.10.93.4.2",
    "title": "Ensure 'Select when Preview Builds and\nFeature Updates are received' is set to 'Enabled: 180 or more\ndays'",
    "profile": "L1",
    "description": "This policy setting determines when Preview Build or Feature Updates are received.\nDefer Updates This enables devices to defer taking the next Feature Update available\nto your channel for up to 14 days for all the pre-release channels and up to 365 days for\nthe Semi-Annual Channel. Or, if the device is updating from the Semi-Annual Channel,\na version for the device to move to and/or stay on until the policy is updated or the\ndevice reaches end of service can be specified. Note: If you set both policies, the\nversion specified will take precedence and the deferrals will not be in effect. Please see\nthe Windows Release Information page for OS version information.\nPause Updates To prevent Feature Updates from being received on their scheduled\ntime, you can temporarily pause Feature Updates. The pause will remain in effect for 35\ndays from the specified start date or until the field is cleared (Quality Updates will still be\noffered).\nNote: If the \"Allow Diagnostic Data\" (formerly \"Allow Telemetry\") policy is set to 0, this\npolicy will have no effect.\nNote #2: Starting with Windows 10 R1607, Microsoft introduced a new Windows\nUpdate (WU) client behavior called Dual Scan, with an eye to cloud-based update\nmanagement. In some cases, this Dual Scan feature can interfere with Windows\nUpdates from Windows Server Update Services (WSUS) and/or manual WU updates. If\nyou are using WSUS in your environment, you may need to set the above setting to Not\nConfigured or configure the setting Do not allow update deferral policies to cause\nscans against Windows Update (added in the Windows 10 Release 1709 Administrative\nTemplates) in order to prevent the Dual Scan feature from interfering. More information\non Dual Scan is available at these links:\n• Demystifying “Dual Scan” – WSUS Product Team Blog\n• Improving Dual Scan on 1607 – WSUS Product Team Blog\nNote #3: Prior to Windows 10 R1703, values above 180 days are not recognized by the\nOS. Starting with Windows 10 R1703, the maximum number of days you can defer is\n365 days.\nPage 1238",
    "rationale": "In a production environment, it is preferred to only use software and features that are\npublicly available, after they have gone through rigorous testing in beta.",
    "impact": "Feature Updates will be delayed until they are publicly released to general public by\nMicrosoft.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1 (DeferFeatureUpdates) and 180\n(DeferFeatureUpdatesPeriodInDays).\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:DeferFeatureUpdates\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:DeferFeatureUpdatesPer\niodInDays",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: 180 or more days:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage updates offered from Windows Update\\Select\nwhen Preview Builds and Feature Updates are received\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate WindowsUpdate.admx/adml that is included with the Microsoft Windows 10\nRelease 1607 & Server 2016 Administrative Templates (or newer).\nNote #2: In older Microsoft Windows Administrative Templates, this setting was initially\nnamed Select when Feature Updates are received, but it was renamed to Select when\nPreview Builds and Feature Updates are received starting with the Windows 10 Release\n1709 Administrative Templates.",
    "default_value": "Disabled. (Feature Update cadence will not be enforced by Group Policy.)\nReferences:\n1. GRID: MS-00000554\nPage 1239\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n2.4 Track Software Inventory Information\nv7 The software inventory system should track the name, version, publisher, and ● ●\ninstall date for all software, including operating systems authorized by the\norganization.\nPage 1240",
    "page_number": 1239
  },
  {
    "cis_id": "18.10.93.4.3",
    "title": "Ensure 'Select when Quality Updates are\nreceived' is set to 'Enabled: 0 days'",
    "profile": "L1",
    "description": "This settings controls when Quality Updates are received.\nThe recommended state for this setting is: Enabled: 0 days.\nNote: If the \"Allow Diagnostic Data\" (formerly \"Allow Telemetry\") policy is set to 0, this\npolicy will have no effect.\nNote #2: Starting with Windows 10 R1607, Microsoft introduced a new Windows\nUpdate (WU) client behavior called Dual Scan, with an eye to cloud-based update\nmanagement. In some cases, this Dual Scan feature can interfere with Windows\nUpdates from Windows Server Update Services (WSUS) and/or manual WU updates. If\nyou are using WSUS in your environment, you may need to set the above setting to Not\nConfigured or configure the setting Do not allow update deferral policies to cause\nscans against Windows Update (added in the Windows 10 Release 1709 Administrative\nTemplates) in order to prevent the Dual Scan feature from interfering. More information\non Dual Scan is available at these links:\n• Demystifying “Dual Scan” – WSUS Product Team Blog\n• Improving Dual Scan on 1607 – WSUS Product Team Blog",
    "rationale": "Quality Updates can contain important bug fixes and/or security patches, and should be\ninstalled as soon as possible.",
    "impact": "None - this is the default behavior.\nPage 1241",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1 (DeferQualityUpdates) and 0\n(DeferQualityUpdatesPeriodInDays).\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:DeferQualityUpdates\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:DeferQualityUpdatesPer\niodInDays",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:0 days:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage updates offered from Windows Update\\Select\nwhen Quality Updates are received\nNote: Note: This Group Policy path may not exist by default. It is provided by the Group\nPolicy template WindowsUpdate.admx/adml that is included with the Microsoft\nWindows 10 Release 1607 & Server 2016 Administrative Templates (or newer).",
    "default_value": "Enabled: 0 days. (Install new Quality Updates as soon as they are available.)\nReferences:\n1. GRID: MS-00000555\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 1242",
    "page_number": 1242
  },
  {
    "cis_id": "18.10.93.4.4",
    "title": "Ensure 'Enable optional updates' is set to\n'Disabled'",
    "profile": "L1",
    "description": "This policy setting controls whether devices are able to receive optional updates\n(including Controlled Feature Rollout (CFRs)). These optional updates can include non-\nsecurity updates, feature enhancements, and other improvements.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Often, new features or enhancements that are enabled by default (before IT\nadministrators are ready to manage them) can negatively impact the user experience or\nintroduce bugs and security risks.",
    "impact": "New features will not be available on the system until the feature update that includes\nthese features and enhancements is installed.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate:SetAllowOptionalConten\nt",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Windows Update\\Manage updates offered from Windows Update\\Enable\noptional updates\nNote: This Group Policy path may not exist by default. It is provided by the Group Policy\ntemplate WindowsUpdate.admx/adml that is included with the Microsoft Windows 11\nRelease 23H2 Administrative Templates (or newer).\nPage 1243",
    "default_value": "Disabled. (Optional updates are not installed by default, but users can enable the toggle\n\"Get the latest updates as soon as they´re available\" to automatically receive optional\nupdates and gradual feature rollouts.)\nReferences:\n1. https://techcommunity.microsoft.com/t5/windows-it-pro-blog/enable-and-control-\noptional-updates-for-your-organization/ba-p/3905218\n2. GRID: MS-00000556\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n7.3 Perform Automated Operating System Patch\nManagement\nv8 ● ● ●\nPerform operating system updates on enterprise assets through automated\npatch management on a monthly, or more frequent, basis.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 1244\n19 Administrative Templates (User)\nThis section contains recommendations for user-based settings that are present within\nthe Administrative Templates (ADMX) for domain-joined user configurations. The\nsettings included in this section are intended to harden the system and are applied on a\nper-user basis, reflected to each domain-joined interactive user’s\nHKEY_CURRENT_USER (HKCU) registry hive. Each interactively logged-on user has\nits own HKCU hive, which is a context-sensitive, per-user, symbolic link to a subkey\nunder HKEY_USERS (HKU), where the user’s Security Identifier (SID) is the subkey\nname (Ex: HKU\\S-1-5-21-123123123-123123123-1231231231-12312). User SIDs for\nthis scenario always begin with S-1-5-21-* for active directory domain-joined\naccounts.\nThe group policy engine applies user configuration settings to the HKU\\SID subkeys for\ninteractive logons, including local console logons, remote desktop logons, and RunAs\nlogons. User configuration settings are not applied to the built-in NT AUTHORITY\nservice accounts (System, Network Service, and Local Service), nor to any other\nservice logons. User configuration settings configured through active directory domain\ngroup policy objects (GPO) are not applied to local user accounts.\nWhen validating user configuration settings for compliance, each recommendation\nshould be checked against all currently-logged-on interactive users’ hives:\n• Audit all HKEY_USERS subkeys with key names beginning with S-1-5-21-*\nand do not end with _Classes.\n• Do not audit subkeys named .DEFAULT, S-1-5-18, S-1-5-19, or S-1-5-20.\n• Do not audit any NT SERVICE SIDs (S-1-5-80-).\n• Do not load the hives of users that are not currently logged on (NTUSER.DAT\nfiles) as part of compliance verification.\nA user configuration setting is considered in compliance if the correct configuration is\nfound in all applicable user hives as described above. If there are multiple users logged\non and the setting is correctly configured in some but not all the applicable user hives,\nthe recommendation is not in full compliance.\nIf a system has no actively logged-on users, the recommendations in this section are\nnot considered out of compliance. User accounts (S-1-5-21-*) that only log on as a\nservice (service accounts), will not receive user configuration settings to its HKU\nregistry hive since the group policy engine will not write to this type of account.\nCompliance findings for these accounts should be ignored.\nPage 1245\nWhy CIS recommends not auditing all the HKU subkeys:\n• Group policy applies user configuration settings only to HKU subkey hives\nassociated with interactive logons. It never applies the settings to the NT\nAUTHORITY service account subkeys (S-1-5-18, S-1-5-19, S-1-5-20, or\n.DEFAULT) or the NT SERVICE subkeys (S-1-5-80-*).\no The HKU\\S-1-5-18 is a symbolic link to HKU\\.DEFAULT, so the key\ncontent is identical.\n• The HKU\\SID_Classes subkey represents the subkey of the corresponding\nHKU\\SID\\SOFTWARE\\Classes, to which they are symbolically linked.\nWhy CIS recommends not loading the NTUSER.DAT file(s) to audit the hives of users\nthat are not currently logged on:\n• Unnecessary false positives of old user profiles that were last loaded before the\nnew or updated GPO containing the user configuration settings were applied.\no These accounts would be found out of compliance, with no supportable\nway to bring them into compliance other than the user logging on or\ndeleting the old profiles.\no These account settings being out of compliance should not cause issues if\nthe user never logs on; and if they do, a group policy update should bring\nthem into compliance.\n• Risk of system issues if the user logs on while the scanning tool has the hive\nloaded, and then also when the scanning tool unloads the hive.\n• Significant performance hit.\nUser configuration settings configured through active directory domain GPOs are not\napplied to local user accounts. Since these accounts begin with the SID S-1-5-21-*, a\nfailure may occur with CIS-CAT and other third-party assessment tools. To mitigate this,\nuser recommendations (Section 19 of this benchmark) should be applied to local\naccounts separately. If this is not a concern for the organization, local accounts should\nbe ignored. The above is also true when an account with a S-1-5-21-* SID logs on as\na service.\nPage 1246",
    "page_number": 1244
  }
]