[
  {
    "cis_id": "18.10.29.2",
    "title": "Ensure 'Turn off account-based insights, recent,\nfavorite, and recommended files in File Explorer' is set to\n'Enabled'",
    "profile": "L2",
    "description": "This policy setting configures whether File Explorer can request cloud file metadata and\ndisplay it in the homepage and other views in File Explorer (such as Quick access\nview).\nThe recommended state for this setting is: Enabled.",
    "rationale": "In a high security environment, data should never be sent to any third-party since this\ndata could contain sensitive information.",
    "impact": "Insights and files available based on account activity will not be available in views such\nas Recent, Recommended, Favorites, etc.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer:DisableGraphRecentItems",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Turn off account-based insights, recent, favorite,\nand recommended files in File Explorer\nNote: This Group Policy path is provided by the Group Policy template\nExplorer.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).\nNote #2: In the Windows 11 Release 22H2 v1.0 and v3.0 Administrative Templates, this\nsetting was initially named Turn off files from Office.com in Quick access view. It was\nrenamed to Turn off account-based insights, recent, favorite, and recommended files in\nFile Explorer starting with the Windows 11 Release 23H2 Administrative Templates.\nPage 961",
    "default_value": "Disabled. (File Explorer will request cloud file metadata and display it in the homepage\nand other views in File Explorer.)\nReferences:\n1. GRID: MS-00000454\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\nPage 962",
    "page_number": 962
  },
  {
    "cis_id": "18.10.29.3",
    "title": "Ensure 'Turn off Data Execution Prevention for\nExplorer' is set to 'Disabled'",
    "profile": "L1",
    "description": "Disabling Data Execution Prevention can allow certain legacy plug-in applications to\nfunction without terminating Explorer.\nThe recommended state for this setting is: Disabled.\nNote: Some legacy plug-in applications and other software may not function with Data\nExecution Prevention and will require an exception to be defined for that specific plug-\nin/software.",
    "rationale": "Data Execution Prevention is an important security feature supported by Explorer that\nhelps to limit the impact of certain types of malware.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer:NoDataExecutionPrevention",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Turn off Data Execution Prevention for Explorer\nNote: This Group Policy path is provided by the Group Policy template\nExplorer.admx/adml that is included with the Microsoft Windows 7 & Server 2008 R2\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (Data Execution Prevention will block certain types of malware from exploiting\nExplorer.)\nPage 963\nReferences:\n1. https://learn.microsoft.com/en-us/windows/win32/memory/data-execution-\nprevention\n2. GRID: MS-00000455\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 964",
    "page_number": 964
  },
  {
    "cis_id": "18.10.29.4",
    "title": "Ensure 'Do not apply the Mark of the Web tag to\nfiles copied from insecure sources' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting determines whether files that are sourced from insecure locations are\ntagged with Mark of the Web (MOTW).\nThe recommended state for this setting is: Disabled.",
    "rationale": "MOTW is an important security feature that ensures files from insecure locations are\ntreated with extra caution and are tagged with MOTW. If files are left untagged, users\nand computers could be exposed to security risks.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer:DisableMotWOnInsecurePathCo\npy",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Do not apply the Mark of the Web tag to files copied\nfrom insecure sources\nNote: This Group Policy path is provided by the Group Policy template\nExplorer.admx/adml that is included with the Microsoft Windows 11 Release 24H2\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (Files copied from unsecure sources will be tagged with the appropriate Mark\nof the Web.)\nPage 965\nReferences:\n1. GRID: MS-00000596\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 966",
    "page_number": 966
  },
  {
    "cis_id": "18.10.29.5",
    "title": "Ensure 'Turn off heap termination on corruption' is\nset to 'Disabled'",
    "profile": "L1",
    "description": "Without heap termination on corruption, legacy plug-in applications may continue to\nfunction when a File Explorer session has become corrupt. Ensuring that heap\ntermination on corruption is active will prevent this.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Allowing an application to function after its session has become corrupt increases the\nrisk posture to the system.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer:NoHeapTerminationOnCorrupti\non",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Turn off heap termination on corruption\nNote: This Group Policy path is provided by the Group Policy template\nExplorer.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.",
    "default_value": "Disabled. (Heap termination on corruption is enabled.)\nReferences:\n1. GRID: MS-00000456\nPage 967\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\nPage 968",
    "page_number": 968
  },
  {
    "cis_id": "18.10.29.6",
    "title": "Ensure 'Turn off shell protocol protected mode' is\nset to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting allows you to configure the amount of functionality that the shell\nprotocol can have. When using the full functionality of this protocol, applications can\nopen folders and launch files. The protected mode reduces the functionality of this\nprotocol allowing applications to only open a limited set of folders. Applications are not\nable to open files with this protocol when it is in the protected mode. It is recommended\nto leave this protocol in the protected mode to increase the security of Windows.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Limiting the opening of files and folders to a limited set reduces the attack surface of the\nsystem.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer:PreXPSP2Shel\nlProtocolBehavior",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Turn off shell protocol protected mode\nNote: This Group Policy path is provided by the Group Policy template\nWindowsExplorer.admx/adml that is included with all versions of the Microsoft\nWindows Administrative Templates.\nPage 969",
    "default_value": "Disabled. (The protocol is in the protected mode, allowing applications to only open a\nlimited set of folders.)\nReferences:\n1. GRID: MS-00000457\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 970",
    "page_number": 970
  },
  {
    "cis_id": "18.10.37.1",
    "title": "Ensure 'Turn off location' is set to 'Enabled'",
    "profile": "L2",
    "description": "This policy setting turns off the location feature for the computer.\nThe recommended state for this setting is: Enabled.",
    "rationale": "This setting affects the location feature (e.g. GPS or other location tracking). From a\nsecurity perspective, it’s not a good idea to reveal your location to software in most\ncases, but there are legitimate uses, such as mapping software. However, they should\nnot be used in high security environments.",
    "impact": "The location feature is turned off, and all programs on the computer are prevented from\nusing location information from the location feature.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors:DisableLocation",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Location and Sensors\\Turn off location\nNote: This Group Policy path is provided by the Group Policy template\nSensors.admx/adml that is included with the Microsoft Windows 7 & Server 2008 R2\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (Programs on the computer are permitted to use location information from the\nlocation feature.)\nPage 973\nReferences:\n1. GRID: MS-00000459\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 974",
    "page_number": 974
  },
  {
    "cis_id": "18.10.41.1",
    "title": "Ensure 'Allow Message Service Cloud Sync' is set\nto 'Disabled'",
    "profile": "L2",
    "description": "This policy setting allows backup and restore of cellular text messages to Microsoft's\ncloud services.\nThe recommended state for this setting is: Disabled.",
    "rationale": "In a high security environment, data should never be sent to any third-party since this\ndata could contain sensitive information.",
    "impact": "Cellular text messages will not be backed up to (or restored from) Microsoft's cloud\nservices.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Messaging:AllowMessageSync",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Messaging\\Allow Message Service Cloud Sync\nNote: This Group Policy path is provided by the Group Policy template\nMessaging.admx/adml that is included with the Microsoft Windows 10 Release 1709\nAdministrative Templates (or newer).",
    "default_value": "Enabled. (Cellular text messages can be backed up and restored to Microsoft's cloud\nservices.)\nPage 976\nReferences:\n1. GRID: MS-00000460\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 977",
    "page_number": 977
  },
  {
    "cis_id": "18.10.42.1",
    "title": "Ensure 'Block all consumer Microsoft account\nuser authentication' is set to 'Enabled'",
    "profile": "L1",
    "description": "This setting determines whether applications and services on the device can utilize new\nconsumer Microsoft account authentication via the Windows OnlineID and\nWebAccountManager APIs.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Organizations that want to effectively implement identity management policies and\nmaintain firm control of what accounts are used on their computers will probably want to\nblock Microsoft accounts. Organizations may also need to block Microsoft accounts in\norder to meet the requirements of compliance standards that apply to their information\nsystems.",
    "impact": "All applications and services on the device will be prevented from new authentications\nusing consumer Microsoft accounts via the Windows OnlineID and\nWebAccountManager APIs. Authentications performed directly by the user in web\nbrowsers or in apps that use OAuth will remain unaffected.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\MicrosoftAccount:DisableUserAuth",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft accounts\\Block all consumer Microsoft account user\nauthentication\nNote: This Group Policy path is provided by the Group Policy template\nMSAPolicy.admx/adml that is included with the Microsoft Windows 10 Release 1703\nAdministrative Templates (or newer).\nPage 979",
    "default_value": "Disabled. (Applications and services on the device will be permitted to authenticate\nusing consumer Microsoft accounts via the Windows OnlineID and\nWebAccountManager APIs.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/identity-protection/access-\ncontrol/microsoft-accounts#bkmk-restrictuse\n2. GRID: MS-00000461\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n5.6 Centralize Account Management\nv8 ● ●\nCentralize account management through a directory or identity service.\n16.8 Disable Any Unassociated Accounts\nv7 ● ● ●\nDisable any account that cannot be associated with a business process\nor business owner.\nPage 980",
    "page_number": 980
  },
  {
    "cis_id": "18.10.43.4.1",
    "title": "Ensure 'Enable EDR in block mode' is set to\n'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls whether Microsoft Defender Antivirus Endpoint Detection\nand Response (EDR) is enabled in block mode (passive remediation).\nThe recommended state for this setting is: Enabled.\nNote: EDR in block mode is only available in Microsoft Defender for Endpoint Plan 2.\nNote #2: This setting is available with Microsoft Defender Antivirus platform release\nv4.18.2202.X and newer.",
    "rationale": "When Microsoft Defender Antivirus is not the primary antivirus product and is running in\npassive mode, EDR in block mode provides added protection against malicious\nartifacts.",
    "impact": "If Microsoft Defender Antivirus is running EDR will be enabled in block mode. If the\nsystem does not have Microsoft Defender Antivirus installed and running, then this\nsetting will have no effect.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Features:PassiveRemediation",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft Defender Antivirus\\Features\\Enable EDR in block mode\nNote: This Group Policy path is provided by the Group Policy template\nWindowsDefender.admx/adml that is included with the Microsoft Windows 11 Release\n24H2 Administrative Templates (or newer).\nPage 982",
    "default_value": "Disabled. (EDR will not run in block mode.)\nReferences:\n1. GRID: MS-00000598\n2. https://learn.microsoft.com/en-us/defender-endpoint/edr-in-block-mode\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.1 Deploy and Maintain Anti-Malware Software\nv8 ● ● ●\nDeploy and maintain anti-malware software on all enterprise assets.\n8.1 Utilize Centrally Managed Anti-malware Software\nv7 ● ●\nUtilize centrally managed anti-malware software to continuously monitor and\ndefend each of the organization's workstations and servers.\nPage 983",
    "page_number": 983
  },
  {
    "cis_id": "18.10.43.5.1",
    "title": "Ensure 'Configure local setting override for\nreporting to Microsoft MAPS' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting configures a local override for the configuration to join Microsoft\nActive Protection Service (MAPS), which Microsoft renamed to Windows Defender\nAntivirus Cloud Protection Service and then Microsoft Defender Antivirus Cloud\nProtection Service.\nThe recommended state for this setting is: Disabled.",
    "rationale": "The decision on whether or not to participate in Microsoft MAPS / Microsoft Defender\nAntivirus Cloud Protection Service for malicious software reporting should be made\ncentrally in an enterprise managed environment, so that all computers within it behave\nconsistently in that regard. Configuring this setting to Disabled ensures that the decision\nremains centrally managed.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\nDefender\\Spynet:LocalSettingOverrideSpynetReporting",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft Defender Antivirus\\MAPS\\Configure local setting override\nfor reporting to Microsoft MAPS\nNote: This Group Policy path is provided by the Group Policy template\nWindowsDefender.admx/adml that is included with the Microsoft Windows 8.1 & Server\n2012 R2 Administrative Templates (or newer).\nPage 985",
    "default_value": "Disabled. (Group Policy will take priority over the local preference setting.)\nReferences:\n1. https://learn.microsoft.com/en-us/microsoft-365/security/defender-\nendpoint/enable-cloud-protection-microsoft-defender-antivirus?view=o365-\nworldwide\n2. GRID: MS-00000464\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 986",
    "page_number": 986
  }
]