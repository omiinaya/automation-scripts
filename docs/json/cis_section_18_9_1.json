[
  {
    "cis_id": "18.9.3.1",
    "title": "Ensure 'Include command line in process creation\nevents' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls whether the process creation command line text is logged in\nsecurity audit events when a new process has been created.\nThe recommended state for this setting is: Enabled.\nNote: This feature that this setting controls was not originally supported in workstation\nOSes older than Windows 8.1. However, in February 2015 Microsoft added support for\nthe feature to Windows 7 and Windows 8.0 via an update - KB3004375. Therefore, this\nsetting is also important to set on those older OSes.",
    "rationale": "Capturing process command line information in event logs can be very valuable when\nperforming forensic investigations of attack incidents.",
    "impact": "Process command line information will be included in the event logs, which can contain\nsensitive or private information such as passwords or user data.\nWarning: There are potential risks of capturing credentials and sensitive information\nwhich could be exposed to users who have read-access to event logs. Microsoft\nprovides a feature called \"Protected Event Logging\" to better secure event log data. For\nassistance with protecting event logging, visit: About Logging Windows - PowerShell |\nMicrosoft Docs.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit:ProcessC\nreationIncludeCmdLine_Enabled\nPage 631",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Audit Process\nCreation\\Include command line in process creation events\nNote: This Group Policy path is provided by the Group Policy template\nAuditSettings.admx/adml that is included with the Microsoft Windows 8.1 & Server\n2012 R2 Administrative Templates (or newer).",
    "default_value": "Disabled. (Process command line information will not be included in Audit Process\nCreation events.)\nReferences:\n1. https://learn.microsoft.com/en-\nus/powershell/module/microsoft.powershell.core/about/about_logging_windows?\nview=powershell-7.2#protected-event-logging\n2. GRID: MS-00000294\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n8.8 Collect Command-Line Audit Logs\nv8 ● ●\nCollect command-line audit logs. Example implementations include collecting\naudit logs from PowerShell®, BASH™, and remote administrative terminals.\n16.4 Encrypt or Hash all Authentication Credentials\nv7 ● ●\nEncrypt or hash with a salt all authentication credentials when stored.\nPage 632",
    "page_number": 632
  },
  {
    "cis_id": "18.9.4.1",
    "title": "Ensure 'Encryption Oracle Remediation' is set to\n'Enabled: Force Updated Clients'",
    "profile": "L1",
    "description": "Some versions of the CredSSP protocol that is used by some applications (such as\nRemote Desktop Connection) are vulnerable to an encryption oracle attack against the\nclient. This policy controls compatibility with vulnerable clients and servers and allows\nyou to set the level of protection desired for the encryption oracle vulnerability.\nThe recommended state for this setting is: Enabled: Force Updated Clients.",
    "rationale": "This setting is important to mitigate the CredSSP encryption oracle vulnerability, for\nwhich information was published by Microsoft on 03/13/2018 in CVE-2018-0886 |\nCredSSP Remote Code Execution Vulnerability. All versions of Windows from Windows\nVista onwards are affected by this vulnerability, and will be compatible with this\nrecommendation provided that they have been patched at least through May 2018 (or\nlater).",
    "impact": "Client applications which use CredSSP will not be able to fall back to the insecure\nversions and services using CredSSP will not accept unpatched clients. This setting\nshould not be deployed until all remote hosts support the newest version, which is\nachieved by ensuring that all Microsoft security updates at least through May 2018 are\ninstalled.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\CredSSP\\Parame\nters:AllowEncryptionOracle\nPage 634",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Force Updated Clients:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Credentials\nDelegation\\Encryption Oracle Remediation\nNote: This Group Policy path is provided by the Group Policy template\nCredSsp.admx/adml that is included with the Microsoft Windows 10 Release 1803\nAdministrative Templates (or newer).",
    "default_value": "Without the May 2018 security update: Enabled: Vulnerable (Client applications which\nuse CredSSP will expose the remote servers to attacks by supporting fall back to the\ninsecure versions and services using CredSSP will accept unpatched clients.)\nWith the May 2018 security update: Enabled: Mitigated (Client applications which use\nCredSSP will not be able to fall back to the insecure version but services using\nCredSSP will accept unpatched clients.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/win32/secauthn/credential-security-\nsupport-provider\n2. GRID: MS-00000295\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n3.4 Deploy Automated Operating System Patch\nManagement Tools\nv7 ● ● ●\nDeploy automated software update tools in order to ensure that the operating\nsystems are running the most recent security updates provided by the software\nvendor.\nPage 635",
    "page_number": 635
  },
  {
    "cis_id": "18.9.4.2",
    "title": "Ensure 'Remote host allows delegation of non-\nexportable credentials' is set to 'Enabled'",
    "profile": "L1",
    "description": "Remote host allows delegation of non-exportable credentials. When using credential\ndelegation, devices provide an exportable version of credentials to the remote host. This\nexposes users to the risk of credential theft from attackers on the remote host. The\nRestricted Admin Mode and Windows Defender Remote Credential Guard features are\ntwo options to help protect against this risk.\nThe recommended state for this setting is: Enabled.\nNote: More detailed information on Windows Defender Remote Credential Guard and\nhow it compares to Restricted Admin Mode can be found at this link: Protect Remote\nDesktop credentials with Windows Defender Remote Credential Guard (Windows 10) |\nMicrosoft Docs",
    "rationale": "Restricted Admin Mode was designed to help protect administrator accounts by\nensuring that reusable credentials are not stored in memory on remote devices that\ncould potentially be compromised. Windows Defender Remote Credential Guard helps\nyou protect your credentials over a Remote Desktop connection by redirecting Kerberos\nrequests back to the device that is requesting the connection. Both features should be\nenabled and supported, as they reduce the chance of credential theft.",
    "impact": "The host will support the Restricted Admin Mode and Windows Defender Remote\nCredential Guard features.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation:AllowProtected\nCreds\nPage 636",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Credentials\nDelegation\\Remote host allows delegation of non-exportable credentials\nNote: This Group Policy path is provided by the Group Policy template\nCredSsp.admx/adml that is included with the Microsoft Windows 10 Release 1703\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (Restricted Admin Mode and Windows Defender Remote Credential Guard\nare not supported. Users will always need to pass their credentials to the host.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/identity-protection/remote-\ncredential-guard\n2. GRID: MS-00000296\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n16.5 Encrypt Transmittal of Username and\nAuthentication Credentials\nv7 ● ●\nEnsure that all account usernames and authentication credentials are\ntransmitted across networks using encrypted channels.\nPage 637",
    "page_number": 637
  },
  {
    "cis_id": "18.9.5.1",
    "title": "Ensure 'Turn On Virtualization Based Security' is set\nto 'Enabled'",
    "profile": "L1",
    "description": "This policy setting specifies whether Virtualization Based Security is enabled.\nVirtualization Based Security uses the Windows Hypervisor to provide support for\nsecurity services.\nThe recommended state for this setting is: Enabled.\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.\nNote #3: If the Level 2 recommendation to configure Log on as a service (from Section\n2.2) is implemented, the additional security principal WDAGUtilityAccount must also\nbe granted that User Right Assignment in order for Virtualization Based Security (in\nMicrosoft Defender Application Guard) with the Next Generation Windows Security\n(NGWS) profile to function.",
    "rationale": "Kerberos, NTLM, and Credential manager isolate secrets by using virtualization-based\nsecurity. Previous versions of Windows stored secrets in the Local Security Authority\n(LSA). Prior to Windows 10, the LSA stored secrets used by the operating system in its\nprocess memory. With Windows Defender Credential Guard enabled, the LSA process\nin the operating system talks to a new component called the isolated LSA process that\nstores and protects those secrets. Data stored by the isolated LSA process is protected\nusing virtualization-based security and is not accessible to the rest of the operating\nsystem.\nPage 639",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:EnableVirtualizationBase\ndSecurity",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 RTM\n(Release 1507) Administrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000297\nPage 640\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 641",
    "page_number": 640
  },
  {
    "cis_id": "18.9.5.2",
    "title": "Ensure 'Turn On Virtualization Based Security:\nSelect Platform Security Level' is set to 'Secure Boot' or higher",
    "profile": "L1",
    "description": "This policy setting specifies whether Virtualization Based Security (VBS) is enabled.\nVBS uses the Windows Hypervisor to provide support for security services.\nThe recommended state for this setting is: Secure Boot or Secure Boot and DMA\nProtection.\nNote: VBS requires a 64-bit version of Windows with Secure Boot enabled, which in\nturn requires that Windows was installed with a UEFI BIOS configuration, not a Legacy\nBIOS configuration. In addition, if running Windows on a virtual machine, the hardware-\nassisted CPU virtualization feature (Intel VT-x or AMD-V) must be exposed by the host\nto the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "Secure Boot can help reduce the risk of bootloader attacks and in conjunction with DMA\nprotections to help protect data from being scraped from memory.\nPage 642",
    "impact": "Choosing the Secure Boot option provides the system with as much protection as is\nsupported by the computer’s hardware. A system with input/output memory\nmanagement units (IOMMUs) will have Secure Boot with DMA protection. A system\nwithout IOMMUs will simply have Secure Boot enabled without DMA protection.\nChoosing the Secure Boot with DMA protection option requires the system to have\nIOMMUs in order to enable VBS. Without IOMMU hardware support, VBS will be\ndisabled.\nNote: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1 or 3.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:RequirePlatformSecurityF\neatures",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to Secure\nBoot or Secure Boot and DMA Protection:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Select Platform Security Level\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 RTM\n(Release 1507) Administrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000302\nPage 643\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 644",
    "page_number": 643
  },
  {
    "cis_id": "18.9.5.3",
    "title": "Ensure 'Turn On Virtualization Based Security:\nVirtualization Based Protection of Code Integrity' is set to\n'Enabled with UEFI lock'",
    "profile": "L1",
    "description": "This setting enables virtualization based protection of Kernel Mode Code Integrity.\nWhen this is enabled, kernel mode memory protections are enforced and the Code\nIntegrity validation path is protected by the Virtualization Based Security feature.\nThe recommended state for this setting is: Enabled with UEFI lock.\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "The Enabled with UEFI lock option ensures that Virtualization Based Protection of\nCode Integrity cannot be disabled remotely.\nPage 645",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.\nWarning #2: Once this setting is turned on and active, Virtualization Based Security\ncannot be disabled solely via GPO or any other remote method. After removing the\nsetting from GPO, the features must also be manually disabled locally at the machine\nusing the steps provided at this link:\nManage Windows Defender Credential Guard (Windows 10) | Microsoft Docs",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:HypervisorEnforcedCodeIn\ntegrity",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled with UEFI lock:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Virtualization Based Protection\nof Code Integrity\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 RTM\n(Release 1507) Administrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000303\nPage 646\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 647",
    "page_number": 646
  },
  {
    "cis_id": "18.9.5.4",
    "title": "Ensure 'Turn On Virtualization Based Security:\nRequire UEFI Memory Attributes Table' is set to 'True (checked)'",
    "profile": "L1",
    "description": "This option will only enable Virtualization Based Protection of Code Integrity on devices\nwith UEFI firmware support for the Memory Attributes Table. Devices without the UEFI\nMemory Attributes Table may have firmware that is incompatible with Virtualization\nBased Protection of Code Integrity which in some cases can lead to crashes or data\nloss or incompatibility with certain plug-in cards. If not setting this option the targeted\ndevices should be tested to ensure compatibility.\nThe recommended state for this setting is: True (checked).\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "This setting will help protect this control from being enabled on a system that is not\ncompatible which could lead to a crash or data loss.",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.\nPage 648",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:HVCIMATRequired",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to TRUE:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Require UEFI Memory Attributes\nTable\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 Release 1703\nAdministrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000300\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 649",
    "page_number": 649
  },
  {
    "cis_id": "18.9.5.5",
    "title": "Ensure 'Turn On Virtualization Based Security:\nCredential Guard Configuration' is set to 'Enabled with UEFI lock'",
    "profile": "L1",
    "description": "This setting lets users turn on Credential Guard with virtualization-based security to help\nprotect credentials. The \"Enabled with UEFI lock\" option ensures that Credential Guard\ncannot be disabled remotely. In order to disable the feature, you must set the Group\nPolicy to \"Disabled\" as well as remove the security functionality from each computer,\nwith a physically present user, in order to clear configuration persisted in UEFI.\nThe recommended state for this setting is: Enabled with UEFI lock.\nNote: Virtualization Based Security requires a 64-bit version of Windows with Secure\nBoot enabled, which in turn requires that Windows was installed with a UEFI BIOS\nconfiguration, not a Legacy BIOS configuration. In addition, if running Windows on a\nvirtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V)\nmust be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "The Enabled with UEFI lock option ensures that Credential Guard cannot be\ndisabled remotely.\nPage 650",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.\nWarning #2: Once this setting is turned on and active, Credential Guard cannot be\ndisabled solely via GPO or any other remote method. After removing the setting from\nGPO, the features must also be manually disabled locally at the machine using the\nsteps provided at this link:\nManage Windows Defender Credential Guard (Windows 10) | Microsoft Docs",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:LsaCfgFlags",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled with UEFI lock:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Credential Guard Configuration\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 Release 1511\nAdministrative Templates (or newer).",
    "default_value": "Disabled.\nReferences:\n1. GRID: MS-00000298\nPage 651\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 652",
    "page_number": 651
  },
  {
    "cis_id": "18.9.5.6",
    "title": "Ensure 'Turn On Virtualization Based Security:\nSecure Launch Configuration' is set to 'Enabled'",
    "profile": "L1",
    "description": "Secure Launch protects the Virtualization Based Security environment from exploited\nvulnerabilities in device firmware.\nThe recommended state for this setting is: Enabled.\nNote: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "Secure Launch changes the way Windows boots to use Intel Trusted Execution\nTechnology (TXT) and Runtime BIOS Resilience features to prevent firmware exploits\nfrom being able to impact the security of the Windows Virtualization Based Security\nenvironment.",
    "impact": "Note: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.\nWarning: All drivers on the system must be compatible with this feature or the system\nmay crash. Ensure that this policy setting is only deployed to computers which are\nknown to be compatible.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:ConfigureSystemGuardLaun\nch\nPage 653",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Secure Launch Configuration\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 10 Release 1809\n& Server 2019 Administrative Templates (or newer).",
    "default_value": "Not Configured. (Administrative users can choose whether to enable or disable Secure\nLaunch.)\nReferences:\n1. GRID: MS-00000301\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 654",
    "page_number": 654
  },
  {
    "cis_id": "18.9.5.7",
    "title": "Ensure 'Turn On Virtualization Based Security:\nKernel-mode Hardware-enforced Stack Protection' is set to\n'Enabled: Enabled in enforcement mode'",
    "profile": "L1",
    "description": "This policy setting enables Hardware-enforced Stack Protection for kernel-mode code.\nKernel-mode data stacks are hardened with hardware-based shadow stacks, which\nstore intended return address targets to ensure that program control flow is not\ntampered.\nThe recommended state for this setting is: Enabled: Enabled in enforcement mode.\nNote: Virtualization Based Security (VBS) requires a 64-bit version of Windows with\nSecure Boot enabled, which in turn requires that Windows was installed with a UEFI\nBIOS configuration, not a Legacy BIOS configuration. In addition, if running Windows on\na virtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-\nV) must be exposed by the host to the guest VM.\nMore information on system requirements for this feature can be found at Windows\nDefender Credential Guard Requirements (Windows 10) | Microsoft Docs\nNote #2: This specific security feature of VBS is only compatible with Windows 11\nRelease 22H2 (or newer).\nNote #3: Only Intel CPUs from Tiger Lake and beyond or AMD CPUs Zen3 and beyond\n(both were release in fall 2020) are compatible with this security feature.\nNote #4: Credential Guard and Device Guard are not currently supported when using\nAzure IaaS VMs.",
    "rationale": "This setting stores a copy of the apps shadow stack (intended code execution flow) in\nthe hardware-based (CPU) security feature VBS. This can prevent malware from\nhijacking an apps code by exploiting memory bugs such as stack buffer overflows,\ndangling pointers, or uninitialized variables. This allows VBS to shut down any exploit\nattempts via the modification of the intended code execution flow.\nPage 655",
    "impact": "This setting is dependent upon Virtualization Based Protection of Code Integrity (aka\nHVCI) first being enabled, in addition to CPU hardware support for shadow stacks. If\neither HVCI is not enabled or hardware-based shadow stacks are not supported, this\nsetting will have no effect.\nIf this setting is successfully enabled, shadow stack violations will be fatal.\nNote: This setting was moved from the Next Generation (NG) profile to the Level 1 (L1)\nprofile for the Windows 11 Operating System only. NG profile settings were isolated\nfrom the L1 profile due to potential hardware compatibility issues. The Windows 11\nOperating System is dependent on the same hardware as the NG settings, so hardware\ncompatibility is no longer an issue.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard:ConfigureKernelShadowSta\ncksLaunch",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled: Enabled in enforcement mode\nComputer Configuration\\Policies\\Administrative Templates\\System\\Device\nGuard\\Turn On Virtualization Based Security: Kernel-mode Hardware-enforced\nStack Protection\nNote: This Group Policy path is provided by the Group Policy template\nDeviceGuard.admx/adml that is included with the Microsoft Windows 11 Release 22H2\nAdministrative Templates v1.0 (or newer).",
    "default_value": "Not Configured.\nReferences:\n1. https://techcommunity.microsoft.com/t5/windows-os-platform-blog/understanding-\nhardware-enforced-stack-protection/ba-p/1247815\n2. https://support.microsoft.com/en-us/windows/a-driver-can-t-load-on-this-device-\n8eea34e5-ff4b-16ec-870d-61a4a43b3dd5\n3. GRID: MS-00000299\nPage 656\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n18.9.6 Device Health Attestation Service\nThis section is intentionally blank and exists to ensure the structure of Windows\nbenchmarks is consistent.\nThis Group Policy section is provided by the Group Policy template TPM.admx/adml that\nis included with the Microsoft Windows 10 Release 1709 Administrative Templates (or\nnewer).\n18.9.7 Device Installation\nThis section contains recommendations related to device installation.\nThis Group Policy section is provided by the Group Policy template\nDeviceInstallation.admx/adml that is included with all versions of the Microsoft\nWindows Administrative Templates.\nPage 657",
    "page_number": 656
  }
]