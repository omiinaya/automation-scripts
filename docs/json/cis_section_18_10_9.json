[
  {
    "cis_id": "18.10.29.4",
    "title": "Ensure 'Do not apply the Mark of the Web tag to\nfiles copied from insecure sources' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting determines whether files that are sourced from insecure locations are\ntagged with Mark of the Web (MOTW).\nThe recommended state for this setting is: Disabled.",
    "rationale": "MOTW is an important security feature that ensures files from insecure locations are\ntreated with extra caution and are tagged with MOTW. If files are left untagged, users\nand computers could be exposed to security risks.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer:DisableMotWOnInsecurePathCo\npy",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Do not apply the Mark of the Web tag to files copied\nfrom insecure sources\nNote: This Group Policy path is provided by the Group Policy template\nExplorer.admx/adml that is included with the Microsoft Windows 11 Release 24H2\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (Files copied from unsecure sources will be tagged with the appropriate Mark\nof the Web.)\nPage 965\nReferences:\n1. GRID: MS-00000596\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 966",
    "page_number": 966
  },
  {
    "cis_id": "18.10.29.5",
    "title": "Ensure 'Turn off heap termination on corruption' is\nset to 'Disabled'",
    "profile": "L1",
    "description": "Without heap termination on corruption, legacy plug-in applications may continue to\nfunction when a File Explorer session has become corrupt. Ensuring that heap\ntermination on corruption is active will prevent this.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Allowing an application to function after its session has become corrupt increases the\nrisk posture to the system.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer:NoHeapTerminationOnCorrupti\non",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Turn off heap termination on corruption\nNote: This Group Policy path is provided by the Group Policy template\nExplorer.admx/adml that is included with all versions of the Microsoft Windows\nAdministrative Templates.",
    "default_value": "Disabled. (Heap termination on corruption is enabled.)\nReferences:\n1. GRID: MS-00000456\nPage 967\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\nPage 968",
    "page_number": 968
  },
  {
    "cis_id": "18.10.29.6",
    "title": "Ensure 'Turn off shell protocol protected mode' is\nset to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting allows you to configure the amount of functionality that the shell\nprotocol can have. When using the full functionality of this protocol, applications can\nopen folders and launch files. The protected mode reduces the functionality of this\nprotocol allowing applications to only open a limited set of folders. Applications are not\nable to open files with this protocol when it is in the protected mode. It is recommended\nto leave this protocol in the protected mode to increase the security of Windows.\nThe recommended state for this setting is: Disabled.",
    "rationale": "Limiting the opening of files and folders to a limited set reduces the attack surface of the\nsystem.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer:PreXPSP2Shel\nlProtocolBehavior",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\File Explorer\\Turn off shell protocol protected mode\nNote: This Group Policy path is provided by the Group Policy template\nWindowsExplorer.admx/adml that is included with all versions of the Microsoft\nWindows Administrative Templates.\nPage 969",
    "default_value": "Disabled. (The protocol is in the protected mode, allowing applications to only open a\nlimited set of folders.)\nReferences:\n1. GRID: MS-00000457\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 970",
    "page_number": 970
  },
  {
    "cis_id": "18.10.37.1",
    "title": "Ensure 'Turn off location' is set to 'Enabled'",
    "profile": "L2",
    "description": "This policy setting turns off the location feature for the computer.\nThe recommended state for this setting is: Enabled.",
    "rationale": "This setting affects the location feature (e.g. GPS or other location tracking). From a\nsecurity perspective, it’s not a good idea to reveal your location to software in most\ncases, but there are legitimate uses, such as mapping software. However, they should\nnot be used in high security environments.",
    "impact": "The location feature is turned off, and all programs on the computer are prevented from\nusing location information from the location feature.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors:DisableLocation",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Location and Sensors\\Turn off location\nNote: This Group Policy path is provided by the Group Policy template\nSensors.admx/adml that is included with the Microsoft Windows 7 & Server 2008 R2\nAdministrative Templates (or newer).",
    "default_value": "Disabled. (Programs on the computer are permitted to use location information from the\nlocation feature.)\nPage 973\nReferences:\n1. GRID: MS-00000459\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 974",
    "page_number": 974
  },
  {
    "cis_id": "18.10.41.1",
    "title": "Ensure 'Allow Message Service Cloud Sync' is set\nto 'Disabled'",
    "profile": "L2",
    "description": "This policy setting allows backup and restore of cellular text messages to Microsoft's\ncloud services.\nThe recommended state for this setting is: Disabled.",
    "rationale": "In a high security environment, data should never be sent to any third-party since this\ndata could contain sensitive information.",
    "impact": "Cellular text messages will not be backed up to (or restored from) Microsoft's cloud\nservices.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Messaging:AllowMessageSync",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Messaging\\Allow Message Service Cloud Sync\nNote: This Group Policy path is provided by the Group Policy template\nMessaging.admx/adml that is included with the Microsoft Windows 10 Release 1709\nAdministrative Templates (or newer).",
    "default_value": "Enabled. (Cellular text messages can be backed up and restored to Microsoft's cloud\nservices.)\nPage 976\nReferences:\n1. GRID: MS-00000460\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 977",
    "page_number": 977
  },
  {
    "cis_id": "18.10.42.1",
    "title": "Ensure 'Block all consumer Microsoft account\nuser authentication' is set to 'Enabled'",
    "profile": "L1",
    "description": "This setting determines whether applications and services on the device can utilize new\nconsumer Microsoft account authentication via the Windows OnlineID and\nWebAccountManager APIs.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Organizations that want to effectively implement identity management policies and\nmaintain firm control of what accounts are used on their computers will probably want to\nblock Microsoft accounts. Organizations may also need to block Microsoft accounts in\norder to meet the requirements of compliance standards that apply to their information\nsystems.",
    "impact": "All applications and services on the device will be prevented from new authentications\nusing consumer Microsoft accounts via the Windows OnlineID and\nWebAccountManager APIs. Authentications performed directly by the user in web\nbrowsers or in apps that use OAuth will remain unaffected.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\MicrosoftAccount:DisableUserAuth",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft accounts\\Block all consumer Microsoft account user\nauthentication\nNote: This Group Policy path is provided by the Group Policy template\nMSAPolicy.admx/adml that is included with the Microsoft Windows 10 Release 1703\nAdministrative Templates (or newer).\nPage 979",
    "default_value": "Disabled. (Applications and services on the device will be permitted to authenticate\nusing consumer Microsoft accounts via the Windows OnlineID and\nWebAccountManager APIs.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/identity-protection/access-\ncontrol/microsoft-accounts#bkmk-restrictuse\n2. GRID: MS-00000461\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n5.6 Centralize Account Management\nv8 ● ●\nCentralize account management through a directory or identity service.\n16.8 Disable Any Unassociated Accounts\nv7 ● ● ●\nDisable any account that cannot be associated with a business process\nor business owner.\nPage 980",
    "page_number": 980
  },
  {
    "cis_id": "18.10.43.4.1",
    "title": "Ensure 'Enable EDR in block mode' is set to\n'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls whether Microsoft Defender Antivirus Endpoint Detection\nand Response (EDR) is enabled in block mode (passive remediation).\nThe recommended state for this setting is: Enabled.\nNote: EDR in block mode is only available in Microsoft Defender for Endpoint Plan 2.\nNote #2: This setting is available with Microsoft Defender Antivirus platform release\nv4.18.2202.X and newer.",
    "rationale": "When Microsoft Defender Antivirus is not the primary antivirus product and is running in\npassive mode, EDR in block mode provides added protection against malicious\nartifacts.",
    "impact": "If Microsoft Defender Antivirus is running EDR will be enabled in block mode. If the\nsystem does not have Microsoft Defender Antivirus installed and running, then this\nsetting will have no effect.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Features:PassiveRemediation",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft Defender Antivirus\\Features\\Enable EDR in block mode\nNote: This Group Policy path is provided by the Group Policy template\nWindowsDefender.admx/adml that is included with the Microsoft Windows 11 Release\n24H2 Administrative Templates (or newer).\nPage 982",
    "default_value": "Disabled. (EDR will not run in block mode.)\nReferences:\n1. GRID: MS-00000598\n2. https://learn.microsoft.com/en-us/defender-endpoint/edr-in-block-mode\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.1 Deploy and Maintain Anti-Malware Software\nv8 ● ● ●\nDeploy and maintain anti-malware software on all enterprise assets.\n8.1 Utilize Centrally Managed Anti-malware Software\nv7 ● ●\nUtilize centrally managed anti-malware software to continuously monitor and\ndefend each of the organization's workstations and servers.\nPage 983",
    "page_number": 983
  },
  {
    "cis_id": "18.10.43.5.1",
    "title": "Ensure 'Configure local setting override for\nreporting to Microsoft MAPS' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting configures a local override for the configuration to join Microsoft\nActive Protection Service (MAPS), which Microsoft renamed to Windows Defender\nAntivirus Cloud Protection Service and then Microsoft Defender Antivirus Cloud\nProtection Service.\nThe recommended state for this setting is: Disabled.",
    "rationale": "The decision on whether or not to participate in Microsoft MAPS / Microsoft Defender\nAntivirus Cloud Protection Service for malicious software reporting should be made\ncentrally in an enterprise managed environment, so that all computers within it behave\nconsistently in that regard. Configuring this setting to Disabled ensures that the decision\nremains centrally managed.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\nDefender\\Spynet:LocalSettingOverrideSpynetReporting",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft Defender Antivirus\\MAPS\\Configure local setting override\nfor reporting to Microsoft MAPS\nNote: This Group Policy path is provided by the Group Policy template\nWindowsDefender.admx/adml that is included with the Microsoft Windows 8.1 & Server\n2012 R2 Administrative Templates (or newer).\nPage 985",
    "default_value": "Disabled. (Group Policy will take priority over the local preference setting.)\nReferences:\n1. https://learn.microsoft.com/en-us/microsoft-365/security/defender-\nendpoint/enable-cloud-protection-microsoft-defender-antivirus?view=o365-\nworldwide\n2. GRID: MS-00000464\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 986",
    "page_number": 986
  },
  {
    "cis_id": "18.10.43.5.2",
    "title": "Ensure 'Join Microsoft MAPS' is set to\n'Disabled'",
    "profile": "L2",
    "description": "This policy setting allows you to join Microsoft Active Protection Service (MAPS), which\nMicrosoft renamed to Windows Defender Antivirus Cloud Protection Service and then\nMicrosoft Defender Antivirus Cloud Protection Service. Microsoft MAPS / Microsoft\nDefender Antivirus Cloud Protection Service is the online community that helps you\nchoose how to respond to potential threats. The community also helps stop the spread\nof new malicious software infections. You can choose to send basic or additional\ninformation about detected software. Additional information helps Microsoft create new\ndefinitions and help it to protect your computer.\nPossible options are:\n• (0x0) Disabled (default)\n• (0x1) Basic membership\n• (0x2) Advanced membership\nBasic membership will send basic information to Microsoft about software that has\nbeen detected including where the software came from the actions that you apply or\nthat are applied automatically and whether the actions were successful.\nAdvanced membership in addition to basic information will send more information to\nMicrosoft about malicious software spyware and potentially unwanted software including\nthe location of the software file names how the software operates and how it has\nimpacted your computer.\nThe recommended state for this setting is: Disabled.\nNote: In Windows 10 and above, Basic membership is no longer available, so setting\nthe value to 1 Basic, or 2 Advanced, enrolls the device into Advanced membership. For\nmore information, please visit: Turn on cloud protection in Microsoft Defender Antivirus -\nMicrosoft Defender for Endpoint | Microsoft Learn.\nPage 987",
    "rationale": "The information that would be sent can include things like location of detected items on\nyour computer if harmful software was removed. The information would be automatically\ncollected and sent. In some instances personal information might unintentionally be sent\nto Microsoft. However, Microsoft states that it will not use this information to identify you\nor contact you.\nFor privacy reasons in high security environments, it is best to prevent these data\nsubmissions altogether.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0 or that the key does not exist.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet:SpynetReporting",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft Defender Antivirus\\MAPS\\Join Microsoft MAPS\nNote: This Group Policy path is provided by the Group Policy template\nWindowsDefender.admx/adml that is included with the Microsoft Windows 8.1 & Server\n2012 R2 Administrative Templates (or newer).",
    "default_value": "Disabled. (Microsoft MAPS / Microsoft Defender Antivirus Cloud Protection Service will\nnot be joined.)\nReferences:\n1. https://learn.microsoft.com/en-us/defender-endpoint/enable-cloud-protection-\nmicrosoft-defender-antivirus#methods-to-configure-cloud-protection\n2. GRID: MS-00000465\nPage 988\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.8 Uninstall or Disable Unnecessary Services on\nEnterprise Assets and Software\nv8 ● ●\nUninstall or disable unnecessary services on enterprise assets and software,\nsuch as an unused file sharing service, web application module, or service\nfunction.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 989",
    "page_number": 988
  },
  {
    "cis_id": "18.10.43.6.1.1",
    "title": "Ensure 'Configure Attack Surface Reduction\nrules' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting controls the state for the Attack Surface Reduction (ASR) rules.\nThe recommended state for this setting is: Enabled.",
    "rationale": "Attack surface reduction helps prevent actions and apps that are typically used by\nexploit-seeking malware to infect machines.",
    "impact": "When a rule is triggered, a notification will be displayed from the Action Center.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit\nGuard\\ASR:ExploitGuard_ASR_Rules",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Administrative Templates\\Windows\nComponents\\Microsoft Defender Antivirus\\Microsoft Defender Exploit\nGuard\\Attack Surface Reduction\\Configure Attack Surface Reduction rules\nNote: This Group Policy path is provided by the Group Policy template\nWindowsDefender.admx/adml that is included with the Microsoft Windows 10 Release\n1709 Administrative Templates (or newer).",
    "default_value": "Disabled. (No ASR rules will be configured.)\nPage 991\nReferences:\n1. https://learn.microsoft.com/en-us/microsoft-365/security/defender-\nendpoint/enable-attack-surface-reduction?view=o365-worldwide\n2. https://learn.microsoft.com/en-us/microsoft-365/security/defender-\nendpoint/attack-surface-reduction?view=o365-worldwide\n3. GRID: MS-00000466\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n10.5 Enable Anti-Exploitation Features\nv8 Enable anti-exploitation features on enterprise assets and software, where ● ●\npossible, such as Microsoft® Data Execution Prevention (DEP), Windows®\nDefender Exploit Guard (WDEG), or Apple® System Integrity Protection (SIP) and\nGatekeeper™.\n8.3 Enable Operating System Anti-Exploitation Features/\nDeploy Anti-Exploit Technologies\nv7\nEnable anti-exploitation features such as Data Execution Prevention (DEP) or\n● ●\nAddress Space Layout Randomization (ASLR) that are available in an operating\nsystem or deploy appropriate toolkits that can be configured to apply protection to a\nbroader set of applications and executables.\nPage 992",
    "page_number": 992
  }
]