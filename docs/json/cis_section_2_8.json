[
  {
    "cis_id": "2.3.11.1",
    "title": "Ensure 'Network security: Allow Local System to use\ncomputer identity for NTLM' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether Local System services that use Negotiate when\nreverting to NTLM authentication can use the computer identity. This policy is supported\non at least Windows 7 or Windows Server 2008 R2.\nThe recommended state for this setting is: Enabled.",
    "rationale": "When connecting to computers running versions of Windows earlier than Windows Vista\nor Windows Server 2008 (non-R2), services running as Local System and using\nSPNEGO (Negotiate) that revert to NTLM use the computer identity. In Windows 7, if\nyou are connecting to a computer running Windows Server 2008 or Windows Vista,\nthen a system service uses either the computer identity or a NULL session. When\nconnecting with a NULL session, a system-generated session key is created, which\nprovides no protection but allows applications to sign and encrypt data without errors.\nWhen connecting with the computer identity, both signing and encryption is supported in\norder to provide data protection.",
    "impact": "Services running as Local System that use Negotiate when reverting to NTLM\nauthentication will use the computer identity. This might cause some authentication\nrequests between Windows operating systems to fail and log an error.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa:UseMachineId\nPage 231",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: Allow Local System to use\ncomputer identity for NTLM",
    "default_value": "Disabled. (Services running as Local System that use Negotiate when reverting to\nNTLM authentication will authenticate anonymously.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-allow-local-system-to-use-computer-identity-for-\nntlm\n2. GRID: MS-00000103\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 232",
    "page_number": 232
  },
  {
    "cis_id": "2.3.11.2",
    "title": "Ensure 'Network security: Allow LocalSystem NULL\nsession fallback' is set to 'Disabled'",
    "profile": "L1",
    "description": "This policy setting determines whether NTLM is allowed to fall back to a NULL session\nwhen used with LocalSystem.\nThe recommended state for this setting is: Disabled.",
    "rationale": "NULL sessions are less secure because by definition they are unauthenticated.",
    "impact": "None - this is the default behavior. Any applications that require NULL sessions for\nLocalSystem will not work as designed.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0:AllowNullSessionFallback",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: Allow LocalSystem NULL session\nfallback",
    "default_value": "Disabled. (NTLM will not be permitted to fall back to a NULL session when used with\nLocalSystem.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-allow-localsystem-null-session-fallback\n2. GRID: MS-00000104\nPage 233\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 234",
    "page_number": 234
  },
  {
    "cis_id": "2.3.11.3",
    "title": "Ensure 'Network Security: Allow PKU2U\nauthentication requests to this computer to use online identities' is\nset to 'Disabled'",
    "profile": "L1",
    "description": "This setting determines if online identities are able to authenticate to this computer.\nThe Public Key Cryptography Based User-to-User (PKU2U) protocol introduced in\nWindows 7 and Windows Server 2008 R2 is implemented as a security support provider\n(SSP). The SSP enables peer-to-peer authentication, particularly through the Windows\n7 media and file sharing feature called HomeGroup, which permits sharing between\ncomputers that are not members of a domain.\nWith PKU2U, a new extension was introduced to the Negotiate authentication package,\nSpnego.dll. In previous versions of Windows, Negotiate decided whether to use\nKerberos or NTLM for authentication. The extension SSP for Negotiate, Negoexts.dll,\nwhich is treated as an authentication protocol by Windows, supports Microsoft SSPs\nincluding PKU2U.\nWhen computers are configured to accept authentication requests by using online IDs,\nNegoexts.dll calls the PKU2U SSP on the computer that is used to log on. The\nPKU2U SSP obtains a local certificate and exchanges the policy between the peer\ncomputers. When validated on the peer computer, the certificate within the metadata is\nsent to the logon peer for validation and associates the user's certificate to a security\ntoken and the logon process completes.\nThe recommended state for this setting is: Disabled.\nNote: If a hybrid environment is used, and PKU2U is Disabled, Remote Desktop\nconnections from a hybrid joined system to a hybrid joined system will fail.",
    "rationale": "The PKU2U protocol is a peer-to-peer authentication protocol - authentication should be\nmanaged centrally in most managed networks.",
    "impact": "None - this is the default configuration for domain-joined computers.\nPage 235",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 0.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\pku2u:AllowOnlineID",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nDisabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network Security: Allow PKU2U authentication\nrequests to this computer to use online identities",
    "default_value": "Disabled. (Online identities will not to be allowed to authenticate to a domain-joined\nmachine.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-allow-pku2u-authentication-requests-to-this-\ncomputer-to-use-online-identities\n2. GRID: MS-00000105\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n4.1 Establish and Maintain a Secure Configuration Process\nEstablish and maintain a secure configuration process for enterprise assets\nv8 (end-user devices, including portable and mobile, non-computing/IoT devices, and ● ● ●\nservers) and software (operating systems and applications). Review and update\ndocumentation annually, or when significant enterprise changes occur that could\nimpact this Safeguard.\n9.2 Ensure Only Approved Ports, Protocols and Services\nAre Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 236",
    "page_number": 236
  },
  {
    "cis_id": "2.3.11.4",
    "title": "Ensure 'Network security: Configure encryption\ntypes allowed for Kerberos' is set to 'AES128_HMAC_SHA1,\nAES256_HMAC_SHA1, Future encryption types'",
    "profile": "L1",
    "description": "This policy setting allows you to set the encryption types that Kerberos is allowed to\nuse.\nThe recommended state for this setting is: AES128_HMAC_SHA1, AES256_HMAC_SHA1,\nFuture encryption types.\nNote: Some legacy applications and OSes may still require RC4_HMAC_MD5 - we\nrecommend you test in your environment and verify whether you can safely remove it.",
    "rationale": "The strength of each encryption algorithm varies from one to the next, choosing\nstronger algorithms will reduce the risk of compromise however doing so may cause\nissues when the computer attempts to authenticate with systems that do not support\nthem.",
    "impact": "If not selected, the encryption type will not be allowed. This setting may affect\ncompatibility with client computers or services and applications. Multiple selections are\npermitted.\nNote: Some legacy applications and OSes may still require RC4_HMAC_MD5 - we\nrecommend you test in your environment and verify whether you can safely remove it.\nNote #2: Windows Vista and below allow DES for Kerberos by default, but later OS\nversions do not.\nNote #3: Some prerequisites might need to be met on Domain Controllers to support\nKerberos AES 128 and 256 bit encryption types, as well as enabling support for\nKerberos AES 128 and 256 bit on user accounts (in account options) for this\nrecommendation to work correctly.\nNote #4: If your organization uses Azure Files, please note that Microsoft did not\nintroduce AES 256 Kerberos encryption support for it until AD DS authentication module\nv0.2.2. Please see this link for more information:\nAzure Files on-premises AD DS Authentication support for AES 256 Kerberos\nencryption | Microsoft Docs\nPage 237",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 2147483640.\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Param\neters:SupportedEncryptionTypes",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nAES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: Configure encryption types\nallowed for Kerberos",
    "default_value": "RC4_HMAC_MD5, AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption\ntypes.\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-configure-encryption-types-allowed-for-kerberos\n2. GRID: MS-00000106\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\n14.4 Encrypt All Sensitive Information in Transit\nv7 ● ●\nEncrypt all sensitive information in transit.\n18.5 Use Only Standardized and Extensively Reviewed\nv7 Encryption Algorithms ● ●\nUse only standardized and extensively reviewed encryption algorithms.\nPage 238",
    "page_number": 238
  },
  {
    "cis_id": "2.3.11.5",
    "title": "Ensure 'Network security: Do not store LAN\nManager hash value on next password change' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether the LAN Manager (LM) hash value for the new\npassword is stored when the password is changed. The LM hash is relatively weak and\nprone to attack compared to the cryptographically stronger Microsoft Windows NT hash.\nSince LM hashes are stored on the local computer in the security database, passwords\ncan then be easily compromised if the database is attacked.\nNote: Older operating systems and some third-party applications may fail when this\npolicy setting is enabled. Also, note that the password will need to be changed on all\naccounts after you enable this setting to gain the proper benefit.\nThe recommended state for this setting is: Enabled.",
    "rationale": "The SAM file can be targeted by attackers who seek access to username and password\nhashes. Such attacks use special tools to crack passwords, which can then be used to\nimpersonate users and gain access to resources on your network. These types of\nattacks will not be prevented if you enable this policy setting, but it will be much more\ndifficult for these types of attacks to succeed.",
    "impact": "None - this is the default behavior. Earlier operating systems such as Windows 95,\nWindows 98, and Windows ME as well as some third-party applications will fail.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa:NoLMHash\nPage 239",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: Do not store LAN Manager hash\nvalue on next password change",
    "default_value": "Enabled. (LAN Manager hash values are not stored when passwords are changed.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-do-not-store-lan-manager-hash-value-on-next-\npassword-change\n2. GRID: MS-00000107\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.11 Encrypt Sensitive Data at Rest\nEncrypt sensitive data at rest on servers, applications, and databases containing\nv8 sensitive data. Storage-layer encryption, also known as server-side encryption, ● ●\nmeets the minimum requirement of this Safeguard. Additional encryption methods\nmay include application-layer encryption, also known as client-side encryption,\nwhere access to the data storage device(s) does not permit access to the plain-text\ndata.\n16.4 Encrypt or Hash all Authentication Credentials\nv7 ● ●\nEncrypt or hash with a salt all authentication credentials when stored.\nPage 240",
    "page_number": 240
  },
  {
    "cis_id": "2.3.11.6",
    "title": "Ensure 'Network security: Force logoff when logon\nhours expire' is set to 'Enabled'",
    "profile": "L1",
    "description": "This policy setting determines whether to disconnect users who are connected to the\nlocal computer outside their user account's valid logon hours. This setting affects the\nServer Message Block (SMB) component. If you enable this policy setting you should\nalso enable Microsoft network server: Disconnect clients when logon hours expire (Rule\n2.3.9.4).\nThe recommended state for this setting is: Enabled.",
    "rationale": "If this setting is disabled, a user could remain connected to the computer outside of their\nallotted logon hours.",
    "impact": "None - this is the default behavior.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed.",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nEnabled.\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: Force logoff when logon hours\nexpire",
    "default_value": "Enabled. (When a user's logon time expires, client sessions with the SMB server will be\nforcibly disconnected. The user will be unable to log on to the computer until their next\nscheduled access time commences.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-force-logoff-when-logon-hours-expire\n2. GRID: MS-00000108\nPage 241\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n16.13 Alert on Account Login Behavior Deviation\nv7 ●\nAlert when users deviate from normal login behavior, such as time-of-day,\nworkstation location and duration.\nPage 242",
    "page_number": 242
  },
  {
    "cis_id": "2.3.11.7",
    "title": "Ensure 'Network security: LAN Manager\nauthentication level' is set to 'Send NTLMv2 response only.\nRefuse LM & NTLM'",
    "profile": "L1",
    "description": "LAN Manager (LM) was a family of early Microsoft client/server software (predating\nWindows NT) that allowed users to link personal computers together on a single\nnetwork. LM network capabilities included transparent file and print sharing, user\nsecurity features, and network administration tools. In Active Directory domains, the\nKerberos protocol is the default authentication protocol. However, if the Kerberos\nprotocol is not negotiated for some reason, Active Directory will use LM, NTLM, or\nNTLMv2. LAN Manager authentication includes the LM, NTLM, and NTLM version 2\n(NTLMv2) variants, and is the protocol that is used to authenticate all Windows clients\nwhen they perform the following operations:\n• Join a domain\n• Authenticate between Active Directory forests\n• Authenticate to down-level domains\n• Authenticate to computers that do not run Windows 2000, Windows Server 2003,\nor Windows XP\n• Authenticate to computers that are not in the domain\nThe Network security: LAN Manager authentication level setting determines which\nchallenge/response authentication protocol is used for network logons. This choice\naffects the level of authentication protocol used by clients, the level of session security\nnegotiated, and the level of authentication accepted by servers.\nThe recommended state for this setting is: Send NTLMv2 response only. Refuse LM\n& NTLM.\nPage 243",
    "rationale": "Windows 2000 and Windows XP clients were configured by default to send LM and\nNTLM authentication responses (Windows 95-based and Windows 98-based clients\nonly send LM). The default settings in OSes predating Windows Vista / Windows Server\n2008 (non-R2) allowed all clients to authenticate with servers and use their resources.\nHowever, this meant that LM responses - the weakest form of authentication response -\nwere sent over the network, and it was potentially possible for attackers to sniff that\ntraffic to more easily reproduce the user's password.\nThe Windows 95, Windows 98, and Windows NT operating systems cannot use the\nKerberos version 5 protocol for authentication. For this reason, in a Windows Server\n2003 domain, these computers authenticate by default with both the LM and NTLM\nprotocols for network authentication. You can enforce a more secure authentication\nprotocol for Windows 95, Windows 98, and Windows NT by using NTLMv2. For the\nlogon process, NTLMv2 uses a secure channel to protect the authentication process.\nEven if you use NTLMv2 for older clients and servers, Windows-based clients and\nservers that are members of the domain will use the Kerberos authentication protocol to\nauthenticate with Windows Server 2003 or newer Domain Controllers. For these\nreasons, it is strongly preferred to restrict the use of LM & NTLM (non-v2) as much as\npossible.",
    "impact": "Clients use NTLMv2 authentication only and use NTLMv2 session security if the server\nsupports it; Domain Controllers refuse LM and NTLM (accept only NTLMv2\nauthentication). Clients that do not support NTLMv2 authentication will not be able to\nauthenticate in the domain and access domain resources by using LM and NTLM.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 5.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa:LmCompatibilityLevel",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to: Send\nNTLMv2 response only. Refuse LM & NTLM:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: LAN Manager authentication level",
    "default_value": "Send NTLMv2 response only. (Clients use NTLMv2 authentication only and use\nNTLMv2 session security if the server supports it; Domain Controllers accept LM, NTLM\n& NTLMv2 authentication.)\nPage 244\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-lan-manager-authentication-level\n2. GRID: MS-00000109\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\n9.2 Ensure Only Approved Ports, Protocols and\nServices Are Running\nv7 ● ●\nEnsure that only network ports, protocols, and services listening on a system\nwith validated business needs, are running on each system.\nPage 245",
    "page_number": 244
  },
  {
    "cis_id": "2.3.11.8",
    "title": "Ensure 'Network security: LDAP client encryption\nrequirements' is set to 'Negotiate sealing' or higher",
    "profile": "L1",
    "description": "This policy setting determines the level of data encryption that is requested on behalf of\nclients that issue LDAP BIND requests.\nThe recommended state for this setting is: Negotiate sealing. Configuring this setting\nto Require sealing also conforms to the Benchmark.\nNote: This policy setting does not have any impact on LDAP simple bind\n(ldap_simple_bind) or LDAP simple bind through SSL (ldap_simple_bind_s).",
    "rationale": "Unencrypted network traffic is susceptible to man-in-the-middle attacks in which an\nintruder captures the packets between the client and server, modifies them, and then\nforwards them to the server. For an LDAP server, this susceptibility means that an\nattacker could cause a server to make decisions that are based on false or altered data\nfrom the LDAP queries. To lower this risk in your network, you can implement strong\nphysical security measures to protect the network infrastructure. Also, you can make all\ntypes of man-in-the-middle attacks extremely difficult if you require encryption on all\nnetwork packets by means of IPsec authentication headers.",
    "impact": "None - this is the default behavior.\nHowever, if this setting is configured to require LDAP encryption on the server, then it\nmust also be configured to require on the client. If it is not configured on the client, it will\nnot be able to communicate with the server, which could cause features to fail, including\nuser authentication, Group Policy, and logon scripts. This is because the caller will be\ntold that the LDAP BIND command request failed.\nPage 246",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1 or 2.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LDAP:LDAPClientConfidentiality",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nNegotiate sealing or higher:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: LDAP client encryption\nrequirements",
    "default_value": "Enabled: Negotiate encryption (sealing).\nReferences:\n1. GRID: MS-00000572\nCIS Controls:\nControls Version Control IG 1 IG 2 IG 3\n0.0 Explicitly Not Mapped\nv8\nExplicitly Not Mapped\n0.0 Explicitly Not Mapped\nv7\nExplicitly Not Mapped\nPage 247",
    "page_number": 247
  },
  {
    "cis_id": "2.3.11.9",
    "title": "Ensure 'Network security: LDAP client signing\nrequirements' is set to 'Negotiate signing' or higher",
    "profile": "L1",
    "description": "This policy setting determines the level of data signing that is requested on behalf of\nclients that issue LDAP BIND requests.\nNote: This policy setting does not have any impact on LDAP simple bind\n(ldap_simple_bind) or LDAP simple bind through SSL (ldap_simple_bind_s). No\nMicrosoft LDAP clients that are included with Windows XP Professional use\nldap_simple_bind or ldap_simple_bind_s to communicate with a Domain Controller.\nThe recommended state for this setting is: Negotiate signing. Configuring this setting\nto Require signing also conforms to the Benchmark.",
    "rationale": "Unsigned network traffic is susceptible to man-in-the-middle attacks in which an intruder\ncaptures the packets between the client and server, modifies them, and then forwards\nthem to the server. For an LDAP server, this susceptibility means that an attacker could\ncause a server to make decisions that are based on false or altered data from the LDAP\nqueries. To lower this risk in your network, you can implement strong physical security\nmeasures to protect the network infrastructure. Also, you can make all types of man-in-\nthe-middle attacks extremely difficult if you require digital signatures on all network\npackets by means of IPsec authentication headers.",
    "impact": "None - this is the default behavior. However, if you choose instead to configure the\nserver to require LDAP signatures then you must also configure the client. If you do not\nconfigure the client it will not be able to communicate with the server, which could cause\nmany features to fail, including user authentication, Group Policy, and logon scripts,\nbecause the caller will be told that the LDAP BIND command request failed.\nPage 248",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 1.\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\LDAP:LDAPClientIntegrity",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nNegotiate signing (configuring to Require signing also conforms to the\nbenchmark):\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: LDAP client signing requirements",
    "default_value": "Negotiate signing. (If Transport Layer Security/Secure Sockets Layer (TLS/SSL) has not\nbeen started, the LDAP BIND request is initiated with the LDAP data signing option set\nin addition to the caller-specified options. If TLS/SSL has been started, the LDAP BIND\nrequest is initiated with the caller-specified options.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-ldap-client-signing-requirements\n2. GRID: MS-00000110\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\n12.5 Configure Monitoring Systems to Record Network\nPackets\nv7 ● ●\nConfigure monitoring systems to record network packets passing through\nthe boundary at each of the organization's network boundaries.\nPage 249",
    "page_number": 249
  },
  {
    "cis_id": "2.3.11.10",
    "title": "Ensure 'Network security: Minimum session\nsecurity for NTLM SSP based (including secure RPC) clients' is\nset to 'Require NTLMv2 session security, Require 128-bit\nencryption'",
    "profile": "L1",
    "description": "This policy setting determines which behaviors are allowed by clients for applications\nusing the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by\napplications that need authentication services. The setting does not modify how the\nauthentication sequence works but instead require certain behaviors in applications that\nuse the SSPI.\nThe recommended state for this setting is: Require NTLMv2 session security,\nRequire 128-bit encryption.\nNote: These values are dependent on the Network security: LAN Manager\nAuthentication Level (Rule 2.3.11.7) security setting value.",
    "rationale": "You can enable both options for this policy setting to help protect network traffic that\nuses the NTLM Security Support Provider (NTLM SSP) from being exposed or\ntampered with by an attacker who has gained access to the same network. In other\nwords, these options help protect against man-in-the-middle attacks.",
    "impact": "NTLM connections will fail if NTLMv2 protocol and strong encryption (128-bit) are not\nboth negotiated. Client applications that are enforcing these settings will be unable to\ncommunicate with older servers that do not support them.",
    "audit_procedure": "Navigate to the UI Path articulated in the Remediation section and confirm it is set as\nprescribed. This group policy setting is backed by the following registry location with a\nREG_DWORD value of 537395200.\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0:NTLMMinClientSec\nPage 250",
    "remediation_procedure": "To establish the recommended configuration via GP, set the following UI path to\nRequire NTLMv2 session security, Require 128-bit encryption:\nComputer Configuration\\Policies\\Windows Settings\\Security Settings\\Local\nPolicies\\Security Options\\Network security: Minimum session security for NTLM\nSSP based (including secure RPC) clients",
    "default_value": "Require 128-bit encryption. (NTLM connections will fail if strong encryption (128-bit) is\nnot negotiated.)\nReferences:\n1. https://learn.microsoft.com/en-us/windows/security/threat-protection/security-\npolicy-settings/network-security-minimum-session-security-for-ntlm-ssp-based-\nincluding-secure-rpc-clients\n2. GRID: MS-00000111\nCIS Controls:\nControls\nControl IG 1 IG 2 IG 3\nVersion\n3.10 Encrypt Sensitive Data in Transit\nv8 ● ●\nEncrypt sensitive data in transit. Example implementations can include:\nTransport Layer Security (TLS) and Open Secure Shell (OpenSSH).\n12.5 Configure Monitoring Systems to Record Network\nPackets\nv7 ● ●\nConfigure monitoring systems to record network packets passing through\nthe boundary at each of the organization's network boundaries.\nPage 251",
    "page_number": 251
  }
]